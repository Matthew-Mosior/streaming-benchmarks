#!/usr/bin/scheme --program

;; @generated by Idris 0.8.0-519ce8a2e, Chez backend
(import (chezscheme))
(case (machine-type)
  [(i3fb ti3fb a6fb ta6fb) #f]
  [(i3le ti3le a6le ta6le tarm64le)
     (with-exception-handler (lambda(x) (load-shared-object "libc.so"))
        (lambda () (load-shared-object "libc.so.6")))]
  [(i3osx ti3osx a6osx ta6osx tarm64osx tppc32osx tppc64osx) (load-shared-object "libc.dylib")]
  [(i3nt ti3nt a6nt ta6nt) (load-shared-object "msvcrt.dll")]
  [else (load-shared-object "libc.so")])

(load-shared-object "libidris2_support.so")
(load-shared-object "posix-idris.so")

(let ()
#!chezscheme

(define (blodwen-os)
  (case (machine-type)
    [(i3le ti3le a6le ta6le tarm64le) "unix"]  ; GNU/Linux
    [(i3ob ti3ob a6ob ta6ob tarm64ob) "unix"]  ; OpenBSD
    [(i3fb ti3fb a6fb ta6fb tarm64fb) "unix"]  ; FreeBSD
    [(i3nb ti3nb a6nb ta6nb tarm64nb) "unix"]  ; NetBSD
    [(i3osx ti3osx a6osx ta6osx tarm64osx tppc32osx tppc64osx) "darwin"]
    [(i3nt ti3nt a6nt ta6nt tarm64nt) "windows"]
    [else "unknown"]))

(define blodwen-lazy
  (lambda (f)
    (let ([evaluated #f] [res void])
      (lambda ()
        (if (not evaluated)
            (begin (set! evaluated #t)
                   (set! res (f))
                   (set! f void))
            (void))
        res))))

(define (blodwen-delay-lazy f)
  (weak-cons #!bwp f))

(define (blodwen-force-lazy e)
  (let ((exval (car e)))
    (if (bwp-object? exval)
      (let ((val ((cdr e))))
        (begin (set-car! e val) val))
      exval)))

(define (blodwen-toSignedInt x bits)
  (if (logbit? bits x)
      (logor x (ash -1 bits))
      (logand x (sub1 (ash 1 bits)))))

(define (blodwen-toUnsignedInt x bits)
  (logand x (sub1 (ash 1 bits))))

(define (blodwen-euclidDiv a b)
  (let ((q (quotient a b))
        (r (remainder a b)))
    (if (< r 0)
      (if (> b 0) (- q 1) (+ q 1))
      q)))

(define (blodwen-euclidMod a b)
  (let ((r (remainder a b)))
    (if (< r 0)
      (if (> b 0) (+ r b) (- r b))
      r)))

; flonum constants

(define (blodwen-calcFlonumUnitRoundoff)
  (let loop [(uro 1.0)]
    (if (fl= 1.0 (fl+ 1.0 uro))
      uro
      (loop (fl/ uro 2.0)))))

(define (blodwen-calcFlonumEpsilon)
  (fl* (blodwen-calcFlonumUnitRoundoff) 2.0))

(define (blodwen-flonumNaN)
  +nan.0)

(define (blodwen-flonumInf)
  +inf.0)

; Bits

(define bu+ (lambda (x y bits) (blodwen-toUnsignedInt (+ x y) bits)))
(define bu- (lambda (x y bits) (blodwen-toUnsignedInt (- x y) bits)))
(define bu* (lambda (x y bits) (blodwen-toUnsignedInt (* x y) bits)))
(define bu/ (lambda (x y bits) (blodwen-toUnsignedInt (quotient x y) bits)))

(define bs+ (lambda (x y bits) (blodwen-toSignedInt (+ x y) bits)))
(define bs- (lambda (x y bits) (blodwen-toSignedInt (- x y) bits)))
(define bs* (lambda (x y bits) (blodwen-toSignedInt (* x y) bits)))
(define bs/ (lambda (x y bits) (blodwen-toSignedInt (blodwen-euclidDiv x y) bits)))

(define (integer->bits8 x) (logand x (sub1 (ash 1 8))))
(define (integer->bits16 x) (logand x (sub1 (ash 1 16))))
(define (integer->bits32 x) (logand x (sub1 (ash 1 32))))
(define (integer->bits64 x) (logand x (sub1 (ash 1 64))))

(define (bits16->bits8 x) (logand x (sub1 (ash 1 8))))
(define (bits32->bits8 x) (logand x (sub1 (ash 1 8))))
(define (bits64->bits8 x) (logand x (sub1 (ash 1 8))))
(define (bits32->bits16 x) (logand x (sub1 (ash 1 16))))
(define (bits64->bits16 x) (logand x (sub1 (ash 1 16))))
(define (bits64->bits32 x) (logand x (sub1 (ash 1 32))))

(define (blodwen-bits-shl-signed x y bits) (blodwen-toSignedInt (ash x y) bits))

(define (blodwen-bits-shl x y bits) (logand (ash x y) (sub1 (ash 1 bits))))

(define blodwen-shl (lambda (x y) (ash x y)))
(define blodwen-shr (lambda (x y) (ash x (- y))))
(define blodwen-and (lambda (x y) (logand x y)))
(define blodwen-or (lambda (x y) (logor x y)))
(define blodwen-xor (lambda (x y) (logxor x y)))

(define cast-num
  (lambda (x)
    (if (number? x) x 0)))
(define destroy-prefix
  (lambda (x)
    (cond
      ((equal? x "") "")
      ((equal? (string-ref x 0) #\#) "")
      (else x))))

(define exact-floor
  (lambda (x)
    (inexact->exact (floor x))))

(define exact-truncate
  (lambda (x)
    (inexact->exact (truncate x))))

(define exact-truncate-boundedInt
  (lambda (x y)
    (blodwen-toSignedInt (exact-truncate x) y)))

(define exact-truncate-boundedUInt
  (lambda (x y)
    (blodwen-toUnsignedInt (exact-truncate x) y)))

(define cast-char-boundedInt
  (lambda (x y)
    (blodwen-toSignedInt (char->integer x) y)))

(define cast-char-boundedUInt
  (lambda (x y)
    (blodwen-toUnsignedInt (char->integer x) y)))

(define cast-string-int
  (lambda (x)
    (exact-truncate (cast-num (string->number (destroy-prefix x))))))

(define cast-string-boundedInt
  (lambda (x y)
    (blodwen-toSignedInt (cast-string-int x) y)))

(define cast-string-boundedUInt
  (lambda (x y)
    (blodwen-toUnsignedInt (cast-string-int x) y)))

(define cast-int-char
  (lambda (x)
    (if (or
          (and (>= x 0) (<= x #xd7ff))
          (and (>= x #xe000) (<= x #x10ffff)))
        (integer->char x)
        (integer->char 0))))

(define cast-string-double
  (lambda (x)
    (exact->inexact (cast-num (string->number (destroy-prefix x))))))


(define (string-concat xs) (apply string-append xs))
(define (string-unpack s) (string->list s))
(define (string-pack xs) (list->string xs))

(define string-cons (lambda (x y) (string-append (string x) y)))
(define string-reverse (lambda (x)
  (list->string (reverse (string->list x)))))
(define (string-substr off len s)
    (let* ((l (string-length s))
          (b (max 0 off))
          (x (max 0 len))
          (end (min l (+ b x))))
          (if (> b l)
              ""
              (substring s b end))))

(define (blodwen-string-iterator-new s)
  0)

(define (blodwen-string-iterator-to-string _ s ofs f)
  (f (substring s ofs (string-length s))))

(define (blodwen-string-iterator-next s ofs)
  (if (>= ofs (string-length s))
      '() ; EOF
      (cons (string-ref s ofs) (+ ofs 1))))

(define either-left
  (lambda (x)
    (vector 0 x)))

(define either-right
  (lambda (x)
    (vector 1 x)))

(define blodwen-error-quit
  (lambda (msg)
    (display msg)
    (newline)
    (exit 1)))

(define (blodwen-get-line p)
    (if (port? p)
        (let ((str (get-line p)))
            (if (eof-object? str)
                ""
                str))
        void))

(define (blodwen-get-char p)
    (if (port? p)
        (let ((chr (get-char p)))
            (if (eof-object? chr)
                #\nul
                chr))
        void))

;; Buffers

(define (blodwen-new-buffer size)
  (make-bytevector size 0))

(define (blodwen-buffer-size buf)
  (bytevector-length buf))

(define (blodwen-buffer-setbyte buf loc val)
  (bytevector-u8-set! buf loc val))

(define (blodwen-buffer-getbyte buf loc)
  (bytevector-u8-ref buf loc))

(define (blodwen-buffer-setbits16 buf loc val)
  (bytevector-u16-set! buf loc val (native-endianness)))

(define (blodwen-buffer-getbits16 buf loc)
  (bytevector-u16-ref buf loc (native-endianness)))

(define (blodwen-buffer-setbits32 buf loc val)
  (bytevector-u32-set! buf loc val (native-endianness)))

(define (blodwen-buffer-getbits32 buf loc)
  (bytevector-u32-ref buf loc (native-endianness)))

(define (blodwen-buffer-setbits64 buf loc val)
  (bytevector-u64-set! buf loc val (native-endianness)))

(define (blodwen-buffer-getbits64 buf loc)
  (bytevector-u64-ref buf loc (native-endianness)))

(define (blodwen-buffer-setint8 buf loc val)
  (bytevector-s8-set! buf loc val))

(define (blodwen-buffer-getint8 buf loc)
  (bytevector-s8-ref buf loc))

(define (blodwen-buffer-setint16 buf loc val)
  (bytevector-s16-set! buf loc val (native-endianness)))

(define (blodwen-buffer-getint16 buf loc)
  (bytevector-s16-ref buf loc (native-endianness)))

(define (blodwen-buffer-setint32 buf loc val)
  (bytevector-s32-set! buf loc val (native-endianness)))

(define (blodwen-buffer-getint32 buf loc)
  (bytevector-s32-ref buf loc (native-endianness)))

(define (blodwen-buffer-setint buf loc val)
  (bytevector-s64-set! buf loc val (native-endianness)))

(define (blodwen-buffer-getint buf loc)
  (bytevector-s64-ref buf loc (native-endianness)))

(define (blodwen-buffer-setint64 buf loc val)
  (bytevector-s64-set! buf loc val (native-endianness)))

(define (blodwen-buffer-getint64 buf loc)
  (bytevector-s64-ref buf loc (native-endianness)))

(define (blodwen-buffer-setdouble buf loc val)
  (bytevector-ieee-double-set! buf loc val (native-endianness)))

(define (blodwen-buffer-getdouble buf loc)
  (bytevector-ieee-double-ref buf loc (native-endianness)))

(define (blodwen-stringbytelen str)
  (bytevector-length (string->utf8 str)))

(define (blodwen-buffer-setstring buf loc val)
  (let* [(strvec (string->utf8 val))
         (len (bytevector-length strvec))]
    (bytevector-copy! strvec 0 buf loc len)))

(define (blodwen-buffer-getstring buf loc len)
  (let [(newvec (make-bytevector len))]
    (bytevector-copy! buf loc newvec 0 len)
    (utf8->string newvec)))

(define (blodwen-buffer-copydata buf start len dest loc)
  (bytevector-copy! buf start dest loc len))

;; Threads

(define-record thread-handle (semaphore))

(define (blodwen-thread proc)
  (let [(sema (blodwen-make-semaphore 0))]
    (fork-thread (lambda () (proc (vector 0)) (blodwen-semaphore-post sema)))
    (make-thread-handle sema)
    ))

(define (blodwen-thread-wait handle)
  (blodwen-semaphore-wait (thread-handle-semaphore handle)))

;; Thread mailboxes

(define blodwen-thread-data
  (make-thread-parameter #f))

(define (blodwen-get-thread-data ty)
  (blodwen-thread-data))

(define (blodwen-set-thread-data ty a)
  (blodwen-thread-data a))

;; Semaphore

(define-record semaphore (box mutex condition))

(define (blodwen-make-semaphore init)
  (make-semaphore (box init) (make-mutex) (make-condition)))

(define (blodwen-semaphore-post sema)
  (with-mutex (semaphore-mutex sema)
    (let [(sema-box (semaphore-box sema))]
      (set-box! sema-box (+ (unbox sema-box) 1))
      (condition-signal (semaphore-condition sema))
    )))

(define (blodwen-semaphore-wait sema)
  (with-mutex (semaphore-mutex sema)
    (let [(sema-box (semaphore-box sema))]
      (when (= (unbox sema-box) 0)
        (condition-wait (semaphore-condition sema) (semaphore-mutex sema)))
      (set-box! sema-box (- (unbox sema-box) 1))
      )))

;; Barrier

(define-record barrier (count-box num-threads mutex cond))

(define (blodwen-make-barrier num-threads)
  (make-barrier (box 0) num-threads (make-mutex) (make-condition)))

(define (blodwen-barrier-wait barrier)
  (let [(count-box (barrier-count-box barrier))
        (num-threads (barrier-num-threads barrier))
        (mutex (barrier-mutex barrier))
        (condition (barrier-cond barrier))]
    (with-mutex mutex
    (let* [(count-old (unbox count-box))
           (count-new (+ count-old 1))]
      (set-box! count-box count-new)
      (if (= count-new num-threads)
          (condition-broadcast condition)
          (condition-wait condition mutex))
      ))))

;; Channel
; With thanks to Alain Zscheile (@zseri) for help with understanding condition
; variables, and figuring out where the problems were and how to solve them.

(define-record channel (read-mut read-cv read-box val-cv val-box))

(define (blodwen-make-channel ty)
  (make-channel
    (make-mutex)
    (make-condition)
    (box #t)
    (make-condition)
    (box '())
    ))

; block on the read status using read-cv until the value has been read
(define (channel-put-while-helper chan)
  (let ([read-mut (channel-read-mut chan)]
        [read-box (channel-read-box chan)]
        [read-cv  (channel-read-cv  chan)]
        )
    (if (unbox read-box)
      (void)    ; val has been read, so everything is fine
      (begin    ; otherwise, block/spin with cv
        (condition-wait read-cv read-mut)
        (channel-put-while-helper chan)
        )
      )))

(define (blodwen-channel-put ty chan val)
  (with-mutex (channel-read-mut chan)
    (channel-put-while-helper chan)
    (let ([read-box (channel-read-box chan)]
          [val-box  (channel-val-box  chan)]
          )
      (set-box! val-box val)
      (set-box! read-box #f)
      ))
  (condition-signal (channel-val-cv chan))
  )

; block on the value until it has been set
(define (channel-get-while-helper chan)
  (let ([read-mut (channel-read-mut chan)]
        [read-box (channel-read-box chan)]
        [val-cv   (channel-val-cv   chan)]
        )
    (if (unbox read-box)
      (begin
        (condition-wait val-cv read-mut)
        (channel-get-while-helper chan)
        )
      (void)
      )))

(define (blodwen-channel-get ty chan)
  (mutex-acquire (channel-read-mut chan))
  (channel-get-while-helper chan)
  (let* ([val-box  (channel-val-box  chan)]
         [read-box (channel-read-box chan)]
         [read-cv  (channel-read-cv  chan)]
         [the-val  (unbox val-box)]
         )
    (set-box! val-box '())
    (set-box! read-box #t)
    (mutex-release (channel-read-mut chan))
    (condition-signal read-cv)
    the-val))

(define (blodwen-channel-get-non-blocking ty chan)
  (if (mutex-acquire (channel-read-mut chan) #f)
    (let* ([val-box  (channel-val-box  chan)]
           [read-box (channel-read-box chan)]
           [read-cv  (channel-read-cv  chan)]
           [the-val  (unbox val-box)]
          )
      (if (null? the-val)
          (begin
           (mutex-release (channel-read-mut chan))
           '())
          (begin
            (set-box! val-box '())
            (set-box! read-box #t)
            (mutex-release (channel-read-mut chan))
            (condition-signal read-cv)
            (box the-val))
      ))
  '()))

(define (blodwen-channel-get-with-timeout ty chan timeout)
  ;; timeout is in milliseconds, convert to nanoseconds
  (let* ([timeout-ns (* timeout 1000000)]
         [sleep-ns 10000] ; 10 us step
         [sleep-time (make-time 'time-duration (mod sleep-ns 1000000000)
                                                (div sleep-ns 1000000000))])
    (let loop ([elapsed 0])
      (if (mutex-acquire (channel-read-mut chan) #f)
          (let* ([val-box  (channel-val-box chan)]
                 [the-val  (unbox val-box)])
            (if (null? the-val)
                (if (>= elapsed timeout-ns)
                    (begin
                      (mutex-release (channel-read-mut chan))
                      '())
                    (begin
                      (mutex-release (channel-read-mut chan))
                      (sleep sleep-time)
                      (loop (+ elapsed sleep-ns))))
                (let* ([read-box (channel-read-box chan)]
                       [read-cv  (channel-read-cv chan)])
                  (set-box! val-box '())
                  (set-box! read-box #t)
                  (mutex-release (channel-read-mut chan))
                  (condition-signal read-cv)
                  (box the-val))))
          (begin
            (sleep sleep-time)
            (loop (+ elapsed sleep-ns)))))))

;; Mutex

(define (blodwen-make-mutex)
  (make-mutex))
(define (blodwen-mutex-acquire mutex)
  (mutex-acquire mutex))
(define (blodwen-mutex-release mutex)
  (mutex-release mutex))

;; Condition variable

(define (blodwen-make-condition)
  (make-condition))
(define (blodwen-condition-wait condition mutex)
  (condition-wait condition mutex))
(define (blodwen-condition-wait-timeout condition mutex timeout)
  (let* [(sec (div timeout 1000000))
         (micro (mod timeout 1000000))]
    (condition-wait condition mutex (make-time 'time-duration (* 1000 micro) sec))))
(define (blodwen-condition-signal condition)
  (condition-signal condition))
(define (blodwen-condition-broadcast condition)
  (condition-broadcast condition))

;; Future

(define-record future-internal (result ready mutex signal))
(define (blodwen-make-future ty work)
  (let ([future (make-future-internal #f #f (make-mutex) (make-condition))])
    (fork-thread (lambda ()
      (let ([result (work '())])
        (with-mutex (future-internal-mutex future)
          (set-future-internal-result! future result)
          (set-future-internal-ready! future #t)
          (condition-broadcast (future-internal-signal future))))))
    future))
(define (blodwen-await-future ty future)
  (let ([mutex (future-internal-mutex future)])
    (with-mutex mutex
      (if (not (future-internal-ready future))
          (condition-wait (future-internal-signal future) mutex))
      (future-internal-result future))))

(define (blodwen-sleep s) (sleep (make-time 'time-duration 0 s)))
(define (blodwen-usleep s)
  (let ((sec (div s 1000000))
        (micro (mod s 1000000)))
       (sleep (make-time 'time-duration (* 1000 micro) sec))))

(define (blodwen-clock-time-utc) (current-time 'time-utc))
(define (blodwen-clock-time-monotonic) (current-time 'time-monotonic))
(define (blodwen-clock-time-duration) (current-time 'time-duration))
(define (blodwen-clock-time-process) (current-time 'time-process))
(define (blodwen-clock-time-thread) (current-time 'time-thread))
(define (blodwen-clock-time-gccpu) (current-time 'time-collector-cpu))
(define (blodwen-clock-time-gcreal) (current-time 'time-collector-real))
(define (blodwen-is-time? clk) (if (time? clk) 1 0))
(define (blodwen-clock-second time) (time-second time))
(define (blodwen-clock-nanosecond time) (time-nanosecond time))

(define (blodwen-arg-count)
  (length (command-line)))

(define (blodwen-arg n)
  (if (< n (length (command-line))) (list-ref (command-line) n) ""))

(define (blodwen-hasenv var)
  (if (eq? (getenv var) #f) 0 1))

;; Randoms
(define random-seed-register 0)
(define (initialize-random-seed-once)
  (if (= (virtual-register random-seed-register) 0)
      (let ([seed (time-nanosecond (current-time))])
        (set-virtual-register! random-seed-register seed)
        (random-seed seed))))

(define (blodwen-random-seed seed)
  (set-virtual-register! random-seed-register seed)
  (random-seed seed))
(define blodwen-random
  (case-lambda
    ;; no argument, pick a real value from [0, 1.0)
    [() (begin
          (initialize-random-seed-once)
          (random 1.0))]
    ;; single argument k, pick an integral value from [0, k)
    [(k)
      (begin
        (initialize-random-seed-once)
        (if (> k 0)
              (random k)
              (assertion-violationf 'blodwen-random "invalid range argument ~a" k)))]))

;; For finalisers

(define blodwen-finaliser (make-guardian))
(define (blodwen-register-object obj proc)
  (let [(x (cons obj proc))]
       (blodwen-finaliser x)
       x))
(define blodwen-run-finalisers
  (lambda ()
    (let run ()
      (let ([x (blodwen-finaliser)])
        (when x
          (((cdr x) (car x)) 'erased)
          (run))))))

;; For creating and reading back scheme objects

; read a scheme string and evaluate it, returning 'Just result' on success
; TODO: catch exception!
(define (blodwen-eval-scheme str)
  (guard
     (x [#t '()]) ; Nothing on failure
     (box (eval (read (open-input-string str)))))
  ); box == Just

(define (blodwen-eval-okay obj)
  (if (null? obj)
      0
      1))

(define (blodwen-get-eval-result obj)
  (unbox obj))

(define (blodwen-debug-scheme obj)
  (display obj) (newline))

(define (blodwen-is-number obj)
  (if (number? obj) 1 0))

(define (blodwen-is-integer obj)
  (if (and (number? obj) (exact? obj)) 1 0))

(define (blodwen-is-float obj)
  (if (flonum? obj) 1 0))

(define (blodwen-is-char obj)
  (if (char? obj) 1 0))

(define (blodwen-is-string obj)
  (if (string? obj) 1 0))

(define (blodwen-is-procedure obj)
  (if (procedure? obj) 1 0))

(define (blodwen-is-symbol obj)
  (if (symbol? obj) 1 0))

(define (blodwen-is-vector obj)
  (if (vector? obj) 1 0))

(define (blodwen-is-nil obj)
  (if (null? obj) 1 0))

(define (blodwen-is-pair obj)
  (if (pair? obj) 1 0))

(define (blodwen-is-box obj)
  (if (box? obj) 1 0))

(define (blodwen-make-symbol str)
  (string->symbol str))

; The below rely on checking that the objects are the right type first.

(define (blodwen-vector-ref obj i)
  (vector-ref obj i))

(define (blodwen-vector-length obj)
  (vector-length obj))

(define (blodwen-vector-list obj)
  (vector->list obj))

(define (blodwen-unbox obj)
  (unbox obj))

(define (blodwen-apply obj arg)
  (obj arg))

(define (blodwen-force obj)
  (obj))

(define (blodwen-read-symbol sym)
  (symbol->string sym))

(define (blodwen-id x) x)
(define System-prim__usleep (lambda (farg-0 farg-1) ((foreign-procedure "idris2_usleep" (int) void) farg-0)))
(define System-prim__getEnv (lambda (farg-0 farg-1) ((foreign-procedure "getenv" (string) void*) farg-0)))
(define System-prim__getArgCount (lambda (farg-0) (blodwen-arg-count )))
(define System-prim__getArg (lambda (farg-0 farg-1) (blodwen-arg farg-0)))
(define System-prim__exit (lambda (farg-0 farg-1) ((foreign-procedure "exit" (int) void) farg-0)))
(define SystemC-45FileC-45Virtual-prim__stderr (lambda () ((foreign-procedure "idris2_stderr" () void*) )))
(define PreludeC-45IO-prim__threadWait (lambda (farg-0 farg-1) (blodwen-thread-wait farg-0)))
(define PreludeC-45IO-prim__getString (lambda (farg-0) ((foreign-procedure "idris2_getString" (void*) string) farg-0)))
(define PreludeC-45IO-prim__fork (lambda (farg-0 farg-1) (blodwen-thread farg-0)))
(define PrimIO-prim__nullAnyPtr (lambda (farg-0) ((foreign-procedure "idris2_isNull" (void*) int) farg-0)))
(define SystemC-45FileC-45ReadWrite-prim__writeLine (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "idris2_writeLine" (void* string) int) farg-0 farg-1)))
(define SystemC-45FileC-45Error-prim__fileErrno (lambda (farg-0) ((foreign-procedure "idris2_fileErrno" () int) )))
(define DataC-45Buffer-stringByteLength (lambda (farg-0) (blodwen-stringbytelen farg-0)))
(define SystemC-45PosixC-45PollC-45Prim-prim__poll (lambda (farg-0 farg-1 farg-2 farg-3) ((foreign-procedure __collect_safe "li_poll" (void* unsigned-32 integer-32) integer-32) farg-0 farg-1 farg-2)))
(define SystemC-45PosixC-45PollC-45Struct-prim__set_pollfd_fd (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "set_pollfd_fd" (void* unsigned-32) void) farg-0 farg-1)))
(define SystemC-45PosixC-45PollC-45Struct-prim__set_pollfd_events (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "set_pollfd_events" (void* unsigned-32) void) farg-0 farg-1)))
(define SystemC-45PosixC-45PollC-45Struct-prim__get_pollfd_revents (lambda (farg-0 farg-1) ((foreign-procedure "get_pollfd_revents" (void*) unsigned-32) farg-0)))
(define SystemC-45PosixC-45PollC-45Struct-prim__get_pollfd_fd (lambda (farg-0 farg-1) ((foreign-procedure "get_pollfd_fd" (void*) unsigned-32) farg-0)))
(define DataC-45CC-45Struct-prim__malloc (lambda (farg-0) ((lambda (x) (if (= 0 x) 0 (foreign-alloc x))) farg-0)))
(define DataC-45CC-45Struct-prim__free (lambda (farg-0 farg-1) ((lambda (x) (if (= 0 x) '() (foreign-free x))) farg-0)))
(define DataC-45CC-45Deref-prim__set_bits8 (lambda (farg-0 farg-1 farg-2) ((lambda (x y) (foreign-set! 'unsigned-8 x 0 y)) farg-0 farg-1)))
(define DataC-45CC-45Array-prim__inc_ptr (lambda (farg-0 farg-1 farg-2) ((lambda (p x y) (+ p (* x y))) farg-0 farg-1 farg-2)))
(define SystemC-45PosixC-45FileC-45Prim-prim__writeptr (lambda (farg-0 farg-1 farg-2 farg-3 farg-4) ((foreign-procedure __collect_safe "li_write" (unsigned-32 void* unsigned-32 unsigned-32) integer-64) farg-0 farg-1 farg-2 farg-3)))
(define SystemC-45PosixC-45FileC-45Prim-prim__write (lambda (farg-0 farg-1 farg-2 farg-3 farg-4) ((foreign-procedure "li_write" (unsigned-32 u8* unsigned-32 unsigned-32) integer-64) farg-0 farg-1 farg-2 farg-3)))
(define SystemC-45PosixC-45FileC-45Prim-prim__setFlags (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "li_set_flags" (unsigned-32 unsigned-32) integer-32) farg-0 farg-1)))
(define SystemC-45PosixC-45FileC-45Prim-prim__read (lambda (farg-0 farg-1 farg-2 farg-3) ((foreign-procedure "li_read" (unsigned-32 u8* unsigned-32) integer-64) farg-0 farg-1 farg-2)))
(define SystemC-45PosixC-45FileC-45Prim-prim__getFlags (lambda (farg-0 farg-1) ((foreign-procedure "li_get_flags" (unsigned-32) integer-32) farg-0)))
(define SystemC-45PosixC-45FileC-45Prim-prim__close (lambda (farg-0 farg-1) ((foreign-procedure "li_close" (unsigned-32) integer-32) farg-0)))
(define DataC-45BufferC-45Core-prim__setByte (lambda (farg-0 farg-1 farg-2 farg-3) ((lambda (b o v) (bytevector-u8-set! b o v)) farg-0 farg-1 farg-2)))
(define DataC-45BufferC-45Core-prim__newBuf (lambda (farg-0 farg-1) ((lambda (n) (make-bytevector n 0)) farg-0)))
(define DataC-45BufferC-45Core-prim__getByteOffset (lambda (farg-0 farg-1 farg-2) ((lambda (b a o) (bytevector-u8-ref b (fx+ a o))) farg-0 farg-1 farg-2)))
(define DataC-45BufferC-45Core-prim__fromString (lambda (farg-0) ((lambda (v) (string->utf8 v)) farg-0)))
(define DataC-45BufferC-45Core-prim__copy (lambda (farg-0 farg-1 farg-2 farg-3 farg-4 farg-5) ((lambda (b1 o1 len b2 o2) (bytevector-copy! b1 o1 b2 o2 len)) farg-0 farg-1 farg-2 farg-3 farg-4)))
(define DataC-45LinearC-45Ref1-prim__casWrite (lambda (farg-0 farg-1 farg-2 farg-3) ((lambda (a x v w) (if (box-cas! x v w) 1 0)) farg-0 farg-1 farg-2 farg-3)))
(define DataC-45ArrayC-45Core-prim__emptyArray (lambda (farg-0 farg-1) ((lambda (x) (make-vector x)) farg-0)))
(define DataC-45ArrayC-45Core-prim__arraySet (lambda (farg-0 farg-1 farg-2 farg-3) ((lambda (x i w) (vector-set! x i w)) farg-0 farg-1 farg-2)))
(define DataC-45ArrayC-45Core-prim__arrayGet (lambda (farg-0 farg-1) ((lambda (x i) (vector-ref x i)) farg-0 farg-1)))
(define SystemC-45Concurrency-prim__mutexRelease (lambda (farg-0 farg-1) (blodwen-mutex-release farg-0)))
(define SystemC-45Concurrency-prim__mutexAcquire (lambda (farg-0 farg-1) (blodwen-mutex-acquire farg-0)))
(define SystemC-45Concurrency-prim__makeMutex (lambda (farg-0) (blodwen-make-mutex )))
(define SystemC-45Concurrency-prim__makeCondition (lambda (farg-0) (blodwen-make-condition )))
(define SystemC-45Concurrency-prim__conditionWaitTimeout (lambda (farg-0 farg-1 farg-2 farg-3) (blodwen-condition-wait-timeout farg-0 farg-1 farg-2)))
(define SystemC-45Concurrency-prim__conditionSignal (lambda (farg-0 farg-1) (blodwen-condition-signal farg-0)))
(define SystemC-45Clock-prim__osClockValid (lambda (farg-0 farg-1) (blodwen-is-time? farg-0)))
(define SystemC-45Clock-prim__osClockSecond (lambda (farg-0 farg-1) (blodwen-clock-second farg-0)))
(define SystemC-45Clock-prim__osClockNanosecond (lambda (farg-0 farg-1) (blodwen-clock-nanosecond farg-0)))
(define SystemC-45Clock-prim__clockTimeUtc (lambda (farg-0) (blodwen-clock-time-utc )))
(define SystemC-45Clock-prim__clockTimeThread (lambda (farg-0) (blodwen-clock-time-thread )))
(define SystemC-45Clock-prim__clockTimeProcess (lambda (farg-0) (blodwen-clock-time-process )))
(define SystemC-45Clock-prim__clockTimeMonotonic (lambda (farg-0) (blodwen-clock-time-monotonic )))
(define SystemC-45Clock-prim__clockTimeGcReal (lambda (farg-0) (blodwen-clock-time-gcreal )))
(define SystemC-45Clock-prim__clockTimeGcCpu (lambda (farg-0) (blodwen-clock-time-gccpu )))
(define SystemC-45PosixC-45SignalC-45Struct-prim__sigismember (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "sigismember" (void* unsigned-32) integer-32) farg-0 farg-1)))
(define SystemC-45PosixC-45SignalC-45Struct-prim__sigaddset (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "sigaddset" (void* unsigned-32) void) farg-0 farg-1)))
(define SystemC-45PosixC-45SignalC-45Struct-prim__emptysigset (lambda (farg-0) ((foreign-procedure "li_emptysigset" () void*) )))
(define SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_value (lambda (farg-0 farg-1) ((foreign-procedure "get_siginfo_t_si_value" (void*) integer-32) farg-0)))
(define SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_uid (lambda (farg-0 farg-1) ((foreign-procedure "get_siginfo_t_si_uid" (void*) integer-32) farg-0)))
(define SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_status (lambda (farg-0 farg-1) ((foreign-procedure "get_siginfo_t_si_status" (void*) integer-32) farg-0)))
(define SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_signo (lambda (farg-0 farg-1) ((foreign-procedure "get_siginfo_t_si_signo" (void*) unsigned-32) farg-0)))
(define SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_pid (lambda (farg-0 farg-1) ((foreign-procedure "get_siginfo_t_si_pid" (void*) integer-32) farg-0)))
(define SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_code (lambda (farg-0 farg-1) ((foreign-procedure "get_siginfo_t_si_code" (void*) integer-32) farg-0)))
(define SystemC-45PosixC-45SignalC-45Prim-prim__sigwaitinfo (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "li_sigwaitinfo" (void* void*) integer-32) farg-0 farg-1)))
(define SystemC-45PosixC-45SignalC-45Prim-prim__sigprocmask1 (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "li_sigprocmask1" (unsigned-8 void*) void) farg-0 farg-1)))
(define SystemC-45PosixC-45SignalC-45Prim-prim__sigpending (lambda (farg-0) ((foreign-procedure "li_sigpending" () void*) )))
(define SystemC-45PosixC-45SocketC-45Struct-prim__sockaddr_un (lambda (farg-0 farg-1) ((foreign-procedure "li_sockaddr_un" (string) void*) farg-0)))
(define SystemC-45PosixC-45SocketC-45Struct-prim__sockaddr_in6_addr (lambda (farg-0) ((foreign-procedure "sockaddr_in6_addr" (void*) void*) farg-0)))
(define SystemC-45PosixC-45SocketC-45Struct-prim__sockaddr_in6 (lambda (farg-0 farg-1) ((foreign-procedure "li_sockaddr_in6" (unsigned-16) void*) farg-0)))
(define SystemC-45PosixC-45SocketC-45Struct-prim__sockaddr_in (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "li_sockaddr_in" (unsigned-32 unsigned-16) void*) farg-0 farg-1)))
(define SystemC-45PosixC-45SocketC-45Prim-prim__socket (lambda (farg-0 farg-1 farg-2) ((foreign-procedure "li_socket" (unsigned-8 unsigned-32) integer-32) farg-0 farg-1)))
(define SystemC-45PosixC-45SocketC-45Prim-prim__connect (lambda (farg-0 farg-1 farg-2 farg-3) ((foreign-procedure "li_connect" (unsigned-32 void* unsigned-32) integer-32) farg-0 farg-1 farg-2)))
(define csegen-16 (vector (lambda (u--a) (lambda (u--es) (lambda (arg-3645) (vector 2 arg-3645)))) (lambda (u--es) (lambda (u--a) (lambda (arg-3651) (vector 1 arg-3651)))) (lambda (u--fs) (lambda (u--a) (lambda (u--es) (lambda (arg-3657) (vector 7 arg-3657))))) (lambda (u--b) (lambda (u--a) (lambda (u--es) (lambda (arg-3663) (lambda (arg-3666) (vector 0 arg-3663 arg-3666)))))) (lambda (u--es) (lambda (u--b) (lambda (u--a) (lambda (arg-3677) (lambda (arg-3684) (vector 0 arg-3684 (lambda (eta-0) (vector 1 (arg-3677 eta-0))))))))) (lambda (u--b) (lambda (u--a) (lambda (u--es) (lambda (arg-3691) (lambda (arg-3698) (vector 0 arg-3691 (lambda (arg-0) (vector 0 arg-3698 (lambda (eta-0) (vector 1 (arg-0 eta-0)))))))))))))
(define DataC-45LinearC-45ELift1-toResult (lambda (arg-3) (case (vector-ref arg-3 0) ((0) (let ((e-3 (vector-ref arg-3 1))) (vector 0 e-3))) (else (let ((e-8 (vector-ref arg-3 1))) (vector 1 e-8))))))
(define csegen-27 (cons csegen-16 (lambda (u--a) (lambda (u--es) (lambda (arg-4026) (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (arg-4026 eta-0)))))))))
(define csegen-50 (vector (lambda (u--a) (lambda (u--es) (lambda (arg-3645) (vector 1 arg-3645)))) (lambda (u--es) (lambda (u--a) (lambda (arg-3651) (vector 0 arg-3651)))) (lambda (u--fs) (lambda (u--a) (lambda (u--es) (lambda (arg-3657) (vector 5 arg-3657))))) (lambda (u--b) (lambda (u--a) (lambda (u--es) (lambda (arg-3663) (lambda (arg-3666) (vector 6 arg-3663 arg-3666)))))) (lambda (u--es) (lambda (u--b) (lambda (u--a) (lambda (arg-3677) (lambda (arg-3684) (vector 6 arg-3684 (lambda (eta-0) (vector 0 (arg-3677 eta-0))))))))) (lambda (u--b) (lambda (u--a) (lambda (u--es) (lambda (arg-3691) (lambda (arg-3698) (vector 6 arg-3691 (lambda (arg-0) (vector 6 arg-3698 (lambda (eta-0) (vector 0 (arg-0 eta-0)))))))))))))
(define DataC-45BufferC-45Core-fromString (lambda (arg-0) (DataC-45BufferC-45Core-prim__fromString arg-0)))
(define DataC-45ByteVect-fromString (lambda (arg-0) (cons (DataC-45BufferC-45Core-fromString arg-0) 0)))
(define PreludeC-45Types-prim__integerToNat (lambda (arg-0) (let ((sc0 (or (and (<= 0 arg-0) 1) 0))) (cond ((equal? sc0 0) 0)(else arg-0)))))
(define DataC-45ByteString-u--fromString_FromString_ByteString (lambda (arg-0) (cons (PreludeC-45Types-prim__integerToNat (DataC-45Buffer-stringByteLength arg-0)) (DataC-45ByteVect-fromString arg-0))))
(define csegen-51 (lambda (eta-0) (vector 1 (DataC-45ByteString-u--fromString_FromString_ByteString eta-0))))
(define csegen-53(delay (cons (lambda (arg-8497) (lambda (arg-8500) (string-append arg-8497 arg-8500))) "")))
(define PreludeC-45IO-u--map_Functor_IO (lambda (arg-2 arg-3 ext-0) (let ((act-2 (arg-3 ext-0))) (arg-2 act-2))))
(define csegen-70 (vector (lambda (u--b) (lambda (u--a) (lambda (u--func) (lambda (arg-8912) (lambda (eta-0) (PreludeC-45IO-u--map_Functor_IO u--func arg-8912 eta-0)))))) (lambda (u--a) (lambda (arg-9951) (lambda (eta-0) arg-9951))) (lambda (u--b) (lambda (u--a) (lambda (arg-9957) (lambda (arg-9964) (lambda (world-4) (let ((act-5 (arg-9957 world-4))) (let ((act-3 (arg-9964 world-4))) (act-5 act-3))))))))))
(define csegen-77 (cons (vector csegen-70 (lambda (u--b) (lambda (u--a) (lambda (arg-10436) (lambda (arg-10439) (lambda (world-0) (let ((act-1 (arg-10436 world-0))) ((arg-10439 act-1) world-0))))))) (lambda (u--a) (lambda (arg-10450) (lambda (world-0) (let ((act-1 (arg-10450 world-0))) (act-1 world-0)))))) (lambda (u--a) (lambda (arg-13044) arg-13044))))
(define csegen-81 (cons (lambda (arg-12451) (let ((e-1 (vector-ref arg-12451 1))) e-1)) (lambda (arg-12457) (lambda (arg-12460) (lambda (arg-12463) (lambda (u--autoClose) (lambda (arg-12468) (let ((e-5 (vector-ref arg-12457 5))) (let ((e-11 (vector-ref e-5 3))) ((((e-11 arg-12460) arg-12463) u--autoClose) arg-12468))))))))))
(define csegen-96 (vector (lambda (arg-5919) (lambda (arg-5922) (bs+ arg-5919 arg-5922 63))) (lambda (arg-5929) (lambda (arg-5932) (bs* arg-5929 arg-5932 63))) (lambda (arg-5939) (blodwen-toSignedInt arg-5939 63))))
(define csegen-115 (lambda (eta-0) (lambda (eta-1) (cons eta-0 eta-1))))
(define SystemC-45Concurrency-conditionSignal (lambda (arg-1 arg-2) (let ((e-2 (cdr arg-1))) ((e-2 'erased) (lambda (eta-0) (SystemC-45Concurrency-prim__conditionSignal arg-2 eta-0))))))
(define IOC-45AsyncC-45LoopC-45Posix-debug (lambda (arg-0 arg-1) 'erased))
(define IOC-45AsyncC-45LoopC-45Queue-n--3855-2762-u--go (lambda (arg-1 arg-3 arg-4 arg-5 arg-6) (let ((e-1 (vector-ref arg-5 0))) (let ((e-2 (vector-ref arg-5 1))) (let ((e-3 (vector-ref arg-5 2))) (if (null? e-2) (if (null? e-3) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-3 arg-4 (vector e-1 (cons arg-1 '()) '())))) (cond ((equal? eff-0 1) e-1)(else (IOC-45AsyncC-45LoopC-45Queue-enq arg-3 arg-1 'erased)))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-3 arg-4 (vector e-1 e-2 (cons e-3 arg-1))))) (cond ((equal? eff-0 1) e-1)(else (IOC-45AsyncC-45LoopC-45Queue-enq arg-3 arg-1 'erased))))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-3 arg-4 (vector e-1 e-2 (cons e-3 arg-1))))) (cond ((equal? eff-0 1) e-1)(else (IOC-45AsyncC-45LoopC-45Queue-enq arg-3 arg-1 'erased))))))))))
(define IOC-45AsyncC-45LoopC-45Queue-case--enq-2910 (lambda (arg-1 arg-3 arg-4) (IOC-45AsyncC-45LoopC-45Queue-n--3855-2762-u--go arg-1 arg-3 arg-4 arg-4 'erased)))
(define IOC-45AsyncC-45LoopC-45Queue-enq (lambda (arg-1 arg-2 arg-3) (IOC-45AsyncC-45LoopC-45Queue-case--enq-2910 arg-2 arg-1 (unbox arg-1))))
(define SystemC-45Concurrency-mutexAcquire (lambda (arg-1 arg-2) (let ((e-2 (cdr arg-1))) ((e-2 'erased) (lambda (eta-0) (SystemC-45Concurrency-prim__mutexAcquire arg-2 eta-0))))))
(define SystemC-45Concurrency-mutexRelease (lambda (arg-1 arg-2) (let ((e-2 (cdr arg-1))) ((e-2 'erased) (lambda (eta-0) (SystemC-45Concurrency-prim__mutexRelease arg-2 eta-0))))))
(define PreludeC-45Types-u--foldl_Foldable_List (lambda (arg-2 arg-3 arg-4) (if (null? arg-4) arg-3 (let ((e-2 (car arg-4))) (let ((e-3 (cdr arg-4))) (PreludeC-45Types-u--foldl_Foldable_List arg-2 ((arg-2 arg-3) e-2) e-3))))))
(define PreludeC-45Types-u--foldMap_Foldable_List (lambda (arg-2 arg-3 ext-0) (PreludeC-45Types-u--foldl_Foldable_List (lambda (u--acc) (lambda (u--elem) (let ((e-1 (car arg-2))) ((e-1 u--acc) (arg-3 u--elem))))) (let ((e-2 (cdr arg-2))) e-2) ext-0)))
(define PreludeC-45Show-firstCharIs (lambda (arg-0 arg-1) (cond ((equal? arg-1 "") 0)(else (arg-0 (string-ref arg-1 0))))))
(define PreludeC-45Show-showParens (lambda (arg-0 arg-1) (cond ((equal? arg-0 0) arg-1) (else (string-append "(" (string-append arg-1 ")"))))))
(define PreludeC-45EqOrd-u--C-61C-61_Eq_Char (lambda (arg-0 arg-1) (let ((sc0 (or (and (char=? arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering (lambda (arg-0 arg-1) (cond ((equal? arg-0 0) (cond ((equal? arg-1 0) 1)(else 0))) ((equal? arg-0 1) (cond ((equal? arg-1 1) 1)(else 0))) ((equal? arg-0 2) (cond ((equal? arg-1 2) 1)(else 0)))(else 0))))
(define PreludeC-45EqOrd-u--C-47C-61_Eq_Ordering (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering arg-0 arg-1))) (cond ((equal? sc0 1) 0) (else 1)))))
(define PreludeC-45Show-precCon (lambda (arg-0) (case (vector-ref arg-0 0) ((0) 0) ((1) 1) ((2) 2) ((3) 3) ((4) 4) ((5) 5) (else 6))))
(define PreludeC-45EqOrd-u--C-60_Ord_Integer (lambda (arg-0 arg-1) (let ((sc0 (or (and (< arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--C-61C-61_Eq_Integer (lambda (arg-0 arg-1) (let ((sc0 (or (and (= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--compare_Ord_Integer (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Integer arg-0 arg-1))) (cond ((equal? sc0 1) 0) (else (let ((sc1 (PreludeC-45EqOrd-u--C-61C-61_Eq_Integer arg-0 arg-1))) (cond ((equal? sc1 1) 1) (else 2))))))))
(define PreludeC-45Show-u--compare_Ord_Prec (lambda (arg-0 arg-1) (case (vector-ref arg-0 0) ((4) (let ((e-0 (vector-ref arg-0 1))) (case (vector-ref arg-1 0) ((4) (let ((e-1 (vector-ref arg-1 1))) (PreludeC-45EqOrd-u--compare_Ord_Integer e-0 e-1)))(else (PreludeC-45EqOrd-u--compare_Ord_Integer (PreludeC-45Show-precCon arg-0) (PreludeC-45Show-precCon arg-1))))))(else (PreludeC-45EqOrd-u--compare_Ord_Integer (PreludeC-45Show-precCon arg-0) (PreludeC-45Show-precCon arg-1))))))
(define PreludeC-45Show-u--C-62C-61_Ord_Prec (lambda (arg-0 arg-1) (PreludeC-45EqOrd-u--C-47C-61_Eq_Ordering (PreludeC-45Show-u--compare_Ord_Prec arg-0 arg-1) 0)))
(define PreludeC-45Show-primNumShow (lambda (arg-1 arg-2 arg-3) (let ((u--str (arg-1 arg-3))) (PreludeC-45Show-showParens (let ((sc0 (PreludeC-45Show-u--C-62C-61_Ord_Prec arg-2 (vector 5 )))) (cond ((equal? sc0 1) (PreludeC-45Show-firstCharIs (lambda (arg-0) (PreludeC-45EqOrd-u--C-61C-61_Eq_Char arg-0 #\-)) u--str)) (else 0))) u--str))))
(define PreludeC-45Show-u--showPrec_Show_Integer (lambda (ext-0 ext-1) (PreludeC-45Show-primNumShow (lambda (eta-0) (number->string eta-0)) ext-0 ext-1)))
(define PreludeC-45Show-u--show_Show_Integer (lambda (arg-0) (PreludeC-45Show-u--showPrec_Show_Integer (vector 0 ) arg-0)))
(define DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (lambda (ext-0) (PreludeC-45Show-u--show_Show_Integer ext-0)))
(define IOC-45AsyncC-45LoopC-45Posix-submit (lambda (arg-0 arg-1 arg-2) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Posix-debug (lambda () (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons "submitting a fiber to " (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (let ((e-1 (vector-ref arg-0 1))) e-1)) '())))) arg-2))) (let ((eff-1 (IOC-45AsyncC-45LoopC-45Queue-enq (let ((e-3 (vector-ref arg-0 3))) e-3) arg-1 'erased))) (cond ((equal? eff-1 1) (let ((eff-2 (IOC-45AsyncC-45LoopC-45Posix-debug (lambda () (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons "waking up " (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (let ((e-1 (vector-ref arg-0 1))) e-1)) '())))) 'erased))) (let ((eff-3 ((SystemC-45Concurrency-mutexAcquire csegen-77 (let ((e-9 (vector-ref arg-0 9))) e-9)) 'erased))) (let ((eff-4 ((SystemC-45Concurrency-conditionSignal csegen-77 (let ((e-10 (vector-ref arg-0 10))) e-10)) 'erased))) ((SystemC-45Concurrency-mutexRelease csegen-77 (let ((e-9 (vector-ref arg-0 9))) e-9)) 'erased))))) (else 'erased))))))
(define csegen-129 (cons (lambda (u--el) (lambda (arg-1956) (lambda (eta-2) (IOC-45AsyncC-45LoopC-45Posix-submit u--el arg-1956 eta-2)))) 1024))
(define DataC-45Vect-u--foldl_Foldable_C-40VectC-32C-36nC-41 (lambda (arg-3 arg-4 arg-5) (if (null? arg-5) arg-4 (let ((e-3 (car arg-5))) (let ((e-4 (cdr arg-5))) (DataC-45Vect-u--foldl_Foldable_C-40VectC-32C-36nC-41 arg-3 ((arg-3 arg-4) e-3) e-4))))))
(define DataC-45Vect-u--foldMap_Foldable_C-40VectC-32C-36nC-41 (lambda (arg-3 arg-4 ext-0) (DataC-45Vect-u--foldl_Foldable_C-40VectC-32C-36nC-41 (lambda (u--acc) (lambda (u--elem) (let ((e-1 (car arg-3))) ((e-1 u--acc) (arg-4 u--elem))))) (let ((e-2 (cdr arg-3))) e-2) ext-0)))
(define PreludeC-45Basics-flip (lambda (arg-3 ext-0 ext-1) ((arg-3 ext-1) ext-0)))
(define DataC-45Vect-u--foldlM_Foldable_C-40VectC-32C-36nC-41 (lambda (arg-4 arg-5 arg-6 ext-0) (DataC-45Vect-u--foldl_Foldable_C-40VectC-32C-36nC-41 (lambda (u--ma) (lambda (u--b) (let ((e-2 (vector-ref arg-4 1))) ((((e-2 'erased) 'erased) u--ma) (lambda (eta-0) (PreludeC-45Basics-flip arg-5 u--b eta-0)))))) (let ((e-1 (vector-ref arg-4 0))) (let ((e-5 (vector-ref e-1 1))) ((e-5 'erased) arg-6))) ext-0)))
(define DataC-45Vect-foldrImpl (lambda (arg-3 arg-4 arg-5 arg-6) (if (null? arg-6) (arg-5 arg-4) (let ((e-3 (car arg-6))) (let ((e-4 (cdr arg-6))) (DataC-45Vect-foldrImpl arg-3 arg-4 (lambda (eta-0) (arg-5 ((arg-3 e-3) eta-0))) e-4))))))
(define DataC-45Vect-u--foldr_Foldable_C-40VectC-32C-36nC-41 (lambda (arg-3 arg-4 arg-5) (DataC-45Vect-foldrImpl arg-3 arg-4 (lambda (eta-0) eta-0) arg-5)))
(define DataC-45Vect-u--null_Foldable_C-40VectC-32C-36nC-41 (lambda (arg-2) (if (null? arg-2) 1 0)))
(define DataC-45Vect-u--toList_Foldable_C-40VectC-32C-36nC-41 (lambda (ext-0) (DataC-45Vect-u--foldr_Foldable_C-40VectC-32C-36nC-41 csegen-115 '() ext-0)))
(define csegen-150 (vector (lambda (u--acc) (lambda (u--elem) (lambda (u--func) (lambda (u--init) (lambda (u--input) (DataC-45Vect-u--foldr_Foldable_C-40VectC-32C-36nC-41 u--func u--init u--input)))))) (lambda (u--elem) (lambda (u--acc) (lambda (u--func) (lambda (u--init) (lambda (u--input) (DataC-45Vect-u--foldl_Foldable_C-40VectC-32C-36nC-41 u--func u--init u--input)))))) (lambda (u--elem) (lambda (arg-10939) (DataC-45Vect-u--null_Foldable_C-40VectC-32C-36nC-41 arg-10939))) (lambda (u--elem) (lambda (u--acc) (lambda (u--m) (lambda (i_con-0) (lambda (u--funcM) (lambda (u--init) (lambda (u--input) (DataC-45Vect-u--foldlM_Foldable_C-40VectC-32C-36nC-41 i_con-0 u--funcM u--init u--input)))))))) (lambda (u--elem) (lambda (arg-10968) (DataC-45Vect-u--toList_Foldable_C-40VectC-32C-36nC-41 arg-10968))) (lambda (u--a) (lambda (u--m) (lambda (i_con-0) (lambda (u--f) (lambda (arg-10982) (DataC-45Vect-u--foldMap_Foldable_C-40VectC-32C-36nC-41 i_con-0 u--f arg-10982))))))))
(define csegen-164(delay (lambda (arg-1594) (lambda (arg-1597) (PreludeC-45EqOrd-u--compare_Ord_Integer arg-1594 arg-1597)))))
(define csegen-171(delay (vector (cons (lambda (arg-712) (lambda (arg-715) (or (and (= arg-712 arg-715) 1) 0))) (lambda (arg-722) (lambda (arg-725) (let ((sc0 (or (and (= arg-722 arg-725) 1) 0))) (cond ((equal? sc0 1) 0) (else 1)))))) (force csegen-164) (lambda (arg-1604) (lambda (arg-1607) (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering (PreludeC-45EqOrd-u--compare_Ord_Integer arg-1604 arg-1607) 0))) (lambda (arg-1614) (lambda (arg-1617) (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering (PreludeC-45EqOrd-u--compare_Ord_Integer arg-1614 arg-1617) 2))) (lambda (arg-1624) (lambda (arg-1627) (PreludeC-45EqOrd-u--C-47C-61_Eq_Ordering (PreludeC-45EqOrd-u--compare_Ord_Integer arg-1624 arg-1627) 2))) (lambda (arg-1634) (lambda (arg-1637) (PreludeC-45EqOrd-u--C-47C-61_Eq_Ordering (PreludeC-45EqOrd-u--compare_Ord_Integer arg-1634 arg-1637) 0))) (lambda (arg-1644) (lambda (arg-1647) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering (PreludeC-45EqOrd-u--compare_Ord_Integer arg-1644 arg-1647) 2))) (cond ((equal? sc0 1) arg-1644) (else arg-1647))))) (lambda (arg-1654) (lambda (arg-1657) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering (PreludeC-45EqOrd-u--compare_Ord_Integer arg-1654 arg-1657) 0))) (cond ((equal? sc0 1) arg-1654) (else arg-1657))))))))
(define DataC-45SortedMapC-45Dependent-empty (lambda (arg-2) (vector 0 arg-2)))
(define DataC-45SortedMap-empty (lambda (arg-2) (DataC-45SortedMapC-45Dependent-empty arg-2)))
(define csegen-172 (DataC-45SortedMap-empty (force csegen-171)))
(define csegen-173 (vector 1 csegen-172))
(define LanguageC-45ReflectionC-45Derive-mkOrd (lambda (arg-1 arg-2) (vector arg-1 arg-2 (lambda (u--a) (lambda (u--b) (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering ((arg-2 u--a) u--b) 0))) (lambda (u--a) (lambda (u--b) (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering ((arg-2 u--a) u--b) 2))) (lambda (u--a) (lambda (u--b) (PreludeC-45EqOrd-u--C-47C-61_Eq_Ordering ((arg-2 u--a) u--b) 2))) (lambda (u--a) (lambda (u--b) (PreludeC-45EqOrd-u--C-47C-61_Eq_Ordering ((arg-2 u--a) u--b) 0))) (lambda (u--a) (lambda (u--b) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering ((arg-2 u--a) u--b) 2))) (cond ((equal? sc0 1) u--a) (else u--b))))) (lambda (u--a) (lambda (u--b) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering ((arg-2 u--a) u--b) 0))) (cond ((equal? sc0 1) u--a) (else u--b))))))))
(define PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (or (and (= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--C-60_Ord_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (or (and (< arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--compare_Ord_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Bits32 arg-0 arg-1))) (cond ((equal? sc0 1) 0) (else (let ((sc1 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 arg-0 arg-1))) (cond ((equal? sc1 1) 1) (else 2))))))))
(define csegen-191 (LanguageC-45ReflectionC-45Derive-mkOrd (cons (lambda (eta-0) (lambda (eta-1) (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 eta-0 eta-1))) (lambda (u--a) (lambda (u--b) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 u--a u--b))) (cond ((equal? sc0 1) 0) (else 1)))))) (lambda (eta-0) (lambda (eta-1) (PreludeC-45EqOrd-u--compare_Ord_Bits32 eta-0 eta-1)))))
(define csegen-195 (vector (lambda (arg-5919) (lambda (arg-5922) (bu+ arg-5919 arg-5922 32))) (lambda (arg-5929) (lambda (arg-5932) (bu* arg-5929 arg-5932 32))) (lambda (arg-5939) (blodwen-toUnsignedInt arg-5939 32))))
(define PreludeC-45EqOrd-u--C-47C-61_Eq_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 arg-0 arg-1))) (cond ((equal? sc0 1) 0) (else 1)))))
(define PreludeC-45EqOrd-u--C-60C-61_Ord_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (or (and (<= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--C-62C-61_Ord_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (or (and (>= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--C-62_Ord_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (or (and (> arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45Num-u--div_Integral_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 arg-1 0))) (cond ((equal? sc0 0) (bu/ arg-0 arg-1 32))(else (blodwen-error-quit (string-append "ERROR: " "Unhandled input for Prelude.Num.case block in div at Prelude.Num:324:3--326:43")))))))
(define PreludeC-45EqOrd-u--max_Ord_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-62_Ord_Bits32 arg-0 arg-1))) (cond ((equal? sc0 1) arg-0) (else arg-1)))))
(define PreludeC-45EqOrd-u--min_Ord_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Bits32 arg-0 arg-1))) (cond ((equal? sc0 1) arg-0) (else arg-1)))))
(define PreludeC-45Num-u--mod_Integral_Bits32 (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 arg-1 0))) (cond ((equal? sc0 0) (blodwen-euclidMod arg-0 arg-1))(else (blodwen-error-quit (string-append "ERROR: " "Unhandled input for Prelude.Num.case block in mod at Prelude.Num:327:3--329:43")))))))
(define csegen-213 (cons (vector csegen-195 (lambda (arg-6334) (lambda (arg-6337) (PreludeC-45Num-u--div_Integral_Bits32 arg-6334 arg-6337))) (lambda (arg-6344) (lambda (arg-6347) (PreludeC-45Num-u--mod_Integral_Bits32 arg-6344 arg-6347)))) (cons (vector (cons (lambda (arg-712) (lambda (arg-715) (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 arg-712 arg-715))) (lambda (arg-722) (lambda (arg-725) (PreludeC-45EqOrd-u--C-47C-61_Eq_Bits32 arg-722 arg-725)))) (lambda (arg-1594) (lambda (arg-1597) (PreludeC-45EqOrd-u--compare_Ord_Bits32 arg-1594 arg-1597))) (lambda (arg-1604) (lambda (arg-1607) (PreludeC-45EqOrd-u--C-60_Ord_Bits32 arg-1604 arg-1607))) (lambda (arg-1614) (lambda (arg-1617) (PreludeC-45EqOrd-u--C-62_Ord_Bits32 arg-1614 arg-1617))) (lambda (arg-1624) (lambda (arg-1627) (PreludeC-45EqOrd-u--C-60C-61_Ord_Bits32 arg-1624 arg-1627))) (lambda (arg-1634) (lambda (arg-1637) (PreludeC-45EqOrd-u--C-62C-61_Ord_Bits32 arg-1634 arg-1637))) (lambda (arg-1644) (lambda (arg-1647) (PreludeC-45EqOrd-u--max_Ord_Bits32 arg-1644 arg-1647))) (lambda (arg-1654) (lambda (arg-1657) (PreludeC-45EqOrd-u--min_Ord_Bits32 arg-1654 arg-1657)))) (vector csegen-195 (lambda (arg-6034) (bu- 0 arg-6034 32)) (lambda (arg-6040) (lambda (arg-6043) (bu- arg-6040 arg-6043 32)))))))
(define csegen-221 (DataC-45SortedMap-empty csegen-191))
(define DataC-45SortedSet-empty (lambda (arg-1) (DataC-45SortedMap-empty arg-1)))
(define csegen-227(delay (DataC-45SortedSet-empty (force csegen-171))))
(define u--prim__sub_Integer (lambda (arg-0 arg-1) (- arg-0 arg-1)))
(define DataC-45ByteVect-head (lambda (arg-1) (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (DataC-45BufferC-45Core-prim__getByteOffset e-2 0 e-3)))))
(define DataC-45ByteVect-drop (lambda (arg-1 arg-3) (let ((e-2 (car arg-3))) (let ((e-3 (cdr arg-3))) (cons e-2 (+ e-3 arg-1))))))
(define DataC-45ByteVect-breakRes (lambda (arg-0 arg-1 arg-2) (let ((u--bs2 (DataC-45ByteVect-drop arg-2 arg-1))) (vector arg-2 (PreludeC-45Types-prim__integerToNat (- arg-0 arg-2)) arg-1 u--bs2))))
(define DataC-45ByteVect-n--6747-3220-u--go (lambda (arg-0 arg-1 arg-2 arg-3 arg-4) (cond ((equal? arg-3 0) arg-4)(else (let ((e-0 (- arg-3 1))) (let ((sc0 (arg-2 (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (DataC-45BufferC-45Core-prim__getByteOffset e-2 arg-4 e-3)))))) (cond ((equal? sc0 1) arg-4) (else (DataC-45ByteVect-n--6747-3220-u--go arg-0 arg-1 arg-2 e-0 (+ arg-4 1))))))))))
(define DataC-45ByteVect-findIndexOrLength (lambda (arg-0 arg-1 arg-2) (DataC-45ByteVect-n--6747-3220-u--go arg-0 arg-2 arg-1 arg-0 0)))
(define DataC-45ByteVect-isE (lambda (arg-0) (cond ((equal? arg-0 69) 1) ((equal? arg-0 101) 1)(else 0))))
(define DataC-45ByteVect-n--9597-5888-u--go (lambda (arg-0 arg-1 arg-2 arg-3 arg-4 arg-5) (cond ((equal? arg-4 0) (cond ((equal? arg-3 0) (box (exact->inexact arg-2)))(else (box (/ (exact->inexact arg-2) (exact->inexact arg-3))))))(else (let ((e-0 (- arg-4 1))) (let ((sc0 (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (DataC-45BufferC-45Core-prim__getByteOffset e-2 arg-5 e-3))))) (cond ((equal? sc0 48) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 0) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 49) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 1) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 50) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 2) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 51) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 3) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 52) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 4) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 53) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 5) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 54) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 6) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 55) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 7) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 56) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 8) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 57) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 (+ (* arg-2 10) 9) (* arg-3 10) e-0 (+ arg-5 1))) ((equal? sc0 46) (cond ((equal? arg-3 0) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 arg-2 1 e-0 (+ arg-5 1)))(else '())))(else '()))))))))
(define DataC-45ByteVect-parseDotted (lambda (arg-0 arg-1) (DataC-45ByteVect-n--9597-5888-u--go arg-0 arg-1 0 0 arg-0 0)))
(define DataC-45ByteVect-tail (lambda (arg-1) (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (cons e-2 (+ e-3 1))))))
(define PreludeC-45Types-u--map_Functor_Maybe (lambda (arg-2 arg-3) (if (null? arg-3) '() (let ((e-1 (unbox arg-3))) (box (arg-2 e-1))))))
(define DataC-45Byte-fromDigit (lambda (arg-0) (cond ((equal? arg-0 48) (box 0)) ((equal? arg-0 49) (box 1)) ((equal? arg-0 50) (box 2)) ((equal? arg-0 51) (box 3)) ((equal? arg-0 52) (box 4)) ((equal? arg-0 53) (box 5)) ((equal? arg-0 54) (box 6)) ((equal? arg-0 55) (box 7)) ((equal? arg-0 56) (box 8)) ((equal? arg-0 57) (box 9))(else '()))))
(define DataC-45ByteVect-n--9137-5445-u--go (lambda (arg-0 arg-1 arg-2 arg-3 arg-4) (cond ((equal? arg-2 0) (box arg-3))(else (let ((e-0 (- arg-2 1))) (let ((sc0 (DataC-45Byte-fromDigit (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (DataC-45BufferC-45Core-prim__getByteOffset e-2 arg-4 e-3)))))) (if (null? sc0) '() (let ((e-1 (unbox sc0))) (DataC-45ByteVect-n--9137-5445-u--go arg-0 arg-1 e-0 (+ (* arg-3 10) e-1) (+ arg-4 1))))))))))
(define DataC-45ByteVect-parseInteger (lambda (arg-0 arg-1) (cond ((equal? arg-0 0) '())(else (let ((e-0 (- arg-0 1))) (let ((sc0 (DataC-45ByteVect-head arg-1))) (cond ((equal? sc0 43) (PreludeC-45Types-u--map_Functor_Maybe (lambda (eta-0) eta-0) (cond ((equal? e-0 0) '())(else (DataC-45ByteVect-n--9137-5445-u--go e-0 (DataC-45ByteVect-tail arg-1) e-0 0 0))))) ((equal? sc0 45) (PreludeC-45Types-u--map_Functor_Maybe (lambda (eta-0) (- 0 eta-0)) (cond ((equal? e-0 0) '())(else (DataC-45ByteVect-n--9137-5445-u--go e-0 (DataC-45ByteVect-tail arg-1) e-0 0 0)))))(else (PreludeC-45Types-u--map_Functor_Maybe (lambda (eta-0) eta-0) (let ((sc0 (+ e-0 1))) (cond ((equal? sc0 0) '())(else (DataC-45ByteVect-n--9137-5445-u--go (+ e-0 1) arg-1 (+ e-0 1) 0 0)))))))))))))
(define DataC-45ByteVect-exp (lambda (arg-0 arg-1) (let ((sc0 (DataC-45ByteVect-parseInteger arg-0 arg-1))) (if (null? sc0) '() (let ((e-1 (unbox sc0))) (box (flexpt 10.0 (exact->inexact e-1))))))))
(define DataC-45ByteVect-case--caseC-32blockC-32inC-32parsePosDbl-6414 (lambda (arg-0 arg-1 arg-2) (let ((e-1 (vector-ref arg-2 0))) (let ((e-2 (vector-ref arg-2 1))) (let ((e-3 (vector-ref arg-2 2))) (let ((e-4 (vector-ref arg-2 3))) (cond ((equal? e-2 0) '())(else (let ((e-6 (- e-2 1))) (let ((sc0 (DataC-45ByteVect-parseDotted e-1 e-3))) (if (null? sc0) '() (let ((e-5 (unbox sc0))) (let ((sc1 (DataC-45ByteVect-exp e-6 (DataC-45ByteVect-tail e-4)))) (if (null? sc1) '() (let ((e-7 (unbox sc1))) (box (* e-5 e-7)))))))))))))))))
(define DataC-45ByteVect-parsePosDbl (lambda (arg-0 arg-1) (let ((sc0 (DataC-45ByteVect-parseDotted arg-0 arg-1))) (if (null? sc0) (DataC-45ByteVect-case--caseC-32blockC-32inC-32parsePosDbl-6414 arg-0 arg-1 (DataC-45ByteVect-breakRes arg-0 arg-1 (DataC-45ByteVect-findIndexOrLength arg-0 (lambda (eta-0) (DataC-45ByteVect-isE eta-0)) arg-1))) (let ((e-1 (unbox sc0))) (box e-1))))))
(define DataC-45ByteVect-parseDouble (lambda (arg-0 arg-1) (cond ((equal? arg-0 0) '())(else (let ((e-0 (- arg-0 1))) (let ((sc0 (DataC-45ByteVect-head arg-1))) (cond ((equal? sc0 43) (DataC-45ByteVect-parsePosDbl e-0 (DataC-45ByteVect-tail arg-1))) ((equal? sc0 45) (PreludeC-45Types-u--map_Functor_Maybe (lambda (eta-0) (- eta-0)) (DataC-45ByteVect-parsePosDbl e-0 (DataC-45ByteVect-tail arg-1))))(else (DataC-45ByteVect-parsePosDbl (+ e-0 1) arg-1)))))))))
(define Main-toCelsius (lambda (arg-0) (let ((e-0 (car arg-0))) (let ((e-1 (cdr arg-0))) (let ((sc1 (DataC-45ByteVect-parseDouble e-0 e-1))) (if (null? sc1) '() (let ((e-2 (unbox sc1))) (box (* (- e-2 32.0) (/ 5.0 9.0))))))))))
(define DataC-45ListC-45QuantifiersC-45ExtraC-45Any-collapse (lambda (arg-4 arg-5) (case (vector-ref arg-5 0) ((0) (let ((e-4 (vector-ref arg-5 1))) ((arg-4 'erased) e-4))) (else (let ((e-9 (vector-ref arg-5 1))) (DataC-45ListC-45QuantifiersC-45ExtraC-45Any-collapse (lambda (v-9700) (arg-4 'erased)) e-9))))))
(define SystemC-45PosixC-45ErrnoC-45Type-errorName (lambda (arg-0) (cond ((equal? arg-0 1) "EPERM") ((equal? arg-0 2) "ENOENT") ((equal? arg-0 3) "ESRCH") ((equal? arg-0 4) "EINTR") ((equal? arg-0 5) "EIO") ((equal? arg-0 6) "ENXIO") ((equal? arg-0 7) "E2BIG") ((equal? arg-0 8) "ENOEXEC") ((equal? arg-0 9) "EBADF") ((equal? arg-0 10) "ECHILD") ((equal? arg-0 11) "EAGAIN") ((equal? arg-0 12) "ENOMEM") ((equal? arg-0 13) "EACCES") ((equal? arg-0 14) "EFAULT") ((equal? arg-0 15) "ENOTBLK") ((equal? arg-0 16) "EBUSY") ((equal? arg-0 17) "EEXIST") ((equal? arg-0 18) "EXDEV") ((equal? arg-0 19) "ENODEV") ((equal? arg-0 20) "ENOTDIR") ((equal? arg-0 21) "EISDIR") ((equal? arg-0 22) "EINVAL") ((equal? arg-0 23) "ENFILE") ((equal? arg-0 24) "EMFILE") ((equal? arg-0 25) "ENOTTY") ((equal? arg-0 26) "ETXTBSY") ((equal? arg-0 27) "EFBIG") ((equal? arg-0 28) "ENOSPC") ((equal? arg-0 29) "ESPIPE") ((equal? arg-0 30) "EROFS") ((equal? arg-0 31) "EMLINK") ((equal? arg-0 32) "EPIPE") ((equal? arg-0 33) "EDOM") ((equal? arg-0 34) "ERANGE") ((equal? arg-0 35) "EDEADLK") ((equal? arg-0 36) "ENAMETOOLONG") ((equal? arg-0 37) "ENOLCK") ((equal? arg-0 38) "ENOSYS") ((equal? arg-0 39) "ENOTEMPTY") ((equal? arg-0 40) "ELOOP") ((equal? arg-0 42) "ENOMSG") ((equal? arg-0 43) "EIDRM") ((equal? arg-0 60) "ENOSTR") ((equal? arg-0 61) "ENODATA") ((equal? arg-0 62) "ETIME") ((equal? arg-0 63) "ENOSR") ((equal? arg-0 66) "EREMOTE") ((equal? arg-0 67) "ENOLINK") ((equal? arg-0 71) "EPROTO") ((equal? arg-0 72) "EMULTIHOP") ((equal? arg-0 74) "EBADMSG") ((equal? arg-0 75) "EOVERFLOW") ((equal? arg-0 84) "EILSEQ") ((equal? arg-0 87) "EUSERS") ((equal? arg-0 88) "ENOTSOCK") ((equal? arg-0 89) "EDESTADDRREQ") ((equal? arg-0 90) "EMSGSIZE") ((equal? arg-0 91) "EPROTOTYPE") ((equal? arg-0 92) "ENOPROTOOPT") ((equal? arg-0 93) "EPROTONOSUPPORT") ((equal? arg-0 94) "ESOCKTNOSUPPORT") ((equal? arg-0 95) "EOPNOTSUPP") ((equal? arg-0 96) "EPFNOSUPPORT") ((equal? arg-0 97) "EAFNOSUPPORT") ((equal? arg-0 98) "EADDRINUSE") ((equal? arg-0 99) "EADDRNOTAVAIL") ((equal? arg-0 100) "ENETDOWN") ((equal? arg-0 101) "ENETUNREACH") ((equal? arg-0 102) "ENETRESET") ((equal? arg-0 103) "ECONNABORTED") ((equal? arg-0 104) "ECONNRESET") ((equal? arg-0 105) "ENOBUFS") ((equal? arg-0 106) "EISCONN") ((equal? arg-0 107) "ENOTCONN") ((equal? arg-0 108) "ESHUTDOWN") ((equal? arg-0 109) "ETOOMANYREFS") ((equal? arg-0 110) "ETIMEDOUT") ((equal? arg-0 111) "ECONNREFUSED") ((equal? arg-0 112) "EHOSTDOWN") ((equal? arg-0 113) "EHOSTUNREACH") ((equal? arg-0 114) "EALREADY") ((equal? arg-0 115) "EINPROGRESS") ((equal? arg-0 116) "ESTALE") ((equal? arg-0 122) "EDQUOT") ((equal? arg-0 125) "ECANCELED") ((equal? arg-0 130) "EOWNERDEAD") ((equal? arg-0 131) "ENOTRECOVERABLE") ((equal? arg-0 44) "ECHRNG") ((equal? arg-0 45) "EL2NSYNC") ((equal? arg-0 46) "EL3HLT") ((equal? arg-0 47) "EL3RST") ((equal? arg-0 48) "ELNRNG") ((equal? arg-0 49) "EUNATCH") ((equal? arg-0 50) "ENOCSI") ((equal? arg-0 51) "EL2HLT") ((equal? arg-0 52) "EBADE") ((equal? arg-0 53) "EBADR") ((equal? arg-0 54) "EXFULL") ((equal? arg-0 55) "ENOANO") ((equal? arg-0 56) "EBADRQC") ((equal? arg-0 57) "EBADSLT") ((equal? arg-0 59) "EBFONT") ((equal? arg-0 64) "ENONET") ((equal? arg-0 65) "ENOPKG") ((equal? arg-0 68) "EADV") ((equal? arg-0 69) "ESRMNT") ((equal? arg-0 70) "ECOMM") ((equal? arg-0 73) "EDOTDOT") ((equal? arg-0 76) "ENOTUNIQ") ((equal? arg-0 77) "EBADFD") ((equal? arg-0 78) "EREMCHG") ((equal? arg-0 79) "ELIBACC") ((equal? arg-0 80) "ELIBBAD") ((equal? arg-0 81) "ELIBSCN") ((equal? arg-0 82) "ELIBMAX") ((equal? arg-0 83) "ELIBEXEC") ((equal? arg-0 85) "ERESTART") ((equal? arg-0 86) "ESTRPIPE") ((equal? arg-0 117) "EUCLEAN") ((equal? arg-0 118) "ENOTNAM") ((equal? arg-0 119) "ENAVAIL") ((equal? arg-0 120) "EISNAM") ((equal? arg-0 121) "EREMOTEIO") ((equal? arg-0 123) "ENOMEDIUM") ((equal? arg-0 124) "EMEDIUMTYPE") ((equal? arg-0 126) "ENOKEY") ((equal? arg-0 127) "EKEYEXPIRED") ((equal? arg-0 128) "EKEYREVOKED") ((equal? arg-0 129) "EKEYREJECTED") ((equal? arg-0 132) "ERFKILL") ((equal? arg-0 133) "EHWPOISON")(else "EUNKNOWN"))))
(define PreludeC-45Show-u--showPrec_Show_Bits32 (lambda (ext-0 ext-1) (PreludeC-45Show-primNumShow (lambda (eta-0) (number->string eta-0)) ext-0 ext-1)))
(define PreludeC-45Show-u--show_Show_Bits32 (lambda (arg-0) (PreludeC-45Show-u--showPrec_Show_Bits32 (vector 0 ) arg-0)))
(define SystemC-45PosixC-45ErrnoC-45Type-errorText (lambda (arg-0) (cond ((equal? arg-0 1) "Operation not permitted") ((equal? arg-0 2) "No such file or directory") ((equal? arg-0 3) "No such process") ((equal? arg-0 4) "Interrupted system call") ((equal? arg-0 5) "Input/output error") ((equal? arg-0 6) "No such device or address") ((equal? arg-0 7) "Argument list too long") ((equal? arg-0 8) "Exec format error") ((equal? arg-0 9) "Bad file descriptor") ((equal? arg-0 10) "No child processes") ((equal? arg-0 11) "Resource temporarily unavailable") ((equal? arg-0 12) "Cannot allocate memory") ((equal? arg-0 13) "Permission denied") ((equal? arg-0 14) "Bad address") ((equal? arg-0 15) "Block device required") ((equal? arg-0 16) "Device or resource busy") ((equal? arg-0 17) "File exists") ((equal? arg-0 18) "Invalid cross-device link") ((equal? arg-0 19) "No such device") ((equal? arg-0 20) "Not a directory") ((equal? arg-0 21) "Is a directory") ((equal? arg-0 22) "Invalid argument") ((equal? arg-0 23) "Too many open files in system") ((equal? arg-0 24) "Too many open files") ((equal? arg-0 25) "Inappropriate ioctl for device") ((equal? arg-0 26) "Text file busy") ((equal? arg-0 27) "File too large") ((equal? arg-0 28) "No space left on device") ((equal? arg-0 29) "Illegal seek") ((equal? arg-0 30) "Read-only file system") ((equal? arg-0 31) "Too many links") ((equal? arg-0 32) "Broken pipe") ((equal? arg-0 33) "Numerical argument out of domain") ((equal? arg-0 34) "Numerical result out of range") ((equal? arg-0 35) "Resource deadlock avoided") ((equal? arg-0 36) "File name too long") ((equal? arg-0 37) "No locks available") ((equal? arg-0 38) "Function not implemented") ((equal? arg-0 39) "Directory not empty") ((equal? arg-0 40) "Too many levels of symbolic links") ((equal? arg-0 42) "No message of desired type") ((equal? arg-0 43) "Identifier removed") ((equal? arg-0 60) "Device not a stream") ((equal? arg-0 61) "No data available") ((equal? arg-0 62) "Timer expired") ((equal? arg-0 63) "Out of streams resources") ((equal? arg-0 66) "Object is remote") ((equal? arg-0 67) "Link has been severed") ((equal? arg-0 71) "Protocol error") ((equal? arg-0 72) "Multihop attempted") ((equal? arg-0 74) "Bad message") ((equal? arg-0 75) "Value too large for defined data type") ((equal? arg-0 84) "Invalid or incomplete multibyte or wide character") ((equal? arg-0 87) "Too many users") ((equal? arg-0 88) "Socket operation on non-socket") ((equal? arg-0 89) "Destination address required") ((equal? arg-0 90) "Message too long") ((equal? arg-0 91) "Protocol wrong type for socket") ((equal? arg-0 92) "Protocol not available") ((equal? arg-0 93) "Protocol not supported") ((equal? arg-0 94) "Socket type not supported") ((equal? arg-0 95) "Operation not supported") ((equal? arg-0 96) "Protocol family not supported") ((equal? arg-0 97) "Address family not supported by protocol") ((equal? arg-0 98) "Address already in use") ((equal? arg-0 99) "Cannot assign requested address") ((equal? arg-0 100) "Network is down") ((equal? arg-0 101) "Network is unreachable") ((equal? arg-0 102) "Network dropped connection on reset") ((equal? arg-0 103) "Software caused connection abort") ((equal? arg-0 104) "Connection reset by peer") ((equal? arg-0 105) "No buffer space available") ((equal? arg-0 106) "Transport endpoint is already connected") ((equal? arg-0 107) "Transport endpoint is not connected") ((equal? arg-0 108) "Cannot send after transport endpoint shutdown") ((equal? arg-0 109) "Too many references: cannot splice") ((equal? arg-0 110) "Connection timed out") ((equal? arg-0 111) "Connection refused") ((equal? arg-0 112) "Host is down") ((equal? arg-0 113) "No route to host") ((equal? arg-0 114) "Operation already in progress") ((equal? arg-0 115) "Operation now in progress") ((equal? arg-0 116) "Stale file handle") ((equal? arg-0 122) "Disk quota exceeded") ((equal? arg-0 125) "Operation canceled") ((equal? arg-0 130) "Owner died") ((equal? arg-0 131) "State not recoverable") ((equal? arg-0 44) "Channel number out of range") ((equal? arg-0 45) "Level 2 not synchronized") ((equal? arg-0 46) "Level 3 halted") ((equal? arg-0 47) "Level 3 reset") ((equal? arg-0 48) "Link number out of range") ((equal? arg-0 49) "Protocol driver not attached") ((equal? arg-0 50) "No CSI structure available") ((equal? arg-0 51) "Level 2 halted") ((equal? arg-0 52) "Invalid exchange") ((equal? arg-0 53) "Invalid request descriptor") ((equal? arg-0 54) "Exchange full") ((equal? arg-0 55) "No anode") ((equal? arg-0 56) "Invalid request code") ((equal? arg-0 57) "Invalid slot") ((equal? arg-0 59) "Bad font file format") ((equal? arg-0 64) "Machine is not on the network") ((equal? arg-0 65) "Package not installed") ((equal? arg-0 68) "Advertise error") ((equal? arg-0 69) "Srmount error") ((equal? arg-0 70) "Communication error on send") ((equal? arg-0 73) "RFS specific error") ((equal? arg-0 76) "Name not unique on network") ((equal? arg-0 77) "File descriptor in bad state") ((equal? arg-0 78) "Remote address changed") ((equal? arg-0 79) "Can not access a needed shared library") ((equal? arg-0 80) "Accessing a corrupted shared library") ((equal? arg-0 81) ".lib section in a.out corrupted") ((equal? arg-0 82) "Attempting to link in too many shared libraries") ((equal? arg-0 83) "Cannot exec a shared library directly") ((equal? arg-0 85) "Interrupted system call should be restarted") ((equal? arg-0 86) "Streams pipe error") ((equal? arg-0 117) "Structure needs cleaning") ((equal? arg-0 118) "Not a XENIX named type file") ((equal? arg-0 119) "No XENIX semaphores available") ((equal? arg-0 120) "Is a named type file") ((equal? arg-0 121) "Remote I/O error") ((equal? arg-0 123) "No medium found") ((equal? arg-0 124) "Wrong medium type") ((equal? arg-0 126) "Required key not available") ((equal? arg-0 127) "Key has expired") ((equal? arg-0 128) "Key has been revoked") ((equal? arg-0 129) "Key was rejected by service") ((equal? arg-0 132) "Operation not possible due to RF-kill") ((equal? arg-0 133) "Memory page has hardware error")(else (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons "Unknown error: " (cons (PreludeC-45Show-u--show_Show_Bits32 arg-0) '())))))))
(define DataC-45LinearC-45Token-run1 (lambda (arg-1) ((arg-1 'erased) #f)))
(define DataC-45BufferC-45Core-alloc (lambda (arg-1 arg-2) (DataC-45LinearC-45Token-run1 (lambda (s-6166) (lambda (u--t) (let ((eff-0 (DataC-45BufferC-45Core-prim__newBuf arg-1 #f))) (((arg-2 'erased) eff-0) 'erased)))))))
(define DataC-45BufferC-45Indexed-empty (DataC-45BufferC-45Core-alloc 0 (lambda (s-861) (lambda (eta-0) (lambda (eta-1) eta-0)))))
(define DataC-45ByteVect-empty (cons DataC-45BufferC-45Indexed-empty 0))
(define PreludeC-45Types-u--C-60_Ord_Nat (lambda (arg-0 arg-1) (PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering (PreludeC-45EqOrd-u--compare_Ord_Integer arg-0 arg-1) 0)))
(define DataC-45ArrayC-45Index-tryLT (lambda (arg-0 arg-1) (PreludeC-45Types-u--C-60_Ord_Nat arg-1 arg-0)))
(define DataC-45ArrayC-45Index-tryLTE (lambda (arg-0 arg-1) (cond ((equal? arg-1 0) 1)(else (let ((e-0 (- arg-1 1))) (DataC-45ArrayC-45Index-tryLT arg-0 e-0))))))
(define DataC-45ByteString-drop (lambda (arg-0 arg-1) (let ((e-0 (car arg-1))) (let ((e-1 (cdr arg-1))) (let ((sc1 (DataC-45ArrayC-45Index-tryLTE e-0 arg-0))) (cond ((equal? sc1 1) (cons (PreludeC-45Types-prim__integerToNat (- e-0 arg-0)) (DataC-45ByteVect-drop arg-0 e-1))) (else (cons 0 DataC-45ByteVect-empty))))))))
(define DataC-45ListC-45QuantifiersC-45Extra-inject (lambda (arg-4 arg-5) (cond ((equal? arg-4 0) (vector 0 arg-5))(else (let ((e-7 (- arg-4 1))) (vector 1 (DataC-45ListC-45QuantifiersC-45Extra-inject e-7 arg-5)))))))
(define PreludeC-45EqOrd-u--C-60_Ord_Int64 (lambda (arg-0 arg-1) (let ((sc0 (or (and (< arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define SystemC-45PosixC-45Errno-case--toSize-3957 (lambda (arg-1 arg-3 arg-4) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Int64 arg-4 0))) (cond ((equal? sc0 1) (vector 0 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-1 (blodwen-toUnsignedInt (bs- 0 arg-4 63) 32)) 'erased)) (else (vector 1 (blodwen-toUnsignedInt arg-4 32) 'erased))))))
(define SystemC-45PosixC-45FileC-45Prim-write (lambda (arg-1 arg-2 arg-4 arg-5 arg-7) (lambda (clam-0) (let ((sc0 (arg-4 arg-5))) (case (vector-ref sc0 0) ((0) (let ((e-2 (vector-ref sc0 1))) (let ((e-6 (car e-2))) (let ((e-7 (cdr e-2))) (SystemC-45PosixC-45Errno-case--toSize-3957 arg-7 (lambda (eta-0) (SystemC-45PosixC-45FileC-45Prim-prim__writeptr (arg-1 arg-2) e-7 0 e-6 eta-0)) (SystemC-45PosixC-45FileC-45Prim-prim__writeptr (arg-1 arg-2) e-7 0 e-6 clam-0)))))) (else (let ((e-5 (vector-ref sc0 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (let ((e-12 (car e-9))) (let ((e-13 (cdr e-9))) (SystemC-45PosixC-45Errno-case--toSize-3957 arg-7 (lambda (eta-0) (SystemC-45PosixC-45FileC-45Prim-prim__write (arg-1 arg-2) e-12 (blodwen-toUnsignedInt e-13 32) (blodwen-toUnsignedInt e-8 32) eta-0)) (SystemC-45PosixC-45FileC-45Prim-prim__write (arg-1 arg-2) e-12 (blodwen-toUnsignedInt e-13 32) (blodwen-toUnsignedInt e-8 32) clam-0)))))))))))))
(define SystemC-45PosixC-45FileC-45Prim-n--8357-6832-u--go (lambda (arg-1 arg-2 arg-4 arg-6 arg-7 arg-8 arg-10 arg-11) (if (null? arg-8) (let ((sc1 ((SystemC-45PosixC-45FileC-45Prim-write arg-1 arg-2 (lambda (eta-0) (vector 1 eta-0)) arg-8 arg-10) arg-11))) (case (vector-ref sc1 0) ((1) (let ((e-3 (vector-ref sc1 1))) (let ((e-4 (vector-ref sc1 2))) (SystemC-45PosixC-45FileC-45Prim-n--8357-6832-u--go arg-1 arg-2 arg-4 arg-6 arg-7 (DataC-45ByteString-drop (PreludeC-45Types-prim__integerToNat e-3) arg-8) arg-10 e-4)))) (else (let ((e-8 (vector-ref sc1 1))) (let ((e-9 (vector-ref sc1 2))) (vector 0 e-8 e-9)))))) (let ((e-0 (car arg-8))) (cond ((equal? e-0 0) (vector 1 'erased arg-11))(else (let ((sc1 ((SystemC-45PosixC-45FileC-45Prim-write arg-1 arg-2 (lambda (eta-0) (vector 1 eta-0)) arg-8 arg-10) arg-11))) (case (vector-ref sc1 0) ((1) (let ((e-3 (vector-ref sc1 1))) (let ((e-4 (vector-ref sc1 2))) (SystemC-45PosixC-45FileC-45Prim-n--8357-6832-u--go arg-1 arg-2 arg-4 arg-6 arg-7 (DataC-45ByteString-drop (PreludeC-45Types-prim__integerToNat e-3) arg-8) arg-10 e-4)))) (else (let ((e-8 (vector-ref sc1 1))) (let ((e-9 (vector-ref sc1 2))) (vector 0 e-8 e-9))))))))))))
(define SystemC-45PosixC-45FileC-45Prim-case--fwriteC-44goPtr-6871 (lambda (arg-1 arg-2 arg-4 arg-6 arg-7 arg-9 arg-11 arg-12 arg-13) (case (vector-ref arg-13 0) ((1) (let ((e-3 (vector-ref arg-13 1))) (let ((e-4 (vector-ref arg-13 2))) (SystemC-45PosixC-45FileC-45Prim-n--8357-6833-u--goPtr arg-1 arg-2 arg-4 arg-6 arg-7 (DataC-45CC-45Array-prim__inc_ptr arg-12 e-3 1) (bu- arg-11 e-3 32) arg-9 e-4)))) (else (let ((e-8 (vector-ref arg-13 1))) (let ((e-9 (vector-ref arg-13 2))) (vector 0 e-8 e-9)))))))
(define SystemC-45PosixC-45FileC-45Prim-n--8357-6833-u--goPtr (lambda (arg-1 arg-2 arg-4 arg-6 arg-7 arg-8 arg-9 arg-11 arg-12) (cond ((equal? arg-9 0) (vector 1 'erased arg-12))(else (SystemC-45PosixC-45FileC-45Prim-case--fwriteC-44goPtr-6871 arg-1 arg-2 arg-4 arg-6 arg-7 arg-11 arg-9 arg-8 ((SystemC-45PosixC-45FileC-45Prim-write arg-1 arg-2 (lambda (eta-0) (vector 0 eta-0)) (cons arg-9 arg-8) arg-11) arg-12))))))
(define SystemC-45PosixC-45FileC-45Prim-fwrite (lambda (arg-1 arg-2 arg-4 arg-5 arg-7 ext-0) (let ((sc0 (arg-4 arg-5))) (case (vector-ref sc0 0) ((0) (let ((e-2 (vector-ref sc0 1))) (let ((e-6 (car e-2))) (let ((e-7 (cdr e-2))) (SystemC-45PosixC-45FileC-45Prim-n--8357-6833-u--goPtr arg-1 arg-2 arg-4 arg-7 arg-5 e-7 e-6 arg-7 ext-0))))) (else (let ((e-5 (vector-ref sc0 1))) (SystemC-45PosixC-45FileC-45Prim-n--8357-6832-u--go arg-1 arg-2 arg-4 arg-7 arg-5 e-5 arg-7 ext-0)))))))
(define PreludeC-45Types-either (lambda (arg-3 arg-4 arg-5) (case (vector-ref arg-5 0) ((0) (let ((e-2 (vector-ref arg-5 1))) ((arg-3) e-2))) (else (let ((e-5 (vector-ref arg-5 1))) ((arg-4) e-5))))))
(define ControlC-45MonadC-45MErr-handleErrors (lambda (arg-4 arg-5 arg-6) (let ((e-4 (vector-ref arg-4 3))) (((((e-4 'erased) 'erased) 'erased) (let ((e-10 (vector-ref arg-4 2))) ((((e-10 'erased) 'erased) 'erased) arg-6))) (lambda (eta-0) (PreludeC-45Types-either (lambda () arg-5) (lambda () (lambda (arg-9951) (let ((e-11 (vector-ref arg-4 1))) (((e-11 'erased) 'erased) arg-9951)))) eta-0))))))
(define DataC-45ListC-45QuantifiersC-45ExtraC-45Any-hzipWith (lambda (arg-5 arg-6 arg-7) (let ((e-4 (car arg-6))) (let ((e-5 (cdr arg-6))) (case (vector-ref arg-7 0) ((0) (let ((e-10 (vector-ref arg-7 1))) (vector 0 (((arg-5 'erased) e-4) e-10)))) (else (let ((e-15 (vector-ref arg-7 1))) (vector 1 (DataC-45ListC-45QuantifiersC-45ExtraC-45Any-hzipWith (lambda (v-9630) (arg-5 'erased)) e-5 e-15)))))))))
(define PreludeC-45Uninhabited-void (lambda () (blodwen-error-quit "No clauses in Prelude.Uninhabited.void")))
(define ControlC-45MonadC-45MCancel-guaranteeCase (lambda (arg-1 arg-4 arg-5) (let ((e-3 (vector-ref arg-1 2))) (((e-3 'erased) 'erased) (lambda (u--poll) (let ((e-8 (vector-ref arg-1 0))) (let ((e-11 (vector-ref e-8 3))) (((((e-11 'erased) 'erased) 'erased) (ControlC-45MonadC-45MErr-handleErrors (let ((e-18 (vector-ref arg-1 0))) e-18) (lambda (u--x) (let ((e-18 (vector-ref arg-1 0))) (let ((e-21 (vector-ref e-18 3))) (((((e-21 'erased) 'erased) 'erased) (ControlC-45MonadC-45MErr-handleErrors (let ((e-28 (vector-ref arg-1 0))) e-28) (lambda (eta-0) (PreludeC-45Uninhabited-void)) (arg-5 (vector 1 u--x)))) (lambda (_-10677) (let ((e-28 (vector-ref arg-1 0))) (let ((e-34 (vector-ref e-28 0))) (((e-34 'erased) 'erased) u--x)))))))) (let ((e-15 (vector-ref arg-1 3))) ((((e-15 'erased) 'erased) (((u--poll 'erased) 'erased) arg-4)) (arg-5 (vector 2 )))))) (lambda (u--v) (let ((e-18 (vector-ref arg-1 0))) (let ((e-21 (vector-ref e-18 3))) (((((e-21 'erased) 'erased) 'erased) (ControlC-45MonadC-45MErr-handleErrors (let ((e-28 (vector-ref arg-1 0))) e-28) (lambda (eta-0) (PreludeC-45Uninhabited-void)) (arg-5 (vector 0 u--v)))) (lambda (_-10677) (let ((e-28 (vector-ref arg-1 0))) (let ((e-33 (vector-ref e-28 1))) (((e-33 'erased) 'erased) u--v))))))))))))))))
(define ControlC-45MonadC-45MCancel-bracketFull (lambda (arg-1 arg-5 arg-6 arg-7) (let ((e-3 (vector-ref arg-1 2))) (((e-3 'erased) 'erased) (lambda (u--poll) (let ((e-8 (vector-ref arg-1 0))) (let ((e-11 (vector-ref e-8 3))) (((((e-11 'erased) 'erased) 'erased) (arg-5 (lambda (es-5315) (lambda (a-5316) ((u--poll 'erased) 'erased))))) (lambda (u--v) (ControlC-45MonadC-45MCancel-guaranteeCase arg-1 (((u--poll 'erased) 'erased) (arg-6 u--v)) (arg-7 u--v)))))))))))
(define DataC-45LinearC-45Ref1-case--casmod1C-44loop-1404 (lambda (arg-3 arg-4 arg-6) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-4 arg-6 (arg-3 arg-6)))) (cond ((equal? eff-0 1) 'erased)(else (DataC-45LinearC-45Ref1-n--3297-1396-u--loop arg-3 arg-4 'erased))))))
(define DataC-45LinearC-45Ref1-n--3297-1396-u--loop (lambda (arg-3 arg-4 arg-5) (DataC-45LinearC-45Ref1-case--casmod1C-44loop-1404 arg-3 arg-4 (unbox arg-4))))
(define DataC-45LinearC-45Ref1-casmod1 (lambda (arg-2 arg-3 arg-4) (DataC-45LinearC-45Ref1-n--3297-1396-u--loop arg-3 arg-2 arg-4)))
(define FSC-45Scope-childNodesL (lambda (arg-2 arg-3 arg-4 arg-5) (if (null? arg-4) arg-3 (let ((e-2 (car arg-4))) (let ((e-3 (cdr arg-4))) (let ((eff-0 (FSC-45Scope-childNodes arg-2 arg-3 e-2 arg-5))) (FSC-45Scope-childNodesL arg-2 eff-0 e-3 'erased)))))))
(define PreludeC-45TypesC-45SnocList-C-60C-62C-62 (lambda (arg-1 arg-2) (if (null? arg-1) arg-2 (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (PreludeC-45TypesC-45SnocList-C-60C-62C-62 e-2 (cons e-3 arg-2)))))))
(define PreludeC-45TypesC-45List-mapMaybeAppend (lambda (arg-2 arg-3 arg-4) (if (null? arg-4) (PreludeC-45TypesC-45SnocList-C-60C-62C-62 arg-2 '()) (let ((e-1 (car arg-4))) (let ((e-2 (cdr arg-4))) (let ((sc1 (arg-3 e-1))) (if (null? sc1) (PreludeC-45TypesC-45List-mapMaybeAppend arg-2 arg-3 e-2) (let ((e-3 (unbox sc1))) (PreludeC-45TypesC-45List-mapMaybeAppend (cons arg-2 e-3) arg-3 e-2)))))))))
(define DataC-45List-catMaybes (lambda (ext-0) (PreludeC-45TypesC-45List-mapMaybeAppend '() (lambda (eta-0) eta-0) ext-0)))
(define DataC-45SortedMapC-45Dependent-treeLookup (lambda (arg-4 arg-5 arg-6) (case (vector-ref arg-6 0) ((0) (let ((e-3 (vector-ref arg-6 1))) (let ((e-4 (vector-ref arg-6 2))) (let ((sc1 (let ((e-1 (vector-ref arg-4 0))) (let ((e-12 (car e-1))) ((e-12 arg-5) e-3))))) (cond ((equal? sc1 1) (box (cons e-3 e-4))) (else '())))))) ((1) (let ((e-9 (vector-ref arg-6 1))) (let ((e-10 (vector-ref arg-6 2))) (let ((e-11 (vector-ref arg-6 3))) (let ((sc1 (let ((e-5 (vector-ref arg-4 4))) ((e-5 arg-5) e-10)))) (cond ((equal? sc1 1) (DataC-45SortedMapC-45Dependent-treeLookup arg-4 arg-5 e-9)) (else (DataC-45SortedMapC-45Dependent-treeLookup arg-4 arg-5 e-11)))))))) (else (let ((e-16 (vector-ref arg-6 1))) (let ((e-17 (vector-ref arg-6 2))) (let ((e-18 (vector-ref arg-6 3))) (let ((e-19 (vector-ref arg-6 4))) (let ((e-20 (vector-ref arg-6 5))) (let ((sc1 (let ((e-5 (vector-ref arg-4 4))) ((e-5 arg-5) e-17)))) (cond ((equal? sc1 1) (DataC-45SortedMapC-45Dependent-treeLookup arg-4 arg-5 e-16)) (else (let ((sc2 (let ((e-5 (vector-ref arg-4 4))) ((e-5 arg-5) e-19)))) (cond ((equal? sc2 1) (DataC-45SortedMapC-45Dependent-treeLookup arg-4 arg-5 e-18)) (else (DataC-45SortedMapC-45Dependent-treeLookup arg-4 arg-5 e-20))))))))))))))))
(define DataC-45SortedMapC-45Dependent-lookup (lambda (arg-2 arg-3) (case (vector-ref arg-3 0) ((0) '()) (else (let ((e-5 (vector-ref arg-3 1))) (let ((e-7 (vector-ref arg-3 3))) (DataC-45SortedMapC-45Dependent-treeLookup e-5 arg-2 e-7)))))))
(define DataC-45SortedMap-lookup (lambda (arg-2 ext-0) (PreludeC-45Types-u--map_Functor_Maybe (lambda (eta-0) (let ((e-3 (cdr eta-0))) e-3)) (DataC-45SortedMapC-45Dependent-lookup arg-2 ext-0))))
(define FSC-45Scope-findNode (lambda (arg-2 arg-3 arg-4) (let ((eff-0 (unbox arg-2))) (DataC-45SortedMap-lookup arg-3 eff-0))))
(define DataC-45LinearC-45Traverse1-traverse1List (lambda (arg-3 arg-4 arg-5 arg-6) (if (null? arg-5) (PreludeC-45TypesC-45SnocList-C-60C-62C-62 arg-3 '()) (let ((e-2 (car arg-5))) (let ((e-3 (cdr arg-5))) (let ((eff-0 ((arg-4 e-2) arg-6))) (DataC-45LinearC-45Traverse1-traverse1List (cons arg-3 eff-0) arg-4 e-3 'erased)))))))
(define FSC-45Scope-findNodes (lambda (arg-2 arg-3 arg-4) (let ((eff-0 (DataC-45LinearC-45Traverse1-traverse1List '() (lambda (eta-0) (lambda (eta-1) (FSC-45Scope-findNode arg-2 eta-0 eta-1))) arg-3 arg-4))) (DataC-45List-catMaybes eff-0))))
(define PreludeC-45TypesC-45List-reverseOnto (lambda (arg-1 arg-2) (if (null? arg-2) arg-1 (let ((e-2 (car arg-2))) (let ((e-3 (cdr arg-2))) (PreludeC-45TypesC-45List-reverseOnto (cons e-2 arg-1) e-3))))))
(define PreludeC-45TypesC-45List-reverse (lambda (ext-0) (PreludeC-45TypesC-45List-reverseOnto '() ext-0)))
(define Builtin-fst (lambda (arg-2) (let ((e-2 (car arg-2))) e-2)))
(define PreludeC-45TypesC-45List-mapAppend (lambda (arg-2 arg-3 arg-4) (if (null? arg-4) (PreludeC-45TypesC-45SnocList-C-60C-62C-62 arg-2 '()) (let ((e-1 (car arg-4))) (let ((e-2 (cdr arg-4))) (PreludeC-45TypesC-45List-mapAppend (cons arg-2 (arg-3 e-1)) arg-3 e-2))))))
(define DataC-45SortedMapC-45Dependent-n--6828-9064-u--treeToListC-39 (lambda (arg-5 arg-6) (case (vector-ref arg-6 0) ((0) (let ((e-3 (vector-ref arg-6 1))) (let ((e-4 (vector-ref arg-6 2))) (arg-5 (cons e-3 e-4))))) ((1) (let ((e-9 (vector-ref arg-6 1))) (let ((e-11 (vector-ref arg-6 3))) (DataC-45SortedMapC-45Dependent-n--6828-9064-u--treeToListC-39 (lambda (arg-0) (cons arg-0 (DataC-45SortedMapC-45Dependent-n--6828-9064-u--treeToListC-39 arg-5 e-11))) e-9)))) (else (let ((e-16 (vector-ref arg-6 1))) (let ((e-18 (vector-ref arg-6 3))) (let ((e-20 (vector-ref arg-6 5))) (DataC-45SortedMapC-45Dependent-n--6828-9064-u--treeToListC-39 (lambda (arg-0) (cons arg-0 (DataC-45SortedMapC-45Dependent-n--6828-9064-u--treeToListC-39 (lambda (arg-1) (cons arg-1 (DataC-45SortedMapC-45Dependent-n--6828-9064-u--treeToListC-39 arg-5 e-20))) e-18))) e-16))))))))
(define DataC-45SortedMapC-45Dependent-treeToList (lambda (ext-0) (DataC-45SortedMapC-45Dependent-n--6828-9064-u--treeToListC-39 (lambda (arg-0) (cons arg-0 '())) ext-0)))
(define DataC-45SortedMapC-45Dependent-toList (lambda (arg-2) (case (vector-ref arg-2 0) ((0) '()) (else (let ((e-7 (vector-ref arg-2 3))) (DataC-45SortedMapC-45Dependent-treeToList e-7))))))
(define DataC-45SortedMap-toList (lambda (ext-0) (PreludeC-45TypesC-45List-mapAppend '() (lambda (eta-0) eta-0) (DataC-45SortedMapC-45Dependent-toList ext-0))))
(define DataC-45SortedMap-keys (lambda (ext-0) (PreludeC-45TypesC-45List-mapAppend '() (lambda (eta-0) (Builtin-fst eta-0)) (DataC-45SortedMap-toList ext-0))))
(define DataC-45SortedSet-u--toList_Foldable_SortedSet (lambda (arg-1) (DataC-45SortedMap-keys arg-1)))
(define FSC-45Scope-childNodes (lambda (arg-2 arg-3 arg-4 arg-5) (let ((eff-0 (FSC-45Scope-findNodes arg-2 (PreludeC-45TypesC-45List-reverse (DataC-45SortedSet-u--toList_Foldable_SortedSet (let ((e-3 (vector-ref arg-4 2))) e-3))) arg-5))) (FSC-45Scope-childNodesL arg-2 (cons arg-4 arg-3) eff-0 'erased))))
(define DataC-45SortedMapC-45Dependent-branch4 (lambda (arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 arg-10) (vector 1 (vector 1 arg-4 arg-5 arg-6) arg-7 (vector 1 arg-8 arg-9 arg-10))))
(define DataC-45SortedMapC-45Dependent-branch5 (lambda (arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-11 arg-12) (vector 1 (vector 1 arg-4 arg-5 arg-6) arg-7 (vector 2 arg-8 arg-9 arg-10 arg-11 arg-12))))
(define DataC-45SortedMapC-45Dependent-branch6 (lambda (arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-11 arg-12 arg-13 arg-14) (vector 2 (vector 1 arg-4 arg-5 arg-6) arg-7 (vector 1 arg-8 arg-9 arg-10) arg-11 (vector 1 arg-12 arg-13 arg-14))))
(define DataC-45SortedMapC-45Dependent-branch7 (lambda (arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-11 arg-12 arg-13 arg-14 arg-15 arg-16) (vector 2 (vector 2 arg-4 arg-5 arg-6 arg-7 arg-8) arg-9 (vector 1 arg-10 arg-11 arg-12) arg-13 (vector 1 arg-14 arg-15 arg-16))))
(define DataC-45SortedMapC-45Dependent-merge1 (lambda (arg-4 arg-5 arg-6 arg-7 arg-8) (case (vector-ref arg-6 0) ((1) (let ((e-4 (vector-ref arg-6 1))) (let ((e-5 (vector-ref arg-6 2))) (let ((e-6 (vector-ref arg-6 3))) (case (vector-ref arg-8 0) ((1) (let ((e-20 (vector-ref arg-8 1))) (let ((e-21 (vector-ref arg-8 2))) (let ((e-22 (vector-ref arg-8 3))) (DataC-45SortedMapC-45Dependent-branch5 arg-4 arg-5 e-4 e-5 e-6 arg-7 e-20 e-21 e-22))))) (else (let ((e-27 (vector-ref arg-8 1))) (let ((e-28 (vector-ref arg-8 2))) (let ((e-29 (vector-ref arg-8 3))) (let ((e-30 (vector-ref arg-8 4))) (let ((e-31 (vector-ref arg-8 5))) (DataC-45SortedMapC-45Dependent-branch6 arg-4 arg-5 e-4 e-5 e-6 arg-7 e-27 e-28 e-29 e-30 e-31)))))))))))) (else (let ((e-11 (vector-ref arg-6 1))) (let ((e-12 (vector-ref arg-6 2))) (let ((e-13 (vector-ref arg-6 3))) (let ((e-14 (vector-ref arg-6 4))) (let ((e-15 (vector-ref arg-6 5))) (case (vector-ref arg-8 0) ((1) (let ((e-36 (vector-ref arg-8 1))) (let ((e-37 (vector-ref arg-8 2))) (let ((e-38 (vector-ref arg-8 3))) (DataC-45SortedMapC-45Dependent-branch6 arg-4 arg-5 e-11 e-12 e-13 e-14 e-15 arg-7 e-36 e-37 e-38))))) (else (let ((e-43 (vector-ref arg-8 1))) (let ((e-44 (vector-ref arg-8 2))) (let ((e-45 (vector-ref arg-8 3))) (let ((e-46 (vector-ref arg-8 4))) (let ((e-47 (vector-ref arg-8 5))) (DataC-45SortedMapC-45Dependent-branch7 arg-4 arg-5 e-11 e-12 e-13 e-14 e-15 arg-7 e-43 e-44 e-45 e-46 e-47)))))))))))))))))
(define DataC-45SortedMapC-45Dependent-merge2 (lambda (arg-4 arg-5 arg-6 arg-7 arg-8) (case (vector-ref arg-4 0) ((1) (let ((e-4 (vector-ref arg-4 1))) (let ((e-5 (vector-ref arg-4 2))) (let ((e-6 (vector-ref arg-4 3))) (case (vector-ref arg-8 0) ((1) (let ((e-20 (vector-ref arg-8 1))) (let ((e-21 (vector-ref arg-8 2))) (let ((e-22 (vector-ref arg-8 3))) (DataC-45SortedMapC-45Dependent-branch5 e-4 e-5 e-6 arg-5 arg-6 arg-7 e-20 e-21 e-22))))) (else (let ((e-27 (vector-ref arg-8 1))) (let ((e-28 (vector-ref arg-8 2))) (let ((e-29 (vector-ref arg-8 3))) (let ((e-30 (vector-ref arg-8 4))) (let ((e-31 (vector-ref arg-8 5))) (DataC-45SortedMapC-45Dependent-branch6 e-4 e-5 e-6 arg-5 arg-6 arg-7 e-27 e-28 e-29 e-30 e-31)))))))))))) (else (let ((e-11 (vector-ref arg-4 1))) (let ((e-12 (vector-ref arg-4 2))) (let ((e-13 (vector-ref arg-4 3))) (let ((e-14 (vector-ref arg-4 4))) (let ((e-15 (vector-ref arg-4 5))) (case (vector-ref arg-8 0) ((1) (let ((e-36 (vector-ref arg-8 1))) (let ((e-37 (vector-ref arg-8 2))) (let ((e-38 (vector-ref arg-8 3))) (DataC-45SortedMapC-45Dependent-branch6 e-11 e-12 e-13 e-14 e-15 arg-5 arg-6 arg-7 e-36 e-37 e-38))))) (else (let ((e-43 (vector-ref arg-8 1))) (let ((e-44 (vector-ref arg-8 2))) (let ((e-45 (vector-ref arg-8 3))) (let ((e-46 (vector-ref arg-8 4))) (let ((e-47 (vector-ref arg-8 5))) (DataC-45SortedMapC-45Dependent-branch7 e-11 e-12 e-13 e-14 e-15 arg-5 arg-6 arg-7 e-43 e-44 e-45 e-46 e-47)))))))))))))))))
(define DataC-45SortedMapC-45Dependent-merge3 (lambda (arg-4 arg-5 arg-6 arg-7 arg-8) (case (vector-ref arg-4 0) ((1) (let ((e-4 (vector-ref arg-4 1))) (let ((e-5 (vector-ref arg-4 2))) (let ((e-6 (vector-ref arg-4 3))) (case (vector-ref arg-6 0) ((1) (let ((e-20 (vector-ref arg-6 1))) (let ((e-21 (vector-ref arg-6 2))) (let ((e-22 (vector-ref arg-6 3))) (DataC-45SortedMapC-45Dependent-branch5 e-4 e-5 e-6 arg-5 e-20 e-21 e-22 arg-7 arg-8))))) (else (let ((e-27 (vector-ref arg-6 1))) (let ((e-28 (vector-ref arg-6 2))) (let ((e-29 (vector-ref arg-6 3))) (let ((e-30 (vector-ref arg-6 4))) (let ((e-31 (vector-ref arg-6 5))) (DataC-45SortedMapC-45Dependent-branch6 e-4 e-5 e-6 arg-5 e-27 e-28 e-29 e-30 e-31 arg-7 arg-8)))))))))))) (else (let ((e-11 (vector-ref arg-4 1))) (let ((e-12 (vector-ref arg-4 2))) (let ((e-13 (vector-ref arg-4 3))) (let ((e-14 (vector-ref arg-4 4))) (let ((e-15 (vector-ref arg-4 5))) (case (vector-ref arg-6 0) ((1) (let ((e-36 (vector-ref arg-6 1))) (let ((e-37 (vector-ref arg-6 2))) (let ((e-38 (vector-ref arg-6 3))) (DataC-45SortedMapC-45Dependent-branch6 e-11 e-12 e-13 e-14 e-15 arg-5 e-36 e-37 e-38 arg-7 arg-8))))) (else (let ((e-43 (vector-ref arg-6 1))) (let ((e-44 (vector-ref arg-6 2))) (let ((e-45 (vector-ref arg-6 3))) (let ((e-46 (vector-ref arg-6 4))) (let ((e-47 (vector-ref arg-6 5))) (DataC-45SortedMapC-45Dependent-branch7 e-11 e-12 e-13 e-14 e-15 arg-5 e-43 e-44 e-45 e-46 e-47 arg-7 arg-8)))))))))))))))))
(define DataC-45SortedMapC-45Dependent-treeDelete (lambda (arg-3 arg-4 arg-5 arg-6) (cond ((equal? arg-4 0) (let ((e-4 (vector-ref arg-6 1))) (let ((e-5 (vector-ref arg-6 2))) (let ((sc2 (let ((e-1 (vector-ref arg-3 0))) (let ((e-12 (car e-1))) ((e-12 arg-5) e-4))))) (cond ((equal? sc2 1) (vector 1 'erased)) (else (vector 0 (vector 0 e-4 e-5))))))))(else (let ((e-0 (- arg-4 1))) (cond ((equal? e-0 0) (case (vector-ref arg-6 0) ((1) (let ((e-11 (vector-ref arg-6 1))) (let ((e-12 (vector-ref arg-6 2))) (let ((e-13 (vector-ref arg-6 3))) (let ((sc2 (let ((e-5 (vector-ref arg-3 4))) ((e-5 arg-5) e-12)))) (cond ((equal? sc2 1) (let ((sc3 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 0 arg-5 e-11))) (case (vector-ref sc3 0) ((0) (let ((e-2 (vector-ref sc3 1))) (vector 0 (vector 1 e-2 e-12 e-13)))) (else (vector 1 e-13))))) (else (let ((sc3 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 0 arg-5 e-13))) (case (vector-ref sc3 0) ((0) (let ((e-2 (vector-ref sc3 1))) (vector 0 (vector 1 e-11 e-12 e-2)))) (else (vector 1 e-11))))))))))) (else (let ((e-18 (vector-ref arg-6 1))) (let ((e-19 (vector-ref arg-6 2))) (let ((e-20 (vector-ref arg-6 3))) (let ((e-21 (vector-ref arg-6 4))) (let ((e-22 (vector-ref arg-6 5))) (let ((sc2 (let ((e-5 (vector-ref arg-3 4))) ((e-5 arg-5) e-19)))) (cond ((equal? sc2 1) (let ((sc3 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 0 arg-5 e-18))) (case (vector-ref sc3 0) ((0) (let ((e-2 (vector-ref sc3 1))) (vector 0 (vector 2 e-2 e-19 e-20 e-21 e-22)))) (else (vector 0 (vector 1 e-20 e-21 e-22)))))) (else (let ((sc3 (let ((e-5 (vector-ref arg-3 4))) ((e-5 arg-5) e-21)))) (cond ((equal? sc3 1) (let ((sc4 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 0 arg-5 e-20))) (case (vector-ref sc4 0) ((0) (let ((e-2 (vector-ref sc4 1))) (vector 0 (vector 2 e-18 e-19 e-2 e-21 e-22)))) (else (vector 0 (vector 1 e-18 e-19 e-22)))))) (else (let ((sc4 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 0 arg-5 e-22))) (case (vector-ref sc4 0) ((0) (let ((e-2 (vector-ref sc4 1))) (vector 0 (vector 2 e-18 e-19 e-20 e-21 e-2)))) (else (vector 0 (vector 1 e-18 e-19 e-20)))))))))))))))))))(else (let ((e-6 (- e-0 1))) (case (vector-ref arg-6 0) ((1) (let ((e-27 (vector-ref arg-6 1))) (let ((e-28 (vector-ref arg-6 2))) (let ((e-29 (vector-ref arg-6 3))) (let ((sc1 (let ((e-5 (vector-ref arg-3 4))) ((e-5 arg-5) e-28)))) (cond ((equal? sc1 1) (let ((sc2 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 (+ e-6 1) arg-5 e-27))) (case (vector-ref sc2 0) ((0) (let ((e-2 (vector-ref sc2 1))) (vector 0 (vector 1 e-2 e-28 e-29)))) (else (let ((e-5 (vector-ref sc2 1))) (case (vector-ref e-29 0) ((1) (let ((e-4 (vector-ref e-29 1))) (let ((e-8 (vector-ref e-29 2))) (let ((e-7 (vector-ref e-29 3))) (vector 1 (vector 2 e-5 e-28 e-4 e-8 e-7)))))) (else (let ((e-11 (vector-ref e-29 1))) (let ((e-12 (vector-ref e-29 2))) (let ((e-13 (vector-ref e-29 3))) (let ((e-14 (vector-ref e-29 4))) (let ((e-15 (vector-ref e-29 5))) (vector 0 (DataC-45SortedMapC-45Dependent-branch4 e-5 e-28 e-11 e-12 e-13 e-14 e-15)))))))))))))) (else (let ((sc2 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 (+ e-6 1) arg-5 e-29))) (case (vector-ref sc2 0) ((0) (let ((e-2 (vector-ref sc2 1))) (vector 0 (vector 1 e-27 e-28 e-2)))) (else (let ((e-5 (vector-ref sc2 1))) (case (vector-ref e-27 0) ((1) (let ((e-4 (vector-ref e-27 1))) (let ((e-8 (vector-ref e-27 2))) (let ((e-7 (vector-ref e-27 3))) (vector 1 (vector 2 e-4 e-8 e-7 e-28 e-5)))))) (else (let ((e-11 (vector-ref e-27 1))) (let ((e-12 (vector-ref e-27 2))) (let ((e-13 (vector-ref e-27 3))) (let ((e-14 (vector-ref e-27 4))) (let ((e-15 (vector-ref e-27 5))) (vector 0 (DataC-45SortedMapC-45Dependent-branch4 e-11 e-12 e-13 e-14 e-15 e-28 e-5)))))))))))))))))))) (else (let ((e-34 (vector-ref arg-6 1))) (let ((e-35 (vector-ref arg-6 2))) (let ((e-36 (vector-ref arg-6 3))) (let ((e-37 (vector-ref arg-6 4))) (let ((e-38 (vector-ref arg-6 5))) (let ((sc1 (let ((e-5 (vector-ref arg-3 4))) ((e-5 arg-5) e-35)))) (cond ((equal? sc1 1) (let ((sc2 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 (+ e-6 1) arg-5 e-34))) (case (vector-ref sc2 0) ((0) (let ((e-2 (vector-ref sc2 1))) (vector 0 (vector 2 e-2 e-35 e-36 e-37 e-38)))) (else (let ((e-5 (vector-ref sc2 1))) (vector 0 (DataC-45SortedMapC-45Dependent-merge1 e-5 e-35 e-36 e-37 e-38))))))) (else (let ((sc2 (let ((e-5 (vector-ref arg-3 4))) ((e-5 arg-5) e-37)))) (cond ((equal? sc2 1) (let ((sc3 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 (+ e-6 1) arg-5 e-36))) (case (vector-ref sc3 0) ((0) (let ((e-2 (vector-ref sc3 1))) (vector 0 (vector 2 e-34 e-35 e-2 e-37 e-38)))) (else (let ((e-5 (vector-ref sc3 1))) (vector 0 (DataC-45SortedMapC-45Dependent-merge2 e-34 e-35 e-5 e-37 e-38))))))) (else (let ((sc3 (DataC-45SortedMapC-45Dependent-treeDelete arg-3 (+ e-6 1) arg-5 e-38))) (case (vector-ref sc3 0) ((0) (let ((e-2 (vector-ref sc3 1))) (vector 0 (vector 2 e-34 e-35 e-36 e-37 e-2)))) (else (let ((e-5 (vector-ref sc3 1))) (vector 0 (DataC-45SortedMapC-45Dependent-merge3 e-34 e-35 e-36 e-37 e-5)))))))))))))))))))))))))))
(define DataC-45SortedMapC-45Dependent-delete (lambda (arg-2 arg-3) (case (vector-ref arg-3 0) ((0) (let ((e-2 (vector-ref arg-3 1))) (vector 0 e-2))) (else (let ((e-5 (vector-ref arg-3 1))) (let ((e-6 (vector-ref arg-3 2))) (let ((e-7 (vector-ref arg-3 3))) (cond ((equal? e-6 0) (let ((sc2 (DataC-45SortedMapC-45Dependent-treeDelete e-5 0 arg-2 e-7))) (case (vector-ref sc2 0) ((0) (let ((e-2 (vector-ref sc2 1))) (vector 1 e-5 0 e-2))) (else (vector 0 e-5)))))(else (let ((e-8 (- e-6 1))) (let ((sc1 (DataC-45SortedMapC-45Dependent-treeDelete e-5 (+ e-8 1) arg-2 e-7))) (case (vector-ref sc1 0) ((0) (let ((e-2 (vector-ref sc1 1))) (vector 1 e-5 (+ e-8 1) e-2))) (else (let ((e-9 (vector-ref sc1 1))) (vector 1 e-5 e-8 e-9)))))))))))))))
(define DataC-45SortedMap-delete (lambda (arg-2 ext-0) (DataC-45SortedMapC-45Dependent-delete arg-2 ext-0)))
(define FSC-45Scope-deleteNode (lambda (arg-1 arg-2) (DataC-45SortedMap-delete (let ((e-1 (vector-ref arg-2 0))) (let ((e-9 (vector-ref e-1 0))) e-9)) arg-1)))
(define PreludeC-45Types-listBindOnto (lambda (arg-2 arg-3 arg-4) (if (null? arg-4) (PreludeC-45TypesC-45List-reverse arg-3) (let ((e-2 (car arg-4))) (let ((e-3 (cdr arg-4))) (PreludeC-45Types-listBindOnto arg-2 (PreludeC-45TypesC-45List-reverseOnto arg-3 (arg-2 e-2)) e-3))))))
(define PreludeC-45Types-listBind (lambda (arg-2 arg-3) (PreludeC-45Types-listBindOnto arg-3 '() arg-2)))
(define DataC-45SortedSet-delete (lambda (arg-1 arg-2) (DataC-45SortedMap-delete arg-1 arg-2)))
(define DataC-45SortedMapC-45Dependent-treeInsertC-39 (lambda (arg-4 arg-5 arg-6 arg-7) (case (vector-ref arg-7 0) ((0) (let ((e-3 (vector-ref arg-7 1))) (let ((e-4 (vector-ref arg-7 2))) (let ((sc1 (let ((e-2 (vector-ref arg-4 1))) ((e-2 arg-5) e-3)))) (cond ((equal? sc1 0) (vector 1 (cons (vector 0 arg-5 arg-6) (cons arg-5 (vector 0 e-3 e-4))))) ((equal? sc1 1) (vector 0 (vector 0 arg-5 arg-6))) (else (vector 1 (cons (vector 0 e-3 e-4) (cons e-3 (vector 0 arg-5 arg-6)))))))))) ((1) (let ((e-9 (vector-ref arg-7 1))) (let ((e-10 (vector-ref arg-7 2))) (let ((e-11 (vector-ref arg-7 3))) (let ((sc1 (let ((e-5 (vector-ref arg-4 4))) ((e-5 arg-5) e-10)))) (cond ((equal? sc1 1) (let ((sc2 (DataC-45SortedMapC-45Dependent-treeInsertC-39 arg-4 arg-5 arg-6 e-9))) (case (vector-ref sc2 0) ((0) (let ((e-2 (vector-ref sc2 1))) (vector 0 (vector 1 e-2 e-10 e-11)))) (else (let ((e-5 (vector-ref sc2 1))) (let ((e-8 (car e-5))) (let ((e-12 (cdr e-5))) (let ((e-14 (car e-12))) (let ((e-13 (cdr e-12))) (vector 0 (vector 2 e-8 e-14 e-13 e-10 e-11))))))))))) (else (let ((sc2 (DataC-45SortedMapC-45Dependent-treeInsertC-39 arg-4 arg-5 arg-6 e-11))) (case (vector-ref sc2 0) ((0) (let ((e-2 (vector-ref sc2 1))) (vector 0 (vector 1 e-9 e-10 e-2)))) (else (let ((e-5 (vector-ref sc2 1))) (let ((e-8 (car e-5))) (let ((e-12 (cdr e-5))) (let ((e-14 (car e-12))) (let ((e-13 (cdr e-12))) (vector 0 (vector 2 e-9 e-10 e-8 e-14 e-13))))))))))))))))) (else (let ((e-16 (vector-ref arg-7 1))) (let ((e-17 (vector-ref arg-7 2))) (let ((e-18 (vector-ref arg-7 3))) (let ((e-19 (vector-ref arg-7 4))) (let ((e-20 (vector-ref arg-7 5))) (let ((sc1 (let ((e-5 (vector-ref arg-4 4))) ((e-5 arg-5) e-17)))) (cond ((equal? sc1 1) (let ((sc2 (DataC-45SortedMapC-45Dependent-treeInsertC-39 arg-4 arg-5 arg-6 e-16))) (case (vector-ref sc2 0) ((0) (let ((e-2 (vector-ref sc2 1))) (vector 0 (vector 2 e-2 e-17 e-18 e-19 e-20)))) (else (let ((e-5 (vector-ref sc2 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (let ((e-12 (car e-9))) (let ((e-13 (cdr e-9))) (vector 1 (cons (vector 1 e-8 e-12 e-13) (cons e-17 (vector 1 e-18 e-19 e-20))))))))))))) (else (let ((sc2 (let ((e-5 (vector-ref arg-4 4))) ((e-5 arg-5) e-19)))) (cond ((equal? sc2 1) (let ((sc3 (DataC-45SortedMapC-45Dependent-treeInsertC-39 arg-4 arg-5 arg-6 e-18))) (case (vector-ref sc3 0) ((0) (let ((e-2 (vector-ref sc3 1))) (vector 0 (vector 2 e-16 e-17 e-2 e-19 e-20)))) (else (let ((e-5 (vector-ref sc3 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (let ((e-12 (car e-9))) (let ((e-13 (cdr e-9))) (vector 1 (cons (vector 1 e-16 e-17 e-8) (cons e-12 (vector 1 e-13 e-19 e-20))))))))))))) (else (let ((sc3 (DataC-45SortedMapC-45Dependent-treeInsertC-39 arg-4 arg-5 arg-6 e-20))) (case (vector-ref sc3 0) ((0) (let ((e-2 (vector-ref sc3 1))) (vector 0 (vector 2 e-16 e-17 e-18 e-19 e-2)))) (else (let ((e-5 (vector-ref sc3 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (let ((e-12 (car e-9))) (let ((e-13 (cdr e-9))) (vector 1 (cons (vector 1 e-16 e-17 e-18) (cons e-19 (vector 1 e-8 e-12 e-13)))))))))))))))))))))))))))
(define DataC-45SortedMapC-45Dependent-treeInsert (lambda (arg-4 arg-5 arg-6 arg-7) (let ((sc0 (DataC-45SortedMapC-45Dependent-treeInsertC-39 arg-4 arg-5 arg-6 arg-7))) (case (vector-ref sc0 0) ((0) (let ((e-2 (vector-ref sc0 1))) (vector 0 e-2))) (else (let ((e-5 (vector-ref sc0 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (let ((e-12 (car e-9))) (let ((e-13 (cdr e-9))) (vector 1 (vector 1 e-8 e-12 e-13))))))))))))
(define DataC-45SortedMapC-45Dependent-insert (lambda (arg-2 arg-3 arg-4) (case (vector-ref arg-4 0) ((0) (let ((e-2 (vector-ref arg-4 1))) (vector 1 e-2 0 (vector 0 arg-2 arg-3)))) (else (let ((e-5 (vector-ref arg-4 1))) (let ((e-6 (vector-ref arg-4 2))) (let ((e-7 (vector-ref arg-4 3))) (let ((sc1 (DataC-45SortedMapC-45Dependent-treeInsert e-5 arg-2 arg-3 e-7))) (case (vector-ref sc1 0) ((0) (let ((e-2 (vector-ref sc1 1))) (vector 1 e-5 e-6 e-2))) (else (let ((e-8 (vector-ref sc1 1))) (vector 1 e-5 (+ e-6 1) e-8))))))))))))
(define DataC-45SortedMap-insert (lambda (arg-2 arg-3 ext-0) (DataC-45SortedMapC-45Dependent-insert arg-2 arg-3 ext-0)))
(define FSC-45Scope-insertScope (lambda (arg-1 ext-0) (DataC-45SortedMap-insert (let ((e-1 (vector-ref arg-1 0))) (let ((e-9 (vector-ref e-1 0))) e-9)) arg-1 ext-0)))
(define DataC-45Maybe-fromMaybe (lambda (arg-1 arg-2) (if (null? arg-2) (arg-1) (let ((e-2 (unbox arg-2))) e-2))))
(define FSC-45Scope-getRoot (lambda (arg-2 arg-3 arg-4 ext-0) (DataC-45Maybe-fromMaybe (lambda () (vector (vector arg-4 arg-4 '() '() arg-3 arg-2) '() (force csegen-227))) (DataC-45SortedMap-lookup arg-4 ext-0))))
(define FSC-45Scope-n--8121-6173-u--go (lambda (arg-2 arg-3 arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 arg-10) (if (null? arg-10) (FSC-45Scope-getRoot arg-7 (let ((e-6 (vector-ref arg-8 4))) e-6) (let ((e-3 (vector-ref arg-8 1))) e-3) arg-9) (let ((e-2 (car arg-10))) (let ((e-3 (cdr arg-10))) (DataC-45Maybe-fromMaybe (lambda () (FSC-45Scope-n--8121-6173-u--go arg-2 arg-3 arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 e-3)) (DataC-45SortedMap-lookup e-2 arg-9)))))))
(define FSC-45Scope-openAncestor (lambda (arg-1 arg-2) (let ((e-2 (vector-ref arg-2 0))) (let ((e-3 (vector-ref arg-2 1))) (let ((e-4 (vector-ref arg-2 2))) (let ((e-5 (vector-ref arg-2 3))) (let ((e-6 (vector-ref arg-2 4))) (let ((e-7 (vector-ref arg-2 5))) (FSC-45Scope-n--8121-6173-u--go e-2 e-3 e-4 e-5 e-6 e-7 arg-2 arg-1 (let ((e-11 (vector-ref arg-2 2))) e-11))))))))))
(define FSC-45Scope-removeChild (lambda (arg-1 arg-2 arg-3) (cond ((equal? arg-1 0) arg-3) (else (let ((u--par (FSC-45Scope-openAncestor arg-3 arg-2))) (FSC-45Scope-insertScope (let ((e-1 (vector-ref u--par 0))) (let ((e-2 (vector-ref u--par 1))) (let ((e-3 (vector-ref u--par 2))) (vector e-1 e-2 (DataC-45SortedSet-delete (let ((e-9 (vector-ref arg-2 0))) e-9) e-3))))) arg-3))))))
(define PreludeC-45Interfaces-C-42C-62 (lambda (arg-3 arg-4 arg-5) (let ((e-3 (vector-ref arg-3 2))) ((((e-3 'erased) 'erased) (((let ((eff-0 (let ((e-6 (vector-ref arg-3 0))) e-6))) ((eff-0 'erased) 'erased)) (lambda (eta-0) (lambda (eta-1) eta-1))) arg-4)) arg-5))))
(define PreludeC-45Interfaces-traverse_ (lambda (arg-4 arg-5 arg-6) (let ((e-1 (vector-ref arg-5 0))) ((((e-1 'erased) 'erased) (lambda (eta-0) (lambda (eta-1) (PreludeC-45Interfaces-C-42C-62 arg-4 (arg-6 eta-0) eta-1)))) (let ((e-8 (vector-ref arg-4 1))) ((e-8 'erased) 'erased))))))
(define PreludeC-45Types-u--foldlM_Foldable_List (lambda (arg-3 arg-4 arg-5 ext-0) (PreludeC-45Types-u--foldl_Foldable_List (lambda (u--ma) (lambda (u--b) (let ((e-2 (vector-ref arg-3 1))) ((((e-2 'erased) 'erased) u--ma) (lambda (eta-0) (PreludeC-45Basics-flip arg-4 u--b eta-0)))))) (let ((e-1 (vector-ref arg-3 0))) (let ((e-5 (vector-ref e-1 1))) ((e-5 'erased) arg-5))) ext-0)))
(define PreludeC-45Types-u--foldr_Foldable_List (lambda (arg-2 arg-3 arg-4) (if (null? arg-4) arg-3 (let ((e-2 (car arg-4))) (let ((e-3 (cdr arg-4))) ((arg-2 e-2) (PreludeC-45Types-u--foldr_Foldable_List arg-2 arg-3 e-3)))))))
(define PreludeC-45Types-u--null_Foldable_List (lambda (arg-1) (if (null? arg-1) 1 0)))
(define FSC-45Scope-close (lambda (arg-2 arg-3 arg-4 arg-5) (let ((e-2 (vector-ref arg-2 0))) (let ((e-7 (car e-2))) (let ((e-10 (vector-ref e-7 3))) (((((e-10 'erased) 'erased) 'erased) (let ((e-16 (vector-ref arg-2 0))) (let ((e-17 (cdr e-16))) (((e-17 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (FSC-45Scope-findNode arg-3 arg-5 eta-0))) (vector 1 eff-0 'erased))))))) (lambda (_-0) (if (null? _-0) (let ((e-16 (vector-ref arg-2 0))) (let ((e-18 (car e-16))) (let ((e-23 (vector-ref e-18 1))) (((e-23 'erased) 'erased) 'erased)))) (let ((e-13 (unbox _-0))) (let ((e-17 (vector-ref arg-2 0))) (let ((e-19 (car e-17))) (let ((e-22 (vector-ref e-19 3))) (((((e-22 'erased) 'erased) 'erased) (let ((e-29 (vector-ref arg-2 0))) (let ((e-30 (cdr e-29))) (((e-30 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (FSC-45Scope-childNodes arg-3 '() e-13 eta-0))) (vector 1 eff-0 'erased))))))) (lambda (u--cs) (let ((e-29 (vector-ref arg-2 0))) (let ((e-31 (car e-29))) (let ((e-34 (vector-ref e-31 3))) (((((e-34 'erased) 'erased) 'erased) (let ((e-41 (vector-ref arg-2 0))) (let ((e-42 (cdr e-41))) (((e-42 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (DataC-45LinearC-45Ref1-casmod1 arg-3 (lambda (u--m) (FSC-45Scope-removeChild arg-4 (let ((e-46 (vector-ref e-13 0))) e-46) (PreludeC-45Types-u--foldl_Foldable_List (lambda (eta-1) (lambda (eta-2) (FSC-45Scope-deleteNode eta-1 eta-2))) u--m u--cs))) eta-0))) (vector 1 eff-0 'erased))))))) (lambda (_-10677) ((PreludeC-45Interfaces-traverse_ (vector (lambda (u--b) (lambda (u--a) (lambda (u--func) (lambda (arg-8912) (let ((e-41 (vector-ref arg-2 0))) (let ((e-43 (car e-41))) (let ((e-45 (vector-ref e-43 4))) (((((e-45 'erased) 'erased) 'erased) u--func) arg-8912)))))))) (lambda (u--a) (lambda (arg-9951) (let ((e-41 (vector-ref arg-2 0))) (let ((e-43 (car e-41))) (let ((e-48 (vector-ref e-43 1))) (((e-48 'erased) 'erased) arg-9951)))))) (lambda (u--b) (lambda (u--a) (lambda (arg-9957) (lambda (arg-9964) (let ((e-41 (vector-ref arg-2 0))) (let ((e-43 (car e-41))) (let ((e-44 (vector-ref e-43 5))) (((((e-44 'erased) 'erased) 'erased) arg-9957) arg-9964))))))))) (vector (lambda (u--acc) (lambda (u--elem) (lambda (u--func) (lambda (u--init) (lambda (u--input) (PreludeC-45Types-u--foldr_Foldable_List u--func u--init u--input)))))) (lambda (u--elem) (lambda (u--acc) (lambda (u--func) (lambda (u--init) (lambda (u--input) (PreludeC-45Types-u--foldl_Foldable_List u--func u--init u--input)))))) (lambda (u--elem) (lambda (arg-10939) (PreludeC-45Types-u--null_Foldable_List arg-10939))) (lambda (u--elem) (lambda (u--acc) (lambda (u--m) (lambda (i_con-0) (lambda (u--funcM) (lambda (u--init) (lambda (u--input) (PreludeC-45Types-u--foldlM_Foldable_List i_con-0 u--funcM u--init u--input)))))))) (lambda (u--elem) (lambda (arg-10968) arg-10968)) (lambda (u--a) (lambda (u--m) (lambda (i_con-0) (lambda (u--f) (lambda (arg-10982) (PreludeC-45Types-u--foldMap_Foldable_List i_con-0 u--f arg-10982))))))) (lambda (eta-0) (let ((e-39 (car eta-0))) e-39))) (PreludeC-45Types-listBind u--cs (lambda (eta-0) (let ((e-39 (vector-ref eta-0 1))) e-39)))))))))))))))))))))))
(define DataC-45LinearC-45Ref1-case--caseC-32blockC-32inC-32casupdate1C-44loop-1231 (lambda (arg-4 arg-5 arg-7 arg-8 arg-9) (let ((e-2 (car arg-9))) (let ((e-3 (cdr arg-9))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-5 arg-7 e-2))) (cond ((equal? eff-0 1) e-3)(else (DataC-45LinearC-45Ref1-n--3072-1198-u--loop arg-4 arg-5 'erased))))))))
(define DataC-45LinearC-45Ref1-case--casupdate1C-44loop-1206 (lambda (arg-4 arg-5 arg-7) (DataC-45LinearC-45Ref1-case--caseC-32blockC-32inC-32casupdate1C-44loop-1231 arg-4 arg-5 arg-7 'erased (arg-4 arg-7))))
(define DataC-45LinearC-45Ref1-n--3072-1198-u--loop (lambda (arg-4 arg-5 arg-6) (DataC-45LinearC-45Ref1-case--casupdate1C-44loop-1206 arg-4 arg-5 (unbox arg-5))))
(define DataC-45LinearC-45Ref1-casupdate1 (lambda (arg-3 arg-4 arg-5) (DataC-45LinearC-45Ref1-n--3072-1198-u--loop arg-4 arg-3 arg-5)))
(define FSC-45Scope-updCleanup (lambda (arg-0) (if (null? arg-0) (cons arg-0 0) (let ((e-2 (car arg-0))) (let ((e-3 (cdr arg-0))) (cond ((equal? e-2 0) (cons (cons 1 e-3) (or (and (= e-3 0) 1) 0)))(else (cons arg-0 0))))))))
(define PreludeC-45Interfaces-when (lambda (arg-1 arg-2 arg-3) (cond ((equal? arg-2 1) (arg-3)) (else (let ((e-2 (vector-ref arg-1 1))) ((e-2 'erased) 'erased))))))
(define FSC-45Scope-n--6040-4093-u--cl (lambda (arg-2 arg-3 arg-5) (let ((e-2 (car arg-2))) (let ((e-4 (vector-ref e-2 3))) (((((e-4 'erased) 'erased) 'erased) (let ((e-9 (cdr arg-2))) (((e-9 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (DataC-45LinearC-45Ref1-casupdate1 arg-5 (lambda (eta-1) (FSC-45Scope-updCleanup eta-1)) eta-0))) (vector 1 eff-0 'erased)))))) (lambda (bind-0) (PreludeC-45Interfaces-when (vector (lambda (u--b) (lambda (u--a) (lambda (u--func) (lambda (arg-8912) (let ((e-10 (car arg-2))) (let ((e-12 (vector-ref e-10 4))) (((((e-12 'erased) 'erased) 'erased) u--func) arg-8912))))))) (lambda (u--a) (lambda (arg-9951) (let ((e-10 (car arg-2))) (let ((e-15 (vector-ref e-10 1))) (((e-15 'erased) 'erased) arg-9951))))) (lambda (u--b) (lambda (u--a) (lambda (arg-9957) (lambda (arg-9964) (let ((e-10 (car arg-2))) (let ((e-11 (vector-ref e-10 5))) (((((e-11 'erased) 'erased) 'erased) arg-9957) arg-9964)))))))) bind-0 (lambda () arg-3))))))))
(define FSC-45Scope-updLease (lambda (arg-0) (let ((e-2 (car arg-0))) (let ((e-3 (cdr arg-0))) (cons (cons e-2 (+ e-3 1)) 'erased)))))
(define DataC-45Nat-pred (lambda (arg-0) (cond ((equal? arg-0 0) 0)(else (- arg-0 1)))))
(define FSC-45Scope-updUnlease (lambda (arg-0) (let ((e-2 (car arg-0))) (let ((e-3 (cdr arg-0))) (cond ((equal? e-3 0) (cons (cons e-2 (DataC-45Nat-pred e-3)) 0))(else (let ((e-4 (- e-3 1))) (cond ((equal? e-4 0) (cons (cons e-2 0) e-2))(else (cons (cons e-2 (DataC-45Nat-pred e-3)) 0))))))))))
(define FSC-45Scope-n--6040-4095-u--unlease (lambda (arg-2 arg-3 arg-5) (let ((e-2 (car arg-2))) (let ((e-4 (vector-ref e-2 3))) (((((e-4 'erased) 'erased) 'erased) (let ((e-9 (cdr arg-2))) (((e-9 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (DataC-45LinearC-45Ref1-casupdate1 arg-5 (lambda (eta-1) (FSC-45Scope-updUnlease eta-1)) eta-0))) (vector 1 eff-0 'erased)))))) (lambda (bind-0) (PreludeC-45Interfaces-when (vector (lambda (u--b) (lambda (u--a) (lambda (u--func) (lambda (arg-8912) (let ((e-10 (car arg-2))) (let ((e-12 (vector-ref e-10 4))) (((((e-12 'erased) 'erased) 'erased) u--func) arg-8912))))))) (lambda (u--a) (lambda (arg-9951) (let ((e-10 (car arg-2))) (let ((e-15 (vector-ref e-10 1))) (((e-15 'erased) 'erased) arg-9951))))) (lambda (u--b) (lambda (u--a) (lambda (arg-9957) (lambda (arg-9964) (let ((e-10 (car arg-2))) (let ((e-11 (vector-ref e-10 5))) (((((e-11 'erased) 'erased) 'erased) arg-9957) arg-9964)))))))) bind-0 (lambda () arg-3))))))))
(define FSC-45Scope-n--6040-4094-u--ls (lambda (arg-2 arg-3 arg-5) (let ((e-2 (car arg-2))) (let ((e-5 (vector-ref e-2 4))) (((((e-5 'erased) 'erased) 'erased) (lambda (eta-0) (FSC-45Scope-n--6040-4095-u--unlease arg-2 arg-3 arg-5))) (let ((e-9 (cdr arg-2))) (((e-9 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (DataC-45LinearC-45Ref1-casupdate1 arg-5 (lambda (eta-1) (FSC-45Scope-updLease eta-1)) eta-0))) (vector 1 eff-0 'erased))))))))))
(define FSC-45Scope-case--hook-4221 (lambda (arg-2 arg-3 arg-5) (cons (FSC-45Scope-n--6040-4093-u--cl arg-2 arg-3 arg-5) (FSC-45Scope-n--6040-4094-u--ls arg-2 arg-3 arg-5))))
(define FSC-45Scope-hook (lambda (arg-2 arg-3 arg-4) (FSC-45Scope-case--hook-4221 arg-2 arg-3 (box (cons 0 0)))))
(define FSC-45Core-interrupted (lambda (arg-2 arg-3 arg-9 arg-10) (if (null? arg-10) (let ((e-2 (vector-ref arg-2 0))) (let ((e-7 (car e-2))) (let ((e-12 (vector-ref e-7 1))) (((e-12 'erased) 'erased) (vector 2 ))))) (let ((e-12 (car arg-10))) (let ((e-13 (cdr arg-10))) (case (vector-ref e-12 0) ((3) (let ((e-4 (vector-ref e-12 1))) (let ((e-5 (vector-ref e-12 2))) (cond ((equal? e-5 1) (let ((e-2 (vector-ref arg-2 0))) (let ((e-9 (car e-2))) (let ((e-14 (vector-ref e-9 3))) (((((e-14 'erased) 'erased) 'erased) (FSC-45Scope-close arg-2 arg-3 1 (let ((e-22 (vector-ref arg-9 0))) e-22))) (lambda (_-10677) (FSC-45Core-interrupted arg-2 arg-3 e-4 e-13))))))) (else (FSC-45Core-interrupted arg-2 arg-3 e-4 e-13)))))) ((4) (let ((e-10 (vector-ref e-12 1))) (FSC-45Core-loop arg-2 arg-3 arg-9 (e-10) e-13))) ((0) (FSC-45Core-interrupted arg-2 arg-3 arg-9 e-13)) ((2) (FSC-45Core-interrupted arg-2 arg-3 arg-9 e-13)) (else (FSC-45Core-interrupted arg-2 arg-3 arg-9 e-13))))))))
(define FSC-45Scope-openSelfOrAncestor (lambda (arg-1 arg-2) (DataC-45Maybe-fromMaybe (lambda () (FSC-45Scope-openAncestor arg-1 arg-2)) (DataC-45SortedMap-lookup (let ((e-2 (vector-ref arg-2 0))) e-2) arg-1))))
(define PrimIO-unsafeCreateWorld (lambda (arg-1) (arg-1 #f)))
(define PrimIO-unsafePerformIO (lambda (arg-1) (PrimIO-unsafeCreateWorld (lambda (u--w) (arg-1 u--w)))))
(define DataC-45LinearC-45Unique-tok_ (PrimIO-unsafePerformIO (lambda (eta-0) (box 0))))
(define DataC-45LinearC-45Unique-case--token1-2237 (lambda (arg-2) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased DataC-45LinearC-45Unique-tok_ arg-2 (+ arg-2 1)))) (cond ((equal? eff-0 1) arg-2)(else (DataC-45LinearC-45Unique-token1 'erased))))))
(define DataC-45LinearC-45Unique-token1 (lambda (arg-1) (DataC-45LinearC-45Unique-case--token1-2237 (unbox DataC-45LinearC-45Unique-tok_))))
(define FSC-45Scope-scopeID (lambda (arg-1) (DataC-45LinearC-45Unique-token1 arg-1)))
(define DataC-45SortedSet-insert (lambda (arg-1 arg-2) (DataC-45SortedMap-insert arg-1 'erased arg-2)))
(define FSC-45Scope-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32openScope-6538 (lambda (arg-2 arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-12 arg-13 arg-14 arg-16 arg-17 arg-19) (DataC-45LinearC-45Ref1-casupdate1 arg-13 (lambda (u--ss) (let ((u--par (FSC-45Scope-openSelfOrAncestor u--ss arg-10))) (let ((u--ancs (cons arg-9 arg-7))) (let ((u--node (vector (vector arg-14 arg-8 u--ancs arg-16 arg-13 arg-2) arg-19 (force csegen-227)))) (let ((u--par2 (let ((e-1 (vector-ref u--par 0))) (let ((e-2 (vector-ref u--par 1))) (let ((e-3 (vector-ref u--par 2))) (vector e-1 e-2 (DataC-45SortedSet-insert arg-14 e-3))))))) (cons (FSC-45Scope-insertScope u--par2 (FSC-45Scope-insertScope u--node u--ss)) (let ((e-1 (vector-ref u--node 0))) e-1))))))) 'erased)))
(define FSC-45Scope-case--caseC-32blockC-32inC-32openScope-6477 (lambda (arg-2 arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-12 arg-13 arg-14 arg-16) (let ((e-6 (car arg-16))) (let ((e-7 (cdr arg-16))) (FSC-45Scope-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32openScope-6538 arg-2 arg-4 arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-12 arg-13 arg-14 e-6 e-7 (DataC-45LinearC-45Traverse1-traverse1List '() (lambda (eta-0) (lambda (eta-1) (FSC-45Scope-hook (let ((e-2 (vector-ref arg-2 0))) e-2) eta-0 eta-1))) e-7 'erased))))))
(define FSC-45Scope-openScope (lambda (arg-2 arg-3 arg-4 arg-5 arg-6) (let ((e-2 (vector-ref arg-5 0))) (let ((e-3 (vector-ref arg-5 1))) (let ((e-4 (vector-ref arg-5 2))) (let ((e-5 (vector-ref arg-5 3))) (let ((e-6 (vector-ref arg-5 4))) (let ((e-7 (vector-ref arg-5 5))) (let ((u--sc (vector e-2 e-3 e-4 e-5 e-6 e-7))) (let ((eff-0 (FSC-45Scope-scopeID arg-6))) (FSC-45Scope-case--caseC-32blockC-32inC-32openScope-6477 arg-2 e-6 e-7 e-5 e-4 e-3 e-2 u--sc arg-4 arg-3 eff-0 (let ((e-10 (vector-ref arg-2 1))) (((e-10 e-5) arg-4) 'erased)))))))))))))
(define FSC-45Core-traceOutput (lambda (arg-6 arg-7 arg-8 arg-9) (if (null? arg-9) (vector arg-6 arg-8 '()) (let ((e-12 (car arg-9))) (let ((e-13 (cdr arg-9))) (case (vector-ref e-12 0) ((0) (let ((e-5 (vector-ref e-12 1))) (FSC-45Core-traceOutput arg-6 arg-7 (vector 6 arg-8 e-5) e-13))) ((1) (FSC-45Core-traceOutput arg-6 arg-7 (vector 5 arg-8) e-13)) ((2) (vector arg-6 (vector 0 (vector 1 (cons arg-7 arg-8))) e-13)) ((3) (let ((e-20 (vector-ref e-12 1))) (let ((e-21 (vector-ref e-12 2))) (FSC-45Core-traceOutput e-20 arg-7 (vector 9 arg-6 e-21 arg-8) e-13)))) (else (let ((e-26 (vector-ref e-12 1))) (FSC-45Core-traceOutput arg-6 arg-7 (vector 10 arg-8 e-26) e-13)))))))))
(define FSC-45Core-view (lambda (arg-2 arg-3 arg-9 arg-10 arg-11 arg-12) (case (vector-ref arg-10 0) ((6) (let ((e-5 (vector-ref arg-10 1))) (let ((e-6 (vector-ref arg-10 2))) (case (vector-ref e-5 0) ((0) (let ((e-4 (vector-ref e-5 1))) (FSC-45Core-view arg-2 arg-3 arg-9 (e-6 e-4) arg-11 arg-12)))(else (FSC-45Core-view arg-2 arg-3 arg-9 e-5 (cons (vector 0 e-6) arg-11) arg-12)))))) ((0) (let ((e-11 (vector-ref arg-10 1))) (let ((u--p (vector 0 e-11))) (if (null? arg-11) (vector 0 arg-9 (vector 0 e-11)) (let ((e-9 (car arg-11))) (let ((e-10 (cdr arg-11))) (case (vector-ref e-9 0) ((0) (let ((e-5 (vector-ref e-9 1))) (FSC-45Core-view arg-2 arg-3 arg-9 (e-5 e-11) e-10 arg-12))) ((2) (FSC-45Core-view arg-2 arg-3 arg-9 (vector 0 (vector 0 e-11)) e-10 arg-12)) ((1) (FSC-45Core-view arg-2 arg-3 arg-9 (vector 0 (vector 1 e-11)) e-10 arg-12)) ((3) (let ((e-20 (vector-ref e-9 1))) (let ((e-21 (vector-ref e-9 2))) (cond ((equal? e-21 1) (vector 1 e-20 (vector 2 arg-9 (vector 1 e-11)) e-10)) (else (FSC-45Core-view arg-2 arg-3 e-20 u--p e-10 arg-12)))))) (else (FSC-45Core-view arg-2 arg-3 arg-9 u--p e-10 arg-12))))))))) ((1) (let ((e-16 (vector-ref arg-10 1))) (let ((u--p (vector 1 e-16))) (if (null? arg-11) (vector 0 arg-9 (vector 1 e-16)) (let ((e-9 (car arg-11))) (let ((e-10 (cdr arg-11))) (case (vector-ref e-9 0) ((0) (FSC-45Core-view arg-2 arg-3 arg-9 (vector 1 e-16) e-10 arg-12)) ((2) (FSC-45Core-view arg-2 arg-3 arg-9 (vector 1 e-16) e-10 arg-12)) ((1) (FSC-45Core-view arg-2 arg-3 arg-9 (vector 0 (vector 0 e-16)) e-10 arg-12)) ((3) (let ((e-20 (vector-ref e-9 1))) (let ((e-21 (vector-ref e-9 2))) (cond ((equal? e-21 1) (vector 1 e-20 (vector 2 arg-9 (vector 0 e-16)) e-10)) (else (FSC-45Core-view arg-2 arg-3 e-20 (vector 1 e-16) e-10 arg-12)))))) (else (FSC-45Core-view arg-2 arg-3 arg-9 u--p e-10 arg-12))))))))) ((2) (let ((e-21 (vector-ref arg-10 1))) (let ((e-22 (vector-ref arg-10 2))) (let ((sc1 (FSC-45Core-traceOutput arg-9 e-21 (e-22) arg-11))) (let ((e-6 (vector-ref sc1 0))) (let ((e-7 (vector-ref sc1 1))) (let ((e-8 (vector-ref sc1 2))) (FSC-45Core-view arg-2 arg-3 e-6 (vector 9 arg-9 0 e-7) e-8 arg-12)))))))) ((3) (let ((e-27 (vector-ref arg-10 1))) (vector 1 arg-9 e-27 arg-11))) ((4) (let ((e-33 (vector-ref arg-10 1))) (FSC-45Core-view arg-2 arg-3 arg-9 e-33 (cons (vector 2 ) arg-11) arg-12))) ((5) (let ((e-39 (vector-ref arg-10 1))) (FSC-45Core-view arg-2 arg-3 arg-9 e-39 (cons (vector 1 ) arg-11) arg-12))) ((7) (let ((e-44 (vector-ref arg-10 1))) (let ((e-45 (vector-ref arg-10 2))) (let ((eff-0 (FSC-45Scope-openScope arg-2 arg-3 e-44 arg-9 arg-12))) (FSC-45Core-view arg-2 arg-3 eff-0 e-45 (cons (vector 3 arg-9 1) arg-11) 'erased))))) ((9) (let ((e-50 (vector-ref arg-10 1))) (let ((e-51 (vector-ref arg-10 2))) (let ((e-52 (vector-ref arg-10 3))) (FSC-45Core-view arg-2 arg-3 e-50 e-52 (cons (vector 3 arg-9 e-51) arg-11) arg-12))))) ((8) (FSC-45Core-view arg-2 arg-3 arg-9 (vector 0 arg-9) arg-11 arg-12)) (else (let ((e-60 (vector-ref arg-10 1))) (let ((e-61 (vector-ref arg-10 2))) (FSC-45Core-view arg-2 arg-3 arg-9 e-60 (cons (vector 4 e-61) arg-11) arg-12)))))))
(define FSC-45Core-loop (lambda (arg-2 arg-3 arg-9 arg-10 arg-11) (let ((e-2 (vector-ref arg-2 0))) (let ((e-7 (car e-2))) (let ((e-10 (vector-ref e-7 3))) (((((e-10 'erased) 'erased) 'erased) (let ((e-14 (vector-ref arg-2 2))) (e-14 (let ((e-19 (vector-ref arg-9 3))) e-19)))) (lambda (_-0) (cond ((equal? _-0 0) (let ((e-16 (vector-ref arg-2 0))) (let ((e-18 (car e-16))) (let ((e-21 (vector-ref e-18 3))) (((((e-21 'erased) 'erased) 'erased) (let ((e-28 (vector-ref arg-2 0))) (let ((e-29 (cdr e-28))) (((e-29 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (FSC-45Core-view arg-2 arg-3 arg-9 arg-10 arg-11 eta-0))) (vector 1 eff-0 'erased))))))) (lambda (u--v) (case (vector-ref u--v 0) ((1) (let ((e-27 (vector-ref u--v 1))) (let ((e-26 (vector-ref u--v 2))) (let ((e-25 (vector-ref u--v 3))) (case (vector-ref e-26 0) ((0) (let ((e-28 (vector-ref e-26 1))) (let ((e-32 (vector-ref arg-2 0))) (let ((e-34 (car e-32))) (let ((e-37 (vector-ref e-34 3))) (((((e-37 'erased) 'erased) 'erased) (let ((e-41 (vector-ref arg-2 3))) ((((e-41 'erased) 'erased) (let ((e-47 (vector-ref arg-9 3))) e-47)) e-28))) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-41 (vector-ref lcase-0 1))) (FSC-45Core-loop arg-2 arg-3 e-27 (vector 0 e-41) e-25))) ((1) (let ((e-41 (vector-ref lcase-0 1))) (FSC-45Core-loop arg-2 arg-3 e-27 (vector 1 e-41) e-25))) (else (FSC-45Core-interrupted arg-2 arg-3 e-27 e-25)))))))))) ((1) (let ((e-29 (vector-ref e-26 1))) (let ((e-28 (vector-ref e-26 2))) (let ((e-33 (vector-ref arg-2 0))) (let ((e-35 (car e-33))) (let ((e-38 (vector-ref e-35 3))) (((((e-38 'erased) 'erased) 'erased) (let ((e-42 (vector-ref arg-2 3))) ((((e-42 'erased) 'erased) (let ((e-48 (vector-ref arg-9 3))) e-48)) e-29))) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-42 (vector-ref lcase-0 1))) (let ((e-46 (vector-ref arg-2 0))) (let ((e-48 (car e-46))) (let ((e-51 (vector-ref e-48 3))) (((((e-51 'erased) 'erased) 'erased) (let ((e-60 (vector-ref e-27 0))) (let ((e-59 (vector-ref e-27 1))) (let ((e-58 (vector-ref e-27 2))) (let ((e-57 (vector-ref e-27 3))) (let ((e-56 (vector-ref e-27 4))) (let ((e-55 (vector-ref e-27 5))) (let ((e-64 (vector-ref e-55 0))) (let ((e-66 (car e-64))) (let ((e-69 (vector-ref e-66 3))) (((((e-69 'erased) 'erased) 'erased) (let ((e-76 (vector-ref e-55 0))) (let ((e-77 (cdr e-76))) (((e-77 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (FSC-45Scope-hook (let ((e-82 (vector-ref e-55 0))) e-82) (e-28 e-42) eta-0))) (vector 1 eff-0 'erased))))))) (lambda (u--hk) (let ((e-76 (vector-ref e-55 0))) (let ((e-77 (cdr e-76))) (((e-77 'erased) 'erased) (lambda (eta-0) (let ((eff-0 (DataC-45LinearC-45Ref1-casmod1 (let ((e-80 (vector-ref e-27 4))) e-80) (lambda (u--ss) (let ((u--res (let ((u--sc (vector e-60 e-59 e-58 e-57 e-56 e-55))) (let ((sc10 (FSC-45Scope-openSelfOrAncestor u--ss u--sc))) (let ((e-81 (vector-ref sc10 0))) (let ((e-80 (vector-ref sc10 1))) (let ((e-79 (vector-ref sc10 2))) (vector e-81 (cons u--hk e-80) e-79)))))))) (FSC-45Scope-insertScope u--res u--ss))) eta-0))) (vector 1 eff-0 'erased)))))))))))))))))) (lambda (_-10677) (FSC-45Core-loop arg-2 arg-3 e-27 (vector 0 e-42) e-25)))))))) ((1) (let ((e-42 (vector-ref lcase-0 1))) (FSC-45Core-loop arg-2 arg-3 e-27 (vector 1 e-42) e-25))) (else (FSC-45Core-interrupted arg-2 arg-3 e-27 e-25))))))))))) (else (let ((e-29 (vector-ref e-26 1))) (let ((e-28 (vector-ref e-26 2))) (let ((e-33 (vector-ref arg-2 0))) (let ((e-35 (car e-33))) (let ((e-38 (vector-ref e-35 3))) (((((e-38 'erased) 'erased) 'erased) (FSC-45Scope-close arg-2 arg-3 1 (let ((e-47 (vector-ref e-29 0))) e-47))) (lambda (_-10677) ((case (vector-ref e-28 0) ((1) (let ((e-42 (vector-ref e-28 1))) (lambda () (FSC-45Core-loop arg-2 arg-3 e-27 (vector 0 e-42) e-25)))) (else (let ((e-42 (vector-ref e-28 1))) (lambda () (FSC-45Core-loop arg-2 arg-3 e-27 (vector 1 e-42) e-25))))))))))))))))))) (else (let ((e-25 (vector-ref u--v 2))) (let ((e-30 (vector-ref arg-2 0))) (let ((e-32 (car e-30))) (let ((e-37 (vector-ref e-32 1))) (((e-37 'erased) 'erased) e-25))))))))))))) (else (FSC-45Core-interrupted arg-2 arg-3 arg-9 arg-11))))))))))
(define FSC-45Scope-case--root-6318 (lambda (arg-2 arg-4 arg-5) (let ((u--r (vector (vector arg-5 arg-5 '() '() arg-4 arg-2) '() (force csegen-227)))) (let ((eff-0 (let ((eff-0 (unbox arg-4))) (set-box! arg-4 (FSC-45Scope-insertScope u--r eff-0))))) (let ((e-1 (vector-ref u--r 0))) e-1)))))
(define FSC-45Scope-root (lambda (arg-2 arg-3 arg-4) (FSC-45Scope-case--root-6318 arg-2 arg-3 (FSC-45Scope-scopeID arg-4))))
(define FSC-45Core-pull (lambda (arg-2 arg-3 arg-6) (ControlC-45MonadC-45MCancel-bracketFull arg-2 (lambda (eta-0) (let ((e-2 (vector-ref arg-3 0))) (let ((e-7 (car e-2))) (let ((e-10 (vector-ref e-7 3))) (((((e-10 'erased) 'erased) 'erased) (let ((e-16 (vector-ref arg-3 0))) (let ((e-17 (cdr e-16))) (((e-17 'erased) 'erased) (lambda (eta-1) (let ((eff-0 (box csegen-172))) (vector 1 eff-0 'erased))))))) (lambda (u--ref) (let ((e-16 (vector-ref arg-3 0))) (let ((e-18 (car e-16))) (let ((e-21 (vector-ref e-18 3))) (((((e-21 'erased) 'erased) 'erased) (let ((e-28 (vector-ref arg-3 0))) (let ((e-29 (cdr e-28))) (((e-29 'erased) 'erased) (lambda (eta-1) (let ((eff-0 (FSC-45Scope-root arg-3 u--ref eta-1))) (vector 1 eff-0 'erased))))))) (lambda (u--sc) (let ((e-28 (vector-ref arg-3 0))) (let ((e-30 (car e-28))) (let ((e-35 (vector-ref e-30 1))) (((e-35 'erased) 'erased) u--sc))))))))))))))) (lambda (lamc-0) (let ((e-2 (vector-ref lamc-0 0))) (let ((e-3 (vector-ref lamc-0 1))) (let ((e-4 (vector-ref lamc-0 2))) (let ((e-5 (vector-ref lamc-0 3))) (let ((e-6 (vector-ref lamc-0 4))) (let ((e-7 (vector-ref lamc-0 5))) (FSC-45Core-loop e-7 e-6 (vector e-2 e-3 e-4 e-5 e-6 e-7) arg-6 '())))))))) (lambda (eta-0) (lambda (eta-1) (let ((e-2 (vector-ref eta-0 0))) (let ((e-6 (vector-ref eta-0 4))) (let ((e-7 (vector-ref eta-0 5))) (FSC-45Scope-close e-7 e-6 0 e-2)))))))))
(define FSC-45Core-mpull (lambda (arg-2 arg-3 arg-5 arg-6) (let ((e-1 (vector-ref arg-2 0))) (let ((e-7 (vector-ref e-1 3))) (((((e-7 'erased) 'erased) 'erased) (FSC-45Core-pull arg-2 arg-3 arg-6)) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-11 (vector-ref lcase-0 1))) (let ((e-15 (vector-ref arg-2 0))) (let ((e-20 (vector-ref e-15 1))) (((e-20 'erased) 'erased) e-11))))) (else (let ((e-14 (vector-ref arg-2 0))) (let ((e-19 (vector-ref e-14 1))) (((e-19 'erased) 'erased) (let ((e-21 (cdr arg-5))) e-21))))))))))))
(define IOC-45AsyncC-45LoopC-45Posix-POLL_ITER 16)
(define PreludeC-45EqOrd-u--C-60_Ord_Int32 (lambda (arg-0 arg-1) (let ((sc0 (or (and (< arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define SystemC-45PosixC-45FileC-45Prim-case--getFlags-7314 (lambda (arg-1 arg-2 arg-4 arg-6) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Int32 arg-6 0))) (cond ((equal? sc0 1) (vector 0 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-4 (blodwen-toUnsignedInt (bs- 0 arg-6 31) 32)) 'erased)) (else (vector 1 (blodwen-toUnsignedInt arg-6 32) 'erased))))))
(define SystemC-45PosixC-45FileC-45Prim-getFlags (lambda (arg-1 arg-2 arg-4 arg-5) (SystemC-45PosixC-45FileC-45Prim-case--getFlags-7314 arg-1 arg-2 arg-4 (SystemC-45PosixC-45FileC-45Prim-prim__getFlags (arg-1 arg-2) arg-5))))
(define SystemC-45PosixC-45Errno-case--toUnit-4051 (lambda (arg-1 arg-3 arg-4) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Int32 arg-4 0))) (cond ((equal? sc0 1) (vector 0 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-1 (blodwen-toUnsignedInt (bs- 0 arg-4 31) 32)) 'erased)) (else (vector 1 'erased 'erased))))))
(define SystemC-45PosixC-45FileC-45Prim-addFlags (lambda (arg-1 arg-2 arg-3 arg-5 arg-6) (let ((sc0 (SystemC-45PosixC-45FileC-45Prim-getFlags arg-1 arg-2 arg-5 arg-6))) (case (vector-ref sc0 0) ((1) (let ((e-3 (vector-ref sc0 1))) (let ((e-4 (vector-ref sc0 2))) ((let ((eff-0 (blodwen-or e-3 arg-3))) (lambda (eta-0) (SystemC-45PosixC-45Errno-case--toUnit-4051 arg-5 (lambda (eta-1) (SystemC-45PosixC-45FileC-45Prim-prim__setFlags (arg-1 arg-2) eff-0 eta-1)) (SystemC-45PosixC-45FileC-45Prim-prim__setFlags (arg-1 arg-2) eff-0 eta-0)))) e-4)))) (else (let ((e-8 (vector-ref sc0 1))) (let ((e-9 (vector-ref sc0 2))) (vector 0 e-8 e-9))))))))
(define System-u--cast_Cast_ExitCode_Int (lambda (arg-0) (if (null? arg-0) 0 (let ((e-0 (car arg-0))) e-0))))
(define System-exitWith (lambda (arg-2 ext-0) (let ((e-2 (cdr arg-2))) ((e-2 'erased) (lambda (eta-1) (System-prim__exit (System-u--cast_Cast_ExitCode_Int ext-0) eta-1))))))
(define System-exitFailure (lambda (arg-2) (System-exitWith arg-2 (cons 1 'erased))))
(define SystemC-45FileC-45Support-ok (lambda (arg-3 arg-4) (let ((e-1 (car arg-3))) (let ((e-5 (vector-ref e-1 0))) (let ((e-7 (vector-ref e-5 1))) ((e-7 'erased) (vector 1 arg-4)))))))
(define SystemC-45FileC-45Error-returnError (lambda (arg-2) (let ((e-1 (car arg-2))) (let ((e-4 (vector-ref e-1 1))) ((((e-4 'erased) 'erased) (let ((e-6 (cdr arg-2))) ((e-6 'erased) (lambda (eta-0) (SystemC-45FileC-45Error-prim__fileErrno eta-0))))) (lambda (u--err) (let ((e-7 (car arg-2))) (let ((e-10 (vector-ref e-7 0))) (let ((e-12 (vector-ref e-10 1))) ((e-12 'erased) (vector 0 (cond ((equal? u--err 0) (vector 1 )) ((equal? u--err 1) (vector 2 )) ((equal? u--err 2) (vector 3 )) ((equal? u--err 3) (vector 4 )) ((equal? u--err 4) (vector 5 ))(else (vector 0 (bs- u--err 5 63)))))))))))))))
(define PreludeC-45EqOrd-u--C-61C-61_Eq_Int (lambda (arg-0 arg-1) (let ((sc0 (or (and (= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define SystemC-45FileC-45ReadWrite-fPutStr (lambda (arg-1 arg-2 arg-3) (let ((e-1 (car arg-1))) (let ((e-4 (vector-ref e-1 1))) ((((e-4 'erased) 'erased) (let ((e-6 (cdr arg-1))) ((e-6 'erased) (lambda (eta-0) (SystemC-45FileC-45ReadWrite-prim__writeLine arg-2 arg-3 eta-0))))) (lambda (u--res) (let ((sc1 (PreludeC-45EqOrd-u--C-61C-61_Eq_Int u--res (blodwen-toSignedInt 0 63)))) (cond ((equal? sc1 1) (SystemC-45FileC-45Error-returnError arg-1)) (else (SystemC-45FileC-45Support-ok arg-1 'erased))))))))))
(define SystemC-45FileC-45ReadWrite-fPutStrLn (lambda (arg-1 arg-2 arg-3) (SystemC-45FileC-45ReadWrite-fPutStr arg-1 arg-2 (string-append arg-3 "\xa;"))))
(define SystemC-45FileC-45Virtual-stderr (SystemC-45FileC-45Virtual-prim__stderr))
(define System-die (lambda (arg-2 arg-3) (let ((e-1 (car arg-2))) (let ((e-4 (vector-ref e-1 1))) ((((e-4 'erased) 'erased) (let ((e-7 (car arg-2))) (let ((e-10 (vector-ref e-7 0))) (let ((e-13 (vector-ref e-10 0))) ((((e-13 'erased) 'erased) (lambda (eta-0) 'erased)) (SystemC-45FileC-45ReadWrite-fPutStrLn arg-2 SystemC-45FileC-45Virtual-stderr arg-3)))))) (lambda (_-10677) (System-exitFailure arg-2)))))))
(define IOC-45AsyncC-45LoopC-45Poller-case--dieOnErr-13230 (lambda (arg-2 arg-3) (case (vector-ref arg-3 0) ((1) (let ((e-3 (vector-ref arg-3 1))) e-3)) (else (let ((e-8 (vector-ref arg-3 1))) (let ((e-9 (vector-ref arg-3 2))) (let ((e-14 (vector-ref e-8 1))) ((System-die csegen-77 (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons "Error: " (cons (SystemC-45PosixC-45ErrnoC-45Type-errorText e-14) (cons " (" (cons (SystemC-45PosixC-45ErrnoC-45Type-errorName e-14) (cons ")" '()))))))) e-9))))))))
(define IOC-45AsyncC-45LoopC-45Poller-dieOnErr (lambda (arg-1 arg-2) (IOC-45AsyncC-45LoopC-45Poller-case--dieOnErr-13230 arg-1 (arg-1 arg-2))))
(define DataC-45Vect-head (lambda (arg-2) (let ((e-2 (car arg-2))) e-2)))
(define DataC-45SortedMapC-45Dependent-null (lambda (arg-2) (case (vector-ref arg-2 0) ((0) 1) (else 0))))
(define DataC-45SortedMap-u--null_Foldable_C-40SortedMapC-32C-36kC-41 (lambda (ext-0) (DataC-45SortedMapC-45Dependent-null ext-0)))
(define PreludeC-45TypesC-45List-filterAppend (lambda (arg-1 arg-2 arg-3) (if (null? arg-3) (PreludeC-45TypesC-45SnocList-C-60C-62C-62 arg-1 '()) (let ((e-1 (car arg-3))) (let ((e-2 (cdr arg-3))) (let ((sc1 (arg-2 e-1))) (cond ((equal? sc1 1) (PreludeC-45TypesC-45List-filterAppend (cons arg-1 e-1) arg-2 e-2)) (else (PreludeC-45TypesC-45List-filterAppend arg-1 arg-2 e-2)))))))))
(define SystemC-45PosixC-45SignalC-45Struct-siginfo (lambda (arg-1 arg-2) (let ((eff-0 (SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_signo arg-1 arg-2))) (let ((eff-1 (SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_code arg-1 'erased))) (let ((eff-2 (SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_pid arg-1 'erased))) (let ((eff-3 (SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_uid arg-1 'erased))) (let ((eff-4 (SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_status arg-1 'erased))) (let ((eff-5 (SystemC-45PosixC-45SignalC-45Struct-get_siginfo_t_si_value arg-1 'erased))) (vector eff-0 eff-1 eff-2 eff-3 eff-4 eff-5)))))))))
(define DataC-45LinearC-45Traverse1-traverse1_List (lambda (arg-2 arg-3 arg-4) (if (null? arg-3) 'erased (let ((e-2 (car arg-3))) (let ((e-3 (cdr arg-3))) (let ((eff-0 ((arg-2 e-2) arg-4))) (DataC-45LinearC-45Traverse1-traverse1_List arg-2 e-3 'erased)))))))
(define SystemC-45PosixC-45SignalC-45Struct-case--withSignals-13175 (lambda (arg-2 arg-4 arg-5 arg-6) (let ((eff-0 (DataC-45LinearC-45Traverse1-traverse1_List (lambda (u--s) (lambda (eta-0) (SystemC-45PosixC-45SignalC-45Struct-prim__sigaddset arg-6 u--s eta-0))) arg-5 'erased))) (let ((sc0 ((((arg-4 arg-6) 'erased) arg-2) 'erased))) (case (vector-ref sc0 0) ((1) (let ((e-3 (vector-ref sc0 1))) (let ((e-4 (vector-ref sc0 2))) (let ((eff-1 (DataC-45CC-45Struct-prim__free arg-6 e-4))) (vector 1 e-3 'erased))))) (else (let ((e-8 (vector-ref sc0 1))) (let ((e-9 (vector-ref sc0 2))) (let ((eff-1 (DataC-45CC-45Struct-prim__free arg-6 e-9))) (vector 0 e-8 'erased))))))))))
(define SystemC-45PosixC-45SignalC-45Struct-withSignals (lambda (arg-1 arg-2 arg-4 arg-5) (SystemC-45PosixC-45SignalC-45Struct-case--withSignals-13175 arg-4 arg-2 arg-1 (SystemC-45PosixC-45SignalC-45Struct-prim__emptysigset arg-5))))
(define SystemC-45PosixC-45Errno-case--withStruct-4836 (lambda (arg-2 arg-3 arg-5 arg-7 arg-8) (let ((sc0 ((((arg-7 arg-8) 'erased) arg-5) 'erased))) (case (vector-ref sc0 0) ((1) (let ((e-3 (vector-ref sc0 1))) (let ((e-4 (vector-ref sc0 2))) (let ((eff-0 (DataC-45CC-45Struct-prim__free (let ((e-2 (cdr arg-2))) ((e-2 'erased) arg-8)) e-4))) (vector 1 e-3 'erased))))) (else (let ((e-8 (vector-ref sc0 1))) (let ((e-9 (vector-ref sc0 2))) (let ((eff-0 (DataC-45CC-45Struct-prim__free (let ((e-2 (cdr arg-2))) ((e-2 'erased) arg-8)) e-9))) (vector 0 e-8 'erased)))))))))
(define SystemC-45PosixC-45SignalC-45Prim-sigwaitinfo (lambda (arg-0 arg-2 ext-0) (SystemC-45PosixC-45SignalC-45Struct-withSignals arg-0 (lambda (u--set) (lambda (es-13433) (lambda (conArg-13434) (lambda (eta-0) (SystemC-45PosixC-45Errno-case--withStruct-4836 (cons (lambda (u--s) (lambda (arg-971) arg-971)) (lambda (u--s) (lambda (arg-977) arg-977))) 128 conArg-13434 (lambda (u--si) (lambda (es-13450) (lambda (conArg-13451) (lambda (u--t) (let ((sc0 (SystemC-45PosixC-45Errno-case--toUnit-4051 conArg-13451 (lambda (eta-1) (SystemC-45PosixC-45SignalC-45Prim-prim__sigwaitinfo u--set u--si eta-1)) (SystemC-45PosixC-45SignalC-45Prim-prim__sigwaitinfo u--set u--si u--t)))) (case (vector-ref sc0 0) ((1) (let ((e-4 (vector-ref sc0 2))) (let ((eff-0 (SystemC-45PosixC-45SignalC-45Struct-siginfo u--si e-4))) (vector 1 eff-0 'erased)))) (else (let ((e-8 (vector-ref sc0 1))) (let ((e-9 (vector-ref sc0 2))) (vector 0 e-8 e-9)))))))))) (DataC-45CC-45Struct-prim__malloc 128)))))) arg-2 ext-0)))
(define Builtin-snd (lambda (arg-2) (let ((e-3 (cdr arg-2))) e-3)))
(define IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32checkSignals-1553 (lambda (arg-0 arg-2 arg-4 arg-6 arg-7 arg-8 arg-9) (if (null? arg-9) 'erased (let ((e-2 (unbox arg-9))) (let ((eff-0 (set-box! arg-0 (let ((e-0 (car arg-2))) (let ((e-1 (cdr arg-2))) (cons e-0 (DataC-45SortedMap-delete (let ((e-8 (vector-ref arg-7 0))) e-8) e-1))))))) (DataC-45LinearC-45Traverse1-traverse1_List (lambda (u--h) ((Builtin-snd u--h) arg-7)) e-2 'erased))))))
(define IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32checkSignals-1501 (lambda (arg-0 arg-2 arg-4 arg-6 arg-7) (case (vector-ref arg-7 0) ((0) 'erased) (else (let ((e-8 (vector-ref arg-7 1))) (let ((e-9 (vector-ref arg-7 2))) (IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32checkSignals-1553 arg-0 arg-2 arg-4 arg-6 e-8 e-9 (DataC-45SortedMap-lookup (let ((e-0 (vector-ref e-8 0))) e-0) (let ((e-1 (cdr arg-2))) e-1)))))))))
(define IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32checkSignals-1454 (lambda (arg-0 arg-2 arg-4 arg-5 arg-6) (if (null? arg-6) 'erased (IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32checkSignals-1501 arg-0 arg-2 arg-4 arg-6 (SystemC-45PosixC-45SignalC-45Prim-sigwaitinfo arg-6 0 arg-5)))))
(define IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32checkSignals-1417 (lambda (arg-0 arg-2 arg-4) (if (null? arg-4) 'erased (IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32checkSignals-1454 arg-0 arg-2 arg-4 'erased (PreludeC-45TypesC-45List-filterAppend '() (lambda (eta-0) (let ((sc1 (DataC-45SortedMap-lookup eta-0 (let ((e-1 (cdr arg-2))) e-1)))) (if (null? sc1) 0 (let ((e-1 (unbox sc1))) (if (null? e-1) 0 1))))) arg-4)))))
(define SystemC-45PosixC-45Errno-filterM (lambda (arg-2 arg-3 arg-4 arg-5) (if (null? arg-4) (PreludeC-45TypesC-45SnocList-C-60C-62C-62 arg-2 '()) (let ((e-2 (car arg-4))) (let ((e-3 (cdr arg-4))) (let ((eff-0 ((arg-3 e-2) arg-5))) (cond ((equal? eff-0 1) (SystemC-45PosixC-45Errno-filterM (cons arg-2 e-2) arg-3 e-3 'erased))(else (SystemC-45PosixC-45Errno-filterM arg-2 arg-3 e-3 'erased)))))))))
(define PreludeC-45Types-countFrom (lambda (arg-1 arg-2) (cons arg-1 (lambda () (PreludeC-45Types-countFrom (arg-2 arg-1) arg-2)))))
(define PreludeC-45Types-takeUntil (lambda (arg-1 arg-2) (let ((e-1 (car arg-2))) (let ((e-2 (cdr arg-2))) (let ((sc1 (arg-1 e-1))) (cond ((equal? sc1 1) (cons e-1 '())) (else (cons e-1 (PreludeC-45Types-takeUntil arg-1 (e-2))))))))))
(define PreludeC-45Types-u--pure_Applicative_List (lambda (arg-1) (cons arg-1 '())))
(define PreludeC-45Types-u--rangeFromTo_Range_C-36a (lambda (arg-1 arg-2 arg-3) (let ((sc0 (let ((sc1 (Builtin-fst (Builtin-snd arg-1)))) (let ((e-2 (vector-ref sc1 1))) ((e-2 arg-2) arg-3))))) (cond ((equal? sc0 0) (PreludeC-45Types-takeUntil (lambda (arg-0) (let ((sc1 (Builtin-fst (Builtin-snd arg-1)))) (let ((e-6 (vector-ref sc1 5))) ((e-6 arg-0) arg-3)))) (PreludeC-45Types-countFrom arg-2 (lambda (arg-0) (let ((sc1 (Builtin-snd (Builtin-snd arg-1)))) (let ((e-1 (vector-ref sc1 0))) (let ((e-6 (vector-ref e-1 0))) ((e-6 arg-0) (let ((sc1 (Builtin-snd (Builtin-snd arg-1)))) (let ((e-9 (vector-ref sc1 0))) (let ((e-10 (vector-ref e-9 2))) (e-10 1)))))))))))) ((equal? sc0 1) (PreludeC-45Types-u--pure_Applicative_List arg-2)) (else (PreludeC-45Types-takeUntil (lambda (arg-0) (let ((sc1 (Builtin-fst (Builtin-snd arg-1)))) (let ((e-5 (vector-ref sc1 4))) ((e-5 arg-0) arg-3)))) (PreludeC-45Types-countFrom arg-2 (lambda (u--x) (let ((sc1 (Builtin-snd (Builtin-snd arg-1)))) (let ((e-3 (vector-ref sc1 2))) ((e-3 u--x) (let ((sc1 (Builtin-snd (Builtin-snd arg-1)))) (let ((e-6 (vector-ref sc1 0))) (let ((e-7 (vector-ref e-6 2))) (e-7 1)))))))))))))))
(define SystemC-45PosixC-45SignalC-45Struct-signals (PreludeC-45TypesC-45List-mapAppend '() (lambda (eta-0) eta-0) (let ((sc0 (let ((sc1 csegen-191)) (let ((e-4 (vector-ref sc1 3))) ((e-4 64) 31))))) (cond ((equal? sc0 1) (PreludeC-45Types-u--rangeFromTo_Range_C-36a csegen-213 1 64)) (else (PreludeC-45Types-u--rangeFromTo_Range_C-36a csegen-213 1 31))))))
(define SystemC-45PosixC-45SignalC-45Prim-case--sigpending-13333 (lambda (arg-1) (let ((eff-0 (SystemC-45PosixC-45Errno-filterM '() (lambda (eta-0) (lambda (eta-1) (let ((eff-0 (SystemC-45PosixC-45SignalC-45Struct-prim__sigismember arg-1 eta-0 eta-1))) (cond ((equal? eff-0 0) 0)(else 1))))) SystemC-45PosixC-45SignalC-45Struct-signals 'erased))) (let ((eff-1 (DataC-45CC-45Struct-prim__free arg-1 'erased))) eff-0))))
(define IOC-45AsyncC-45LoopC-45SignalST-case--checkSignals-1368 (lambda (arg-0 arg-2) (let ((sc0 (DataC-45SortedMap-u--null_Foldable_C-40SortedMapC-32C-36kC-41 (let ((e-1 (cdr arg-2))) e-1)))) (cond ((equal? sc0 1) 'erased) (else (IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32checkSignals-1417 arg-0 arg-2 (SystemC-45PosixC-45SignalC-45Prim-case--sigpending-13333 (SystemC-45PosixC-45SignalC-45Prim-prim__sigpending 'erased))))))))
(define IOC-45AsyncC-45LoopC-45SignalST-checkSignals (lambda (arg-0 arg-1) (IOC-45AsyncC-45LoopC-45SignalST-case--checkSignals-1368 arg-0 (unbox arg-0))))
(define IOC-45AsyncC-45LoopC-45Queue-case--caseC-32blockC-32inC-32deqC-44go-3222 (lambda (arg-2 arg-3 arg-4 arg-5 arg-6 arg-7 arg-8) (if (null? arg-8) '() (let ((e-1 (car arg-8))) (let ((e-2 (cdr arg-8))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-6 (vector 0 e-2 '())))) (cond ((equal? eff-0 1) (box e-1))(else (IOC-45AsyncC-45LoopC-45Queue-deq arg-2 'erased)))))))))
(define IOC-45AsyncC-45LoopC-45Queue-n--4248-3096-u--go (lambda (arg-2 arg-3 arg-4 arg-5) (let ((e-1 (vector-ref arg-4 0))) (let ((e-2 (vector-ref arg-4 1))) (let ((e-3 (vector-ref arg-4 2))) (if (null? e-2) (let ((u--h '())) (IOC-45AsyncC-45LoopC-45Queue-case--caseC-32blockC-32inC-32deqC-44go-3222 arg-2 e-3 e-1 arg-5 arg-3 u--h (PreludeC-45TypesC-45SnocList-C-60C-62C-62 e-3 '()))) (let ((e-5 (car e-2))) (let ((e-4 (cdr e-2))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-3 (vector 0 e-4 e-3)))) (cond ((equal? eff-0 1) (box e-5))(else (IOC-45AsyncC-45LoopC-45Queue-deq arg-2 'erased))))))))))))
(define IOC-45AsyncC-45LoopC-45Queue-case--deq-3342 (lambda (arg-2 arg-3) (IOC-45AsyncC-45LoopC-45Queue-n--4248-3096-u--go arg-2 arg-3 arg-3 'erased)))
(define IOC-45AsyncC-45LoopC-45Queue-deq (lambda (arg-1 arg-2) (IOC-45AsyncC-45LoopC-45Queue-case--deq-3342 arg-1 (unbox arg-1))))
(define SystemC-45Clock-isClockMandatory (lambda (arg-0) (cond ((equal? arg-0 5) 1) ((equal? arg-0 6) 1)(else 0))))
(define SystemC-45Clock-clockTimeGcCpu (lambda (ext-0) (SystemC-45Clock-prim__clockTimeGcCpu ext-0)))
(define SystemC-45Clock-clockTimeGcReal (lambda (ext-0) (SystemC-45Clock-prim__clockTimeGcReal ext-0)))
(define SystemC-45Clock-clockTimeMonotonic (lambda (ext-0) (SystemC-45Clock-prim__clockTimeMonotonic ext-0)))
(define SystemC-45Clock-clockTimeProcess (lambda (ext-0) (SystemC-45Clock-prim__clockTimeProcess ext-0)))
(define SystemC-45Clock-clockTimeThread (lambda (ext-0) (SystemC-45Clock-prim__clockTimeThread ext-0)))
(define SystemC-45Clock-clockTimeUtc (lambda (ext-0) (SystemC-45Clock-prim__clockTimeUtc ext-0)))
(define SystemC-45Clock-fetchOSClock (lambda (arg-0 ext-0) (cond ((equal? arg-0 0) (SystemC-45Clock-clockTimeUtc ext-0)) ((equal? arg-0 1) (SystemC-45Clock-clockTimeMonotonic ext-0)) ((equal? arg-0 3) (SystemC-45Clock-clockTimeProcess ext-0)) ((equal? arg-0 4) (SystemC-45Clock-clockTimeThread ext-0)) ((equal? arg-0 5) (SystemC-45Clock-clockTimeGcCpu ext-0)) ((equal? arg-0 6) (SystemC-45Clock-clockTimeGcReal ext-0)) (else (SystemC-45Clock-clockTimeMonotonic ext-0)))))
(define SystemC-45Clock-osClockNanosecond (lambda (arg-0 ext-0) (SystemC-45Clock-prim__osClockNanosecond arg-0 ext-0)))
(define SystemC-45Clock-osClockSecond (lambda (arg-0 ext-0) (SystemC-45Clock-prim__osClockSecond arg-0 ext-0)))
(define SystemC-45Clock-fromOSClock (lambda (arg-0 arg-1 ext-0) (let ((act-1 (SystemC-45Clock-osClockSecond arg-1 ext-0))) (let ((act-2 (SystemC-45Clock-osClockNanosecond arg-1 ext-0))) (vector arg-0 act-1 act-2)))))
(define SystemC-45Clock-osClockValid (lambda (arg-0 ext-0) (SystemC-45Clock-prim__osClockValid arg-0 ext-0)))
(define SystemC-45Clock-with--clockTime-4458 (lambda (arg-0 arg-1 ext-0) (cond ((equal? arg-1 0) (let ((act-1 (SystemC-45Clock-fetchOSClock arg-0 ext-0))) (SystemC-45Clock-fromOSClock arg-0 act-1 ext-0))) (else (let ((act-1 (SystemC-45Clock-fetchOSClock arg-0 ext-0))) (let ((act-2 (PreludeC-45IO-u--map_Functor_IO (lambda (arg-2) (PreludeC-45EqOrd-u--C-61C-61_Eq_Int arg-2 (blodwen-toSignedInt 1 63))) (lambda (eta-0) (SystemC-45Clock-osClockValid act-1 eta-0)) ext-0))) (cond ((equal? act-2 1) (PreludeC-45IO-u--map_Functor_IO (lambda (eta-0) (box eta-0)) (lambda (eta-0) (SystemC-45Clock-fromOSClock arg-0 act-1 eta-0)) ext-0)) (else '()))))))))
(define SystemC-45Clock-clockTime (lambda (arg-0 ext-0) (SystemC-45Clock-with--clockTime-4458 arg-0 (SystemC-45Clock-isClockMandatory arg-0) ext-0)))
(define DataC-45SortedMapC-45Dependent-treeLeftMost (lambda (arg-4) (case (vector-ref arg-4 0) ((0) (let ((e-3 (vector-ref arg-4 1))) (let ((e-4 (vector-ref arg-4 2))) (cons e-3 e-4)))) ((1) (let ((e-9 (vector-ref arg-4 1))) (DataC-45SortedMapC-45Dependent-treeLeftMost e-9))) (else (let ((e-16 (vector-ref arg-4 1))) (DataC-45SortedMapC-45Dependent-treeLeftMost e-16))))))
(define DataC-45SortedMapC-45Dependent-leftMost (lambda (arg-2) (case (vector-ref arg-2 0) ((0) '()) (else (let ((e-7 (vector-ref arg-2 3))) (box (DataC-45SortedMapC-45Dependent-treeLeftMost e-7)))))))
(define DataC-45SortedMap-leftMost (lambda (ext-0) (PreludeC-45Types-u--map_Functor_Maybe (lambda (eta-0) eta-0) (DataC-45SortedMapC-45Dependent-leftMost ext-0))))
(define SystemC-45Clock-toNano (lambda (arg-1) (let ((e-1 (vector-ref arg-1 1))) (let ((e-2 (vector-ref arg-1 2))) (+ (* e-1 1000000000) e-2)))))
(define PreludeC-45EqOrd-u--C-62C-61_Ord_Integer (lambda (arg-0 arg-1) (let ((sc0 (or (and (>= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--caseC-32blockC-32inC-32nextDue-4881 (lambda (arg-1 arg-2 arg-3 arg-4 arg-5 arg-6) (if (null? arg-6) (vector 0 0) (let ((e-2 (unbox arg-6))) (let ((e-5 (car e-2))) (let ((e-6 (cdr e-2))) (let ((sc2 (PreludeC-45EqOrd-u--C-62C-61_Ord_Integer arg-2 e-5))) (cond ((equal? sc2 1) (let ((eff-0 (set-box! arg-1 (cons arg-4 (DataC-45SortedMap-delete e-5 arg-3))))) (vector 1 e-6))) (else (vector 0 (- e-5 arg-2)))))))))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--nextDue-4863 (lambda (arg-1 arg-2 arg-3) (let ((e-4 (car arg-3))) (let ((e-5 (cdr arg-3))) (IOC-45AsyncC-45LoopC-45TimerST-case--caseC-32blockC-32inC-32nextDue-4881 arg-1 arg-2 e-5 e-4 'erased (DataC-45SortedMap-leftMost e-5))))))
(define IOC-45AsyncC-45LoopC-45TimerST-nextDue (lambda (arg-0 arg-1 arg-2) (IOC-45AsyncC-45LoopC-45TimerST-case--nextDue-4863 arg-1 arg-0 (unbox arg-1))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--runDue-5257 (lambda (arg-0 arg-2 arg-3) (case (vector-ref arg-3 0) ((1) (let ((e-6 (vector-ref arg-3 1))) (let ((eff-0 (DataC-45LinearC-45Traverse1-traverse1_List (lambda (eta-0) (Builtin-snd eta-0)) e-6 'erased))) (IOC-45AsyncC-45LoopC-45TimerST-runDue arg-0 arg-2 'erased)))) (else (let ((e-9 (vector-ref arg-3 1))) e-9)))))
(define IOC-45AsyncC-45LoopC-45TimerST-runDue (lambda (arg-0 arg-1 arg-2) (IOC-45AsyncC-45LoopC-45TimerST-case--runDue-5257 arg-0 arg-1 (IOC-45AsyncC-45LoopC-45TimerST-nextDue arg-1 arg-0 arg-2))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32runDueTimers-5386 (lambda (arg-0 arg-2 arg-4 arg-5 arg-6) (let ((sc0 (PreludeC-45EqOrd-u--C-62C-61_Ord_Integer arg-6 arg-4))) (cond ((equal? sc0 0) (- arg-4 arg-6)) (else (IOC-45AsyncC-45LoopC-45TimerST-runDue arg-0 arg-6 'erased))))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--runDueTimers-5333 (lambda (arg-0 arg-2) (let ((sc0 (DataC-45SortedMap-leftMost (let ((e-1 (cdr arg-2))) e-1)))) (if (null? sc0) 0 (let ((e-2 (unbox sc0))) (let ((e-5 (car e-2))) (let ((e-6 (cdr e-2))) (IOC-45AsyncC-45LoopC-45TimerST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32runDueTimers-5386 arg-0 arg-2 e-5 e-6 (let ((eff-0 (SystemC-45Clock-clockTime 1 'erased))) (SystemC-45Clock-toNano eff-0))))))))))
(define IOC-45AsyncC-45LoopC-45TimerST-runDueTimers (lambda (arg-0 arg-1) (IOC-45AsyncC-45LoopC-45TimerST-case--runDueTimers-5333 arg-0 (unbox arg-0))))
(define IOC-45AsyncC-45LoopC-45Queue-n--3611-2538-u--go (lambda (arg-1 arg-2 arg-3 arg-4) (cond ((equal? arg-3 0) 0)(else (let ((e-0 (- arg-3 1))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-1 arg-2 e-0))) (cond ((equal? eff-0 1) 1)(else (IOC-45AsyncC-45LoopC-45Queue-dec arg-1 'erased)))))))))
(define IOC-45AsyncC-45LoopC-45Queue-case--dec-2605 (lambda (arg-1 arg-2) (IOC-45AsyncC-45LoopC-45Queue-n--3611-2538-u--go arg-1 arg-2 arg-2 'erased)))
(define IOC-45AsyncC-45LoopC-45Queue-dec (lambda (arg-0 arg-1) (IOC-45AsyncC-45LoopC-45Queue-case--dec-2605 arg-0 (unbox arg-0))))
(define IOC-45AsyncC-45LoopC-45Queue-case--inc-2485 (lambda (arg-1 arg-2) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-1 arg-2 (+ arg-2 1)))) (cond ((equal? eff-0 1) 'erased)(else (IOC-45AsyncC-45LoopC-45Queue-inc arg-1 'erased))))))
(define IOC-45AsyncC-45LoopC-45Queue-inc (lambda (arg-0 arg-1) (IOC-45AsyncC-45LoopC-45Queue-case--inc-2485 arg-0 (unbox arg-0))))
(define IOC-45AsyncC-45LoopC-45Posix-nextFin (lambda (arg-0 arg-1) (cond ((equal? arg-0 0) (blodwen-error-quit "Nat case not covered"))(else (let ((e-0 (- arg-0 1))) (cond ((equal? arg-1 0) e-0)(else (- arg-1 1))))))))
(define IOC-45AsyncC-45LoopC-45Queue-n--5194-3921-u--go (lambda (arg-2 arg-3 arg-4 arg-5) (let ((e-1 (vector-ref arg-4 0))) (let ((e-2 (vector-ref arg-4 1))) (let ((e-3 (vector-ref arg-4 2))) (if (null? e-3) (if (null? e-2) '() (let ((e-5 (car e-2))) (let ((e-4 (cdr e-2))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-3 (vector e-1 e-4 '())))) (cond ((equal? eff-0 1) (box e-5))(else (IOC-45AsyncC-45LoopC-45Queue-steal arg-2 'erased))))))) (let ((e-5 (car e-3))) (let ((e-4 (cdr e-3))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-3 (vector e-1 e-2 e-5)))) (cond ((equal? eff-0 1) (box e-4))(else (IOC-45AsyncC-45LoopC-45Queue-steal arg-2 'erased))))))))))))
(define IOC-45AsyncC-45LoopC-45Queue-case--steal-4160 (lambda (arg-2 arg-3) (IOC-45AsyncC-45LoopC-45Queue-n--5194-3921-u--go arg-2 arg-3 arg-3 'erased)))
(define IOC-45AsyncC-45LoopC-45Queue-steal (lambda (arg-1 arg-2) (IOC-45AsyncC-45LoopC-45Queue-case--steal-4160 arg-1 (unbox arg-1))))
(define IOC-45AsyncC-45LoopC-45Posix-stealTasks (lambda (arg-0 arg-1 arg-2 arg-3) (cond ((equal? arg-2 0) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Posix-debug (lambda () (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (let ((e-1 (vector-ref arg-0 1))) e-1)) (cons " could not steal anything" '())))) arg-3))) '()))(else (let ((e-0 (- arg-2 1))) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Queue-steal (let ((sc0 (DataC-45ArrayC-45Core-prim__arrayGet (let ((e-4 (vector-ref arg-0 4))) e-4) arg-1))) (let ((e-3 (vector-ref sc0 3))) e-3)) arg-3))) (if (null? eff-0) (IOC-45AsyncC-45LoopC-45Posix-stealTasks arg-0 (IOC-45AsyncC-45LoopC-45Posix-nextFin (let ((e-11 (vector-ref arg-0 0))) e-11) arg-1) e-0 'erased) (let ((e-6 (unbox eff-0))) (let ((eff-1 (IOC-45AsyncC-45LoopC-45Posix-debug (lambda () (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (let ((e-1 (vector-ref arg-0 1))) e-1)) (cons " stole a fiber from " (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 arg-1) (cons " " '())))))) 'erased))) (box e-6))))))))))
(define IOC-45AsyncC-45LoopC-45Posix-case--next-2102 (lambda (arg-0 arg-2) (if (null? arg-2) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Queue-dec (let ((e-6 (vector-ref arg-0 6))) e-6) 'erased))) (cond ((equal? eff-0 0) (let ((eff-1 (IOC-45AsyncC-45LoopC-45Posix-debug (lambda () (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (let ((e-1 (vector-ref arg-0 1))) e-1)) (cons " enough stealers are active" '())))) 'erased))) '())) (else (let ((eff-1 (IOC-45AsyncC-45LoopC-45Posix-debug (lambda () (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (let ((e-1 (vector-ref arg-0 1))) e-1)) (cons " start stealing" '())))) 'erased))) (let ((eff-2 (IOC-45AsyncC-45LoopC-45Posix-stealTasks arg-0 (IOC-45AsyncC-45LoopC-45Posix-nextFin (let ((e-0 (vector-ref arg-0 0))) e-0) (let ((e-1 (vector-ref arg-0 1))) e-1)) (DataC-45Nat-pred (let ((e-0 (vector-ref arg-0 0))) e-0)) 'erased))) (let ((eff-3 (IOC-45AsyncC-45LoopC-45Queue-inc (let ((e-6 (vector-ref arg-0 6))) e-6) 'erased))) eff-2)))))) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Posix-debug (lambda () (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (let ((e-1 (vector-ref arg-0 1))) e-1)) (cons " still got work to do" '())))) 'erased))) arg-2))))
(define SystemC-45Concurrency-conditionWaitTimeout (lambda (arg-1 arg-2 arg-3 arg-4) (let ((e-2 (cdr arg-1))) ((e-2 'erased) (lambda (eta-0) (SystemC-45Concurrency-prim__conditionWaitTimeout arg-2 arg-3 arg-4 eta-0))))))
(define IOC-45AsyncC-45LoopC-45Queue-case--caseC-32blockC-32inC-32deqAndSleepC-44go-3487 (lambda (arg-2 arg-3 arg-4 arg-5 arg-6 arg-7 arg-8) (if (null? arg-8) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-6 (vector 1 '() '())))) (cond ((equal? eff-0 1) '())(else (IOC-45AsyncC-45LoopC-45Queue-deq arg-2 'erased)))) (let ((e-1 (car arg-8))) (let ((e-2 (cdr arg-8))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-6 (vector 0 e-2 '())))) (cond ((equal? eff-0 1) (box e-1))(else (IOC-45AsyncC-45LoopC-45Queue-deq arg-2 'erased)))))))))
(define IOC-45AsyncC-45LoopC-45Queue-n--4561-3361-u--go (lambda (arg-2 arg-3 arg-4 arg-5) (let ((e-1 (vector-ref arg-4 0))) (let ((e-2 (vector-ref arg-4 1))) (let ((e-3 (vector-ref arg-4 2))) (if (null? e-2) (let ((u--h '())) (IOC-45AsyncC-45LoopC-45Queue-case--caseC-32blockC-32inC-32deqAndSleepC-44go-3487 arg-2 e-3 e-1 arg-5 arg-3 u--h (PreludeC-45TypesC-45SnocList-C-60C-62C-62 e-3 '()))) (let ((e-5 (car e-2))) (let ((e-4 (cdr e-2))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-3 (vector 0 e-4 e-3)))) (cond ((equal? eff-0 1) (box e-5))(else (IOC-45AsyncC-45LoopC-45Queue-deq arg-2 'erased))))))))))))
(define IOC-45AsyncC-45LoopC-45Queue-case--deqAndSleep-3662 (lambda (arg-2 arg-3) (IOC-45AsyncC-45LoopC-45Queue-n--4561-3361-u--go arg-2 arg-3 arg-3 'erased)))
(define IOC-45AsyncC-45LoopC-45Queue-deqAndSleep (lambda (arg-1 arg-2) (IOC-45AsyncC-45LoopC-45Queue-case--deqAndSleep-3662 arg-1 (unbox arg-1))))
(define IOC-45AsyncC-45Loop-prepend (lambda (arg-4 arg-5) (cons (vector 0 (lambda (eta-0) arg-4)) arg-5)))
(define IOC-45AsyncC-45Loop-hooks (lambda (arg-5) (if (null? arg-5) (cons (vector 3 ) '()) (let ((e-7 (car arg-5))) (let ((e-8 (cdr arg-5))) (case (vector-ref e-7 0) ((5) (let ((e-15 (vector-ref e-7 1))) (IOC-45AsyncC-45Loop-prepend e-15 (IOC-45AsyncC-45Loop-hooks e-8))))(else (IOC-45AsyncC-45Loop-hooks e-8))))))))
(define IOC-45AsyncC-45Loop-runC (lambda (arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-11) (case (vector-ref arg-7 0) ((6) (let ((e-3 (vector-ref arg-7 1))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 ((e-3 (let ((e-2 (vector-ref arg-9 0))) e-2)) 1) 1 arg-8 arg-9 (cons (vector 4 ) arg-10) arg-11))) ((1) (let ((e-7 (vector-ref arg-7 1))) (if (null? arg-10) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 'erased) 1 arg-8 arg-9 (IOC-45AsyncC-45Loop-hooks arg-10) arg-11) (let ((e-9 (car arg-10))) (let ((e-8 (cdr arg-10))) (case (vector-ref e-9 0) ((0) (let ((e-13 (vector-ref e-9 1))) (let ((u--st (cons (vector 0 e-13) e-8))) (let ((sc3 (e-13 e-7))) (case (vector-ref sc3 0) ((6) (let ((e-3 (vector-ref sc3 1))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 ((e-3 (let ((e-2 (vector-ref arg-9 0))) e-2)) 1) 1 arg-8 arg-9 (cons (vector 4 ) e-8) arg-11)))(else (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 'erased) 1 arg-8 arg-9 (IOC-45AsyncC-45Loop-hooks u--st) arg-11))))))) ((1) (IOC-45AsyncC-45Loop-runC arg-5 arg-6 (vector 1 (vector 1 e-7)) arg-8 arg-9 e-8 arg-11)) ((2) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 e-7) 1 arg-8 arg-9 e-8 arg-11))(else (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 'erased) 1 arg-8 arg-9 (IOC-45AsyncC-45Loop-hooks arg-10) arg-11)))))))) ((2) (let ((e-11 (vector-ref arg-7 1))) (if (null? arg-10) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 'erased) 1 arg-8 arg-9 (IOC-45AsyncC-45Loop-hooks arg-10) arg-11) (let ((e-7 (car arg-10))) (let ((e-8 (cdr arg-10))) (case (vector-ref e-7 0) ((1) (IOC-45AsyncC-45Loop-runC arg-5 arg-6 (vector 1 (vector 0 e-11)) arg-8 arg-9 e-8 arg-11)) ((2) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 2 e-11) 1 arg-8 arg-9 e-8 arg-11))(else (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 'erased) 1 arg-8 arg-9 (IOC-45AsyncC-45Loop-hooks arg-10) arg-11))))))))(else (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 'erased) 1 arg-8 arg-9 (IOC-45AsyncC-45Loop-hooks arg-10) arg-11)))))
(define DataC-45LinearC-45Deferred-n--4555-7603-u--go (lambda (arg-2 arg-4 arg-5 arg-6 arg-7) (case (vector-ref arg-6 0) ((0) 'erased) (else (let ((e-5 (vector-ref arg-6 1))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-5 (vector 1 (DataC-45SortedMap-delete arg-4 e-5))))) (cond ((equal? eff-0 1) 'erased)(else (DataC-45LinearC-45Deferred-unobsDef arg-2 arg-4 'erased)))))))))
(define DataC-45LinearC-45Deferred-case--unobsDef-7700 (lambda (arg-2 arg-4 arg-5) (DataC-45LinearC-45Deferred-n--4555-7603-u--go arg-2 arg-4 arg-5 arg-5 'erased)))
(define DataC-45LinearC-45Deferred-unobsDef (lambda (arg-2 arg-3 arg-4) (DataC-45LinearC-45Deferred-case--unobsDef-7700 arg-2 arg-3 (unbox arg-2))))
(define DataC-45LinearC-45Deferred-n--4702-7741-u--go (lambda (arg-2 arg-4 arg-5 arg-6 arg-7 arg-8) (case (vector-ref arg-7 0) ((0) (let ((e-2 (vector-ref arg-7 1))) (let ((eff-0 ((arg-4 e-2) arg-8))) (lambda (eta-0) 'erased)))) (else (let ((e-5 (vector-ref arg-7 1))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-6 (vector 1 (DataC-45SortedMap-insert arg-5 arg-4 e-5))))) (cond ((equal? eff-0 1) (lambda (eta-0) (DataC-45LinearC-45Deferred-unobsDef arg-2 arg-5 eta-0)))(else (DataC-45LinearC-45Deferred-observeDeferredAs1 arg-2 arg-5 arg-4 'erased)))))))))
(define DataC-45LinearC-45Deferred-case--observeDeferredAs1-7887 (lambda (arg-2 arg-4 arg-5 arg-6) (DataC-45LinearC-45Deferred-n--4702-7741-u--go arg-2 arg-4 arg-5 arg-6 arg-6 'erased)))
(define DataC-45LinearC-45Deferred-observeDeferredAs1 (lambda (arg-2 arg-3 arg-4 arg-5) (DataC-45LinearC-45Deferred-case--observeDeferredAs1-7887 arg-2 arg-4 arg-3 (unbox arg-2))))
(define DataC-45SortedMap-values (lambda (ext-0) (PreludeC-45TypesC-45List-mapAppend '() (lambda (eta-0) (Builtin-snd eta-0)) (DataC-45SortedMap-toList ext-0))))
(define DataC-45SortedMap-u--foldr_Foldable_C-40SortedMapC-32C-36kC-41 (lambda (arg-3 arg-4 ext-0) (PreludeC-45Types-u--foldr_Foldable_List arg-3 arg-4 (DataC-45SortedMap-values ext-0))))
(define DataC-45SortedMap-u--toList_Foldable_C-40SortedMapC-32C-36kC-41 (lambda (ext-0) (DataC-45SortedMap-u--foldr_Foldable_C-40SortedMapC-32C-36kC-41 csegen-115 '() ext-0)))
(define DataC-45LinearC-45Deferred-n--4399-7465-u--go (lambda (arg-2 arg-3 arg-5 arg-6 arg-7) (case (vector-ref arg-6 0) ((0) 'erased) (else (let ((e-5 (vector-ref arg-6 1))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-5 (vector 0 arg-3)))) (cond ((equal? eff-0 1) (DataC-45LinearC-45Traverse1-traverse1_List (lambda (u--cb) (u--cb arg-3)) (DataC-45SortedMap-u--toList_Foldable_C-40SortedMapC-32C-36kC-41 e-5) 'erased))(else (DataC-45LinearC-45Deferred-putDeferred1 arg-2 arg-3 'erased)))))))))
(define DataC-45LinearC-45Deferred-case--putDeferred1-7569 (lambda (arg-2 arg-3 arg-5) (DataC-45LinearC-45Deferred-n--4399-7465-u--go arg-2 arg-3 arg-5 arg-5 'erased)))
(define DataC-45LinearC-45Deferred-putDeferred1 (lambda (arg-2 arg-3 arg-4) (DataC-45LinearC-45Deferred-case--putDeferred1-7569 arg-2 arg-3 (unbox arg-2))))
(define ControlC-45MonadC-45MCancel-toOutcome (lambda (arg-2) (case (vector-ref arg-2 0) ((1) (let ((e-2 (vector-ref arg-2 1))) (vector 0 e-2))) (else (let ((e-5 (vector-ref arg-2 1))) (vector 1 e-5))))))
(define IOC-45AsyncC-45Loop-case--asynchronous-3118 (lambda (arg-3 arg-4) (let ((eff-0 ((arg-3 (lambda (eta-0) (lambda (eta-1) (DataC-45LinearC-45Deferred-putDeferred1 arg-4 (ControlC-45MonadC-45MCancel-toOutcome eta-0) eta-1)))) 'erased))) (let ((u--cncl (lambda (eta-0) (let ((eff-1 (eff-0 eta-0))) (DataC-45LinearC-45Deferred-putDeferred1 arg-4 (vector 2 ) 'erased))))) (cons u--cncl (lambda (eta-0) (lambda (eta-1) (lambda (eta-2) (DataC-45LinearC-45Deferred-observeDeferredAs1 arg-4 eta-0 eta-1 eta-2)))))))))
(define IOC-45AsyncC-45Loop-asynchronous (lambda (arg-2 arg-3) (IOC-45AsyncC-45Loop-case--asynchronous-3118 arg-2 (box csegen-173))))
(define IOC-45AsyncC-45Loop-newFiber (lambda (arg-2) (let ((eff-0 (DataC-45LinearC-45Unique-token1 arg-2))) (let ((eff-1 (box (vector 0 )))) (let ((eff-2 (box csegen-173))) (vector eff-0 eff-1 eff-2))))))
(define DataC-45LinearC-45Deferred-n--3572-6726-u--go (lambda (arg-2 arg-3 arg-5 arg-6 arg-7) (case (vector-ref arg-6 0) ((0) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-5 (vector 1 arg-3)))) (cond ((equal? eff-0 1) 'erased)(else (DataC-45LinearC-45Deferred-putOnce1 arg-2 arg-3 'erased))))) ((1) 'erased) (else (let ((e-7 (vector-ref arg-6 1))) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-5 (vector 1 arg-3)))) (cond ((equal? eff-0 1) ((e-7 arg-3) 'erased))(else (DataC-45LinearC-45Deferred-putOnce1 arg-2 arg-3 'erased)))))))))
(define DataC-45LinearC-45Deferred-case--putOnce1-6880 (lambda (arg-2 arg-3 arg-5) (DataC-45LinearC-45Deferred-n--3572-6726-u--go arg-2 arg-3 arg-5 arg-5 'erased)))
(define DataC-45LinearC-45Deferred-putOnce1 (lambda (arg-2 arg-3 arg-4) (DataC-45LinearC-45Deferred-case--putOnce1-6880 arg-2 arg-3 (unbox arg-2))))
(define IOC-45AsyncC-45Loop-synchronous (lambda (arg-2) (cons (lambda (eta-0) 'erased) (lambda (_-3052) (lambda (u--cb) (lambda (u--t) (let ((eff-0 ((u--cb arg-2) u--t))) (lambda (eta-0) 'erased))))))))
(define IOC-45AsyncC-45Loop-toFiber (lambda (arg-2) (cons (lambda (eta-0) (DataC-45LinearC-45Deferred-putOnce1 (let ((e-3 (vector-ref arg-2 1))) e-3) 'erased eta-0)) (lambda (eta-0) (lambda (eta-1) (lambda (eta-2) (DataC-45LinearC-45Deferred-observeDeferredAs1 (let ((e-4 (vector-ref arg-2 2))) e-4) eta-0 eta-1 eta-2)))))))
(define IOC-45AsyncC-45Loop-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32runR-5835 (lambda (arg-7 arg-8 arg-9 arg-10 arg-11 arg-12 arg-13 arg-15 arg-16) (let ((eff-0 (let ((e-1 (car arg-11))) (((e-1 arg-15) (vector arg-16 0 arg-12 '())) 'erased)))) (IOC-45AsyncC-45Loop-run arg-11 arg-15 (vector 1 (IOC-45AsyncC-45Loop-toFiber arg-16)) arg-10 arg-9 arg-8 arg-7 'erased))))
(define DataC-45LinearC-45Deferred-n--3783-6909-u--go (lambda (arg-2 arg-4 arg-5 arg-6) (case (vector-ref arg-5 0) ((2) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-4 (vector 0 )))) (cond ((equal? eff-0 1) 'erased)(else (DataC-45LinearC-45Deferred-unobs arg-2 'erased)))))(else 'erased))))
(define DataC-45LinearC-45Deferred-case--unobs-6994 (lambda (arg-2 arg-4) (DataC-45LinearC-45Deferred-n--3783-6909-u--go arg-2 arg-4 arg-4 'erased)))
(define DataC-45LinearC-45Deferred-unobs (lambda (arg-2 arg-3) (DataC-45LinearC-45Deferred-case--unobs-6994 arg-2 (unbox arg-2))))
(define DataC-45LinearC-45Deferred-n--3908-7029-u--go (lambda (arg-2 arg-4 arg-5 arg-6 arg-7) (case (vector-ref arg-6 0) ((1) (let ((e-2 (vector-ref arg-6 1))) (let ((eff-0 ((arg-4 e-2) arg-7))) (lambda (eta-0) 'erased)))) ((0) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-5 (vector 2 arg-4)))) (cond ((equal? eff-0 1) (lambda (eta-0) (DataC-45LinearC-45Deferred-unobs arg-2 eta-0)))(else (DataC-45LinearC-45Deferred-observeOnce1 arg-2 arg-4 'erased)))))(else (lambda (eta-0) 'erased)))))
(define DataC-45LinearC-45Deferred-case--observeOnce1-7170 (lambda (arg-2 arg-4 arg-5) (DataC-45LinearC-45Deferred-n--3908-7029-u--go arg-2 arg-4 arg-5 arg-5 'erased)))
(define DataC-45LinearC-45Deferred-observeOnce1 (lambda (arg-2 arg-3 arg-4) (DataC-45LinearC-45Deferred-case--observeOnce1-7170 arg-2 arg-3 (unbox arg-2))))
(define IOC-45AsyncC-45Loop-spawnCB (lambda (arg-2 arg-3 arg-4) (let ((e-5 (vector-ref arg-2 0))) (let ((e-6 (vector-ref arg-2 1))) (let ((e-7 (vector-ref arg-2 2))) (let ((e-8 (vector-ref arg-2 3))) (let ((e-9 (vector-ref arg-2 4))) (let ((e-10 (vector-ref arg-2 5))) (let ((e-11 (vector-ref arg-2 6))) (case (vector-ref arg-3 0) ((0) (let ((e-2 (vector-ref arg-3 1))) (let ((eff-0 (e-7 arg-4))) (let ((e-1 (car e-11))) (((e-1 e-5) (vector e-8 e-9 (vector 1 e-2) e-10)) 'erased))))) ((1) (let ((e-12 (vector-ref arg-3 1))) (let ((eff-0 (e-7 arg-4))) (let ((e-1 (car e-11))) (((e-1 e-5) (vector e-8 e-9 (vector 2 e-12) e-10)) 'erased))))) (else (let ((eff-0 (e-6 arg-4))) (let ((e-1 (car e-11))) (((e-1 e-5) (vector e-8 1 (vector 1 'erased) (IOC-45AsyncC-45Loop-hooks e-10))) 'erased))))))))))))))
(define IOC-45AsyncC-45Loop-obsOnce (lambda (arg-3 arg-4 arg-5) (let ((eff-0 (DataC-45LinearC-45Deferred-observeOnce1 arg-3 (lambda (eta-0) (lambda (eta-1) (IOC-45AsyncC-45Loop-spawnCB arg-4 eta-0 eta-1))) arg-5))) '())))
(define IOC-45AsyncC-45Loop-observeCancel (lambda (arg-4 arg-5 arg-6 ext-0) (cond ((equal? arg-5 0) (DataC-45LinearC-45Deferred-observeOnce1 (let ((e-3 (vector-ref arg-6 1))) e-3) (lambda (_-3004) (lambda (eta-0) (DataC-45LinearC-45Deferred-putOnce1 arg-4 (vector 2 ) eta-0))) ext-0))(else (lambda (eta-0) 'erased)))))
(define DataC-45LinearC-45Deferred-peekOnce1 (lambda (arg-2 arg-3) (let ((eff-0 (unbox arg-2))) (case (vector-ref eff-0 0) ((1) (let ((e-6 (vector-ref eff-0 1))) (box e-6)))(else '())))))
(define IOC-45AsyncC-45Loop-writeOnCB (lambda (arg-2 arg-3 arg-4) ((arg-3 (lambda (eta-0) (lambda (eta-1) (DataC-45LinearC-45Deferred-putOnce1 arg-2 (ControlC-45MonadC-45MCancel-toOutcome eta-0) eta-1)))) arg-4)))
(define IOC-45AsyncC-45Loop-case--caseC-32blockC-32inC-32runR-6419 (lambda (arg-6 arg-7 arg-8 arg-9 arg-10 arg-11 arg-12 arg-13 arg-14) (let ((eff-0 (IOC-45AsyncC-45Loop-writeOnCB arg-14 arg-12 'erased))) (let ((eff-1 (IOC-45AsyncC-45Loop-observeCancel arg-14 arg-9 arg-7 'erased))) (let ((eff-2 (DataC-45LinearC-45Deferred-peekOnce1 arg-14 'erased))) (if (null? eff-2) (IOC-45AsyncC-45Loop-obsOnce arg-14 (vector arg-11 eff-0 eff-1 arg-7 arg-9 arg-6 arg-10) 'erased) (let ((e-6 (unbox eff-2))) (case (vector-ref e-6 0) ((0) (let ((e-2 (vector-ref e-6 1))) (let ((eff-3 (eff-1 'erased))) (IOC-45AsyncC-45Loop-run arg-10 arg-11 (vector 1 e-2) arg-9 arg-8 arg-7 arg-6 'erased)))) ((1) (let ((e-5 (vector-ref e-6 1))) (let ((eff-3 (eff-1 'erased))) (IOC-45AsyncC-45Loop-run arg-10 arg-11 (vector 2 e-5) arg-9 arg-8 arg-7 arg-6 'erased)))) (else (let ((eff-3 (eff-0 'erased))) (IOC-45AsyncC-45Loop-run arg-10 arg-11 (vector 1 'erased) 1 arg-8 arg-7 (IOC-45AsyncC-45Loop-hooks arg-6) 'erased)))))))))))
(define IOC-45AsyncC-45Loop-runR (lambda (arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-11 arg-12) (case (vector-ref arg-7 0) ((0) (let ((e-4 (vector-ref arg-7 1))) (let ((e-5 (vector-ref arg-7 2))) (case (vector-ref e-4 0) ((1) (let ((e-3 (vector-ref e-4 1))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (e-5 e-3) arg-8 arg-9 arg-10 arg-11 arg-12))) ((9) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (e-5 (let ((e-2 (vector-ref arg-10 0))) e-2)) arg-8 arg-9 arg-10 arg-11 arg-12))(else (IOC-45AsyncC-45Loop-run arg-5 arg-6 e-4 arg-8 arg-9 arg-10 (cons (vector 0 e-5) arg-11) arg-12)))))) ((1) (let ((e-9 (vector-ref arg-7 1))) (let ((u--act (vector 1 e-9))) (if (null? arg-11) (let ((eff-0 (DataC-45LinearC-45Deferred-putDeferred1 (let ((e-4 (vector-ref arg-10 2))) e-4) (vector 0 e-9) arg-12))) '()) (let ((e-7 (car arg-11))) (let ((e-8 (cdr arg-11))) (case (vector-ref e-7 0) ((0) (let ((e-16 (vector-ref e-7 1))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (e-16 e-9) arg-8 arg-9 arg-10 e-8 arg-12))) ((2) (IOC-45AsyncC-45Loop-run arg-5 arg-6 u--act (+ arg-8 1) arg-9 arg-10 e-8 arg-12)) ((4) (IOC-45AsyncC-45Loop-run arg-5 arg-6 u--act (DataC-45Nat-pred arg-8) arg-9 arg-10 e-8 arg-12)) ((5) (IOC-45AsyncC-45Loop-run arg-5 arg-6 u--act arg-8 arg-9 arg-10 e-8 arg-12)) ((3) (let ((eff-0 (DataC-45LinearC-45Deferred-putDeferred1 (let ((e-4 (vector-ref arg-10 2))) e-4) (vector 2 ) arg-12))) '())) (else (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 (vector 1 e-9)) arg-8 arg-9 arg-10 e-8 arg-12))))))))) ((2) (let ((e-13 (vector-ref arg-7 1))) (let ((u--act (vector 2 e-13))) (if (null? arg-11) (let ((eff-0 (DataC-45LinearC-45Deferred-putDeferred1 (let ((e-4 (vector-ref arg-10 2))) e-4) (vector 1 e-13) arg-12))) '()) (let ((e-7 (car arg-11))) (let ((e-8 (cdr arg-11))) (case (vector-ref e-7 0) ((1) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 (vector 0 e-13)) arg-8 arg-9 arg-10 e-8 arg-12)) ((0) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 2 e-13) arg-8 arg-9 arg-10 e-8 arg-12)) ((2) (IOC-45AsyncC-45Loop-run arg-5 arg-6 u--act (+ arg-8 1) arg-9 arg-10 e-8 arg-12)) ((4) (IOC-45AsyncC-45Loop-run arg-5 arg-6 u--act (DataC-45Nat-pred arg-8) arg-9 arg-10 e-8 arg-12)) ((5) (IOC-45AsyncC-45Loop-run arg-5 arg-6 u--act arg-8 arg-9 arg-10 e-8 arg-12)) (else (let ((eff-0 (DataC-45LinearC-45Deferred-putDeferred1 (let ((e-4 (vector-ref arg-10 2))) e-4) (vector 2 ) arg-12))) '()))))))))) ((11) (let ((e-18 (vector-ref arg-7 1))) (let ((u--act (vector 11 e-18))) (case (vector-ref e-18 0) ((12) (let ((e-3 (vector-ref e-18 1))) (let ((eff-0 (IOC-45AsyncC-45Loop-asynchronous e-3 arg-12))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 eff-0) arg-8 arg-9 arg-10 arg-11 'erased)))) ((4) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 (IOC-45AsyncC-45Loop-synchronous (vector 2 ))) arg-8 arg-9 arg-10 arg-11 arg-12)) ((1) (let ((e-9 (vector-ref e-18 1))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 (IOC-45AsyncC-45Loop-synchronous (vector 0 e-9))) arg-8 arg-9 arg-10 arg-11 arg-12))) ((2) (let ((e-13 (vector-ref e-18 1))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 (IOC-45AsyncC-45Loop-synchronous (vector 1 e-13))) arg-8 arg-9 arg-10 arg-11 arg-12))) ((9) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 (IOC-45AsyncC-45Loop-synchronous (vector 0 (let ((e-2 (vector-ref arg-10 0))) e-2)))) arg-8 arg-9 arg-10 arg-11 arg-12))(else (IOC-45AsyncC-45Loop-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32runR-5835 arg-11 arg-10 arg-9 arg-8 arg-5 e-18 u--act arg-6 (IOC-45AsyncC-45Loop-newFiber arg-12))))))) ((3) (let ((e-22 (vector-ref arg-7 1))) (let ((eff-0 (e-22 arg-12))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (PreludeC-45Types-either (lambda () (lambda (eta-0) (vector 2 eta-0))) (lambda () (lambda (eta-0) (vector 1 eta-0))) eff-0) arg-8 arg-9 arg-10 arg-11 'erased)))) ((7) (let ((e-27 (vector-ref arg-7 1))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 e-27 arg-8 arg-9 arg-10 (cons (vector 1 ) arg-11) arg-12))) ((4) (let ((eff-0 (DataC-45LinearC-45Deferred-putOnce1 (let ((e-3 (vector-ref arg-10 1))) e-3) 'erased arg-12))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 'erased) arg-8 arg-9 arg-10 arg-11 'erased))) ((5) (let ((e-33 (vector-ref arg-7 1))) (let ((e-34 (vector-ref arg-7 2))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 e-33 arg-8 arg-9 arg-10 (cons (vector 5 e-34) arg-11) arg-12)))) ((6) (let ((e-38 (vector-ref arg-7 1))) (IOC-45AsyncC-45Loop-run arg-5 arg-6 ((e-38 (let ((e-2 (vector-ref arg-10 0))) e-2)) (+ arg-8 1)) (+ arg-8 1) arg-9 arg-10 (cons (vector 4 ) arg-11) arg-12))) ((8) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 arg-6) arg-8 arg-9 arg-10 arg-11 arg-12)) ((10) (box (vector arg-10 arg-8 (vector 1 'erased) arg-11))) ((9) (IOC-45AsyncC-45Loop-run arg-5 arg-6 (vector 1 (let ((e-2 (vector-ref arg-10 0))) e-2)) arg-8 arg-9 arg-10 arg-11 arg-12)) ((12) (let ((e-48 (vector-ref arg-7 1))) (let ((u--act (vector 12 e-48))) (IOC-45AsyncC-45Loop-case--caseC-32blockC-32inC-32runR-6419 arg-11 arg-10 arg-9 arg-8 arg-5 arg-6 e-48 u--act (box (vector 0 )))))) (else (let ((e-52 (vector-ref arg-7 1))) (let ((e-53 (vector-ref arg-7 2))) (let ((e-54 (vector-ref arg-7 3))) (let ((sc1 (let ((sc2 (or (and (= e-52 (let ((e-2 (vector-ref arg-10 0))) e-2)) 1) 0))) (cond ((equal? sc2 1) (or (and (= e-53 arg-8) 1) 0)) (else 0))))) (cond ((equal? sc1 1) (IOC-45AsyncC-45Loop-run arg-5 arg-6 e-54 (DataC-45Nat-pred arg-8) arg-9 arg-10 (cons (vector 2 ) arg-11) arg-12)) (else (IOC-45AsyncC-45Loop-run arg-5 arg-6 e-54 arg-8 arg-9 arg-10 arg-11 arg-12)))))))))))
(define IOC-45AsyncC-45Loop-run (lambda (arg-5 arg-6 arg-7 arg-8 arg-9 arg-10 arg-11 arg-12) (cond ((equal? arg-9 0) (box (vector arg-10 arg-8 arg-7 arg-11)))(else (cond ((equal? arg-8 0) (cond ((equal? arg-9 0) (cond ((equal? arg-9 0) (blodwen-error-quit "Nat case not covered"))(else (let ((e-0 (- arg-9 1))) (IOC-45AsyncC-45Loop-runR arg-5 arg-6 arg-7 arg-8 e-0 arg-10 arg-11 arg-12)))))(else (let ((e-1 (- arg-9 1))) (let ((eff-0 (let ((eff-0 (unbox (let ((e-3 (vector-ref arg-10 1))) e-3)))) (case (vector-ref eff-0 0) ((1) 1)(else 0))))) (cond ((equal? eff-0 0) (IOC-45AsyncC-45Loop-runR arg-5 arg-6 arg-7 0 e-1 arg-10 arg-11 'erased)) (else (IOC-45AsyncC-45Loop-runC arg-5 arg-6 arg-7 e-1 arg-10 arg-11 'erased))))))))(else (cond ((equal? arg-9 0) (blodwen-error-quit "Nat case not covered"))(else (let ((e-0 (- arg-9 1))) (IOC-45AsyncC-45Loop-runR arg-5 arg-6 arg-7 arg-8 e-0 arg-10 arg-11 arg-12))))))))))
(define IOC-45AsyncC-45Loop-runFbr (lambda (arg-1 arg-2 arg-3 ext-0) (let ((e-5 (vector-ref arg-3 0))) (let ((e-6 (vector-ref arg-3 1))) (let ((e-7 (vector-ref arg-3 2))) (let ((e-8 (vector-ref arg-3 3))) (IOC-45AsyncC-45Loop-run arg-1 arg-2 e-7 e-6 (let ((e-2 (cdr arg-1))) e-2) e-5 e-8 ext-0)))))))
(define IOC-45AsyncC-45LoopC-45Posix-case--runTask-2344 (lambda (arg-0 arg-2 arg-3) (if (null? arg-3) 'erased (let ((e-5 (unbox arg-3))) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Queue-enq (let ((e-3 (vector-ref arg-0 3))) e-3) e-5 'erased))) 'erased)))))
(define IOC-45AsyncC-45LoopC-45Posix-runTask (lambda (arg-0 arg-1 arg-2) (IOC-45AsyncC-45LoopC-45Posix-case--runTask-2344 arg-0 arg-1 (IOC-45AsyncC-45Loop-runFbr csegen-129 arg-0 arg-1 arg-2))))
(define PreludeC-45Num-u--div_Integral_Integer (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Integer arg-1 0))) (cond ((equal? sc0 0) (blodwen-euclidDiv arg-0 arg-1))(else (blodwen-error-quit (string-append "ERROR: " "Unhandled input for Prelude.Num.case block in div at Prelude.Num:91:3--93:44")))))))
(define PreludeC-45EqOrd-u--C-60_Ord_Int (lambda (arg-0 arg-1) (let ((sc0 (or (and (< arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--min_Ord_Int (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Int arg-0 arg-1))) (cond ((equal? sc0 1) arg-0) (else arg-1)))))
(define IOC-45AsyncC-45LoopC-45Posix-sleepDuration (lambda (arg-0) (cond ((equal? arg-0 0) (blodwen-toSignedInt 2000 63))(else (PreludeC-45EqOrd-u--min_Ord_Int (blodwen-toSignedInt (PreludeC-45Num-u--div_Integral_Integer arg-0 1000) 63) (blodwen-toSignedInt 2000 63))))))
(define PreludeC-45Show-u--showPrec_Show_Int (lambda (ext-0 ext-1) (PreludeC-45Show-primNumShow (lambda (eta-0) (number->string eta-0)) ext-0 ext-1)))
(define PreludeC-45Show-u--show_Show_Int (lambda (arg-0) (PreludeC-45Show-u--showPrec_Show_Int (vector 0 ) arg-0)))
(define IOC-45AsyncC-45LoopC-45Posix-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32loop-2504 (lambda (arg-0 arg-3 arg-4 arg-5 arg-7) (if (null? arg-7) (let ((eff-0 (IOC-45AsyncC-45LoopC-45SignalST-checkSignals (let ((e-8 (vector-ref arg-0 8))) e-8) 'erased))) (let ((eff-1 ((SystemC-45Concurrency-mutexAcquire csegen-77 (let ((e-9 (vector-ref arg-0 9))) e-9)) 'erased))) (let ((eff-2 (IOC-45AsyncC-45LoopC-45Queue-deqAndSleep (let ((e-3 (vector-ref arg-0 3))) e-3) 'erased))) (if (null? eff-2) (let ((u--d (IOC-45AsyncC-45LoopC-45Posix-sleepDuration arg-5))) (let ((eff-3 (IOC-45AsyncC-45LoopC-45Posix-debug (lambda () (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons (DataC-45Fin-u--show_Show_C-40FinC-32C-36nC-41 (let ((e-1 (vector-ref arg-0 1))) e-1)) (cons " sleeping for " (cons (PreludeC-45Show-u--show_Show_Int u--d) (cons " us" '())))))) 'erased))) (let ((eff-4 ((SystemC-45Concurrency-conditionWaitTimeout csegen-77 (let ((e-10 (vector-ref arg-0 10))) e-10) (let ((e-9 (vector-ref arg-0 9))) e-9) u--d) 'erased))) (let ((eff-5 ((SystemC-45Concurrency-mutexRelease csegen-77 (let ((e-9 (vector-ref arg-0 9))) e-9)) 'erased))) (IOC-45AsyncC-45LoopC-45Posix-loop arg-0 IOC-45AsyncC-45LoopC-45Posix-POLL_ITER 'erased))))) (let ((e-5 (unbox eff-2))) (let ((eff-3 ((SystemC-45Concurrency-mutexRelease csegen-77 (let ((e-9 (vector-ref arg-0 9))) e-9)) 'erased))) (let ((eff-4 (IOC-45AsyncC-45LoopC-45Posix-runTask arg-0 e-5 'erased))) (IOC-45AsyncC-45LoopC-45Posix-loop arg-0 IOC-45AsyncC-45LoopC-45Posix-POLL_ITER 'erased)))))))) (let ((e-5 (unbox arg-7))) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Posix-runTask arg-0 e-5 'erased))) (IOC-45AsyncC-45LoopC-45Posix-loop arg-0 arg-3 'erased))))))
(define IOC-45AsyncC-45LoopC-45Posix-loop (lambda (arg-0 arg-1 arg-2) (let ((eff-0 (unbox (let ((e-2 (vector-ref arg-0 2))) e-2)))) (cond ((equal? eff-0 0) 'erased) (else (cond ((equal? arg-1 0) (let ((eff-1 (IOC-45AsyncC-45LoopC-45SignalST-checkSignals (let ((e-8 (vector-ref arg-0 8))) e-8) 'erased))) (IOC-45AsyncC-45LoopC-45Posix-loop arg-0 IOC-45AsyncC-45LoopC-45Posix-POLL_ITER 'erased)))(else (let ((e-0 (- arg-1 1))) (let ((u--cpoll (+ e-0 1))) (let ((eff-1 (IOC-45AsyncC-45LoopC-45TimerST-runDueTimers (let ((e-7 (vector-ref arg-0 7))) e-7) 'erased))) (IOC-45AsyncC-45LoopC-45Posix-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32caseC-32blockC-32inC-32loop-2504 arg-0 e-0 u--cpoll eff-1 (IOC-45AsyncC-45LoopC-45Posix-case--next-2102 arg-0 (IOC-45AsyncC-45LoopC-45Queue-deq (let ((e-3 (vector-ref arg-0 3))) e-3) 'erased)))))))))))))
(define PreludeC-45IO-fork (lambda (arg-0 ext-0) (PreludeC-45IO-prim__fork arg-0 ext-0)))
(define PreludeC-45Num-u--mod_Integral_Integer (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Integer arg-1 0))) (cond ((equal? sc0 0) (blodwen-euclidMod arg-0 arg-1))(else (blodwen-error-quit (string-append "ERROR: " "Unhandled input for Prelude.Num.case block in mod at Prelude.Num:94:3--96:44")))))))
(define SystemC-45Clock-fromNano (lambda (arg-0 arg-1) (let ((u--seconds (PreludeC-45Num-u--div_Integral_Integer arg-1 1000000000))) (let ((u--nanoseconds (PreludeC-45Num-u--mod_Integral_Integer arg-1 1000000000))) (vector arg-0 u--seconds u--nanoseconds)))))
(define IOC-45AsyncC-45LoopC-45Posix-pollLoop (lambda (arg-0 arg-1 arg-2) (let ((eff-0 (unbox arg-0))) (cond ((equal? eff-0 1) (let ((eff-1 (let ((e-1 (vector-ref arg-1 1))) ((e-1 (SystemC-45Clock-fromNano 2 10000000)) 'erased)))) (IOC-45AsyncC-45LoopC-45Posix-pollLoop arg-0 arg-1 'erased)))(else (let ((e-2 (vector-ref arg-1 2))) (e-2 'erased)))))))
(define DataC-45Vect-tail (lambda (arg-2) (let ((e-3 (cdr arg-2))) e-3)))
(define DataC-45ArrayC-45Indexed-ontoVect (lambda (arg-3 arg-4 arg-6) (cond ((equal? arg-4 0) arg-3)(else (let ((e-0 (- arg-4 1))) (DataC-45ArrayC-45Indexed-ontoVect (cons (DataC-45ArrayC-45Core-prim__arrayGet arg-6 e-0) arg-3) e-0 arg-6))))))
(define SystemC-45Concurrency-makeCondition (lambda (arg-1) (let ((e-2 (cdr arg-1))) ((e-2 'erased) (lambda (eta-0) (SystemC-45Concurrency-prim__makeCondition eta-0))))))
(define SystemC-45Concurrency-makeMutex (lambda (arg-1) (let ((e-2 (cdr arg-1))) ((e-2 'erased) (lambda (eta-0) (SystemC-45Concurrency-prim__makeMutex eta-0))))))
(define IOC-45AsyncC-45LoopC-45SignalST-sighandler (lambda (arg-0) (box (cons 0 csegen-221))))
(define PreludeC-45EqOrd-u--C-47C-61_Eq_Integer (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Integer arg-0 arg-1))) (cond ((equal? sc0 1) 0) (else 1)))))
(define PreludeC-45EqOrd-u--C-60C-61_Ord_Integer (lambda (arg-0 arg-1) (let ((sc0 (or (and (<= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--C-62_Ord_Integer (lambda (arg-0 arg-1) (let ((sc0 (or (and (> arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--max_Ord_Integer (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-62_Ord_Integer arg-0 arg-1))) (cond ((equal? sc0 1) arg-0) (else arg-1)))))
(define PreludeC-45EqOrd-u--min_Ord_Integer (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Integer arg-0 arg-1))) (cond ((equal? sc0 1) arg-0) (else arg-1)))))
(define IOC-45AsyncC-45LoopC-45TimerST-timer (lambda (arg-0) (box (cons 0 (DataC-45SortedMap-empty (vector (cons (lambda (arg-712) (lambda (arg-715) (PreludeC-45EqOrd-u--C-61C-61_Eq_Integer arg-712 arg-715))) (lambda (arg-722) (lambda (arg-725) (PreludeC-45EqOrd-u--C-47C-61_Eq_Integer arg-722 arg-725)))) (force csegen-164) (lambda (arg-1604) (lambda (arg-1607) (PreludeC-45EqOrd-u--C-60_Ord_Integer arg-1604 arg-1607))) (lambda (arg-1614) (lambda (arg-1617) (PreludeC-45EqOrd-u--C-62_Ord_Integer arg-1614 arg-1617))) (lambda (arg-1624) (lambda (arg-1627) (PreludeC-45EqOrd-u--C-60C-61_Ord_Integer arg-1624 arg-1627))) (lambda (arg-1634) (lambda (arg-1637) (PreludeC-45EqOrd-u--C-62C-61_Ord_Integer arg-1634 arg-1637))) (lambda (arg-1644) (lambda (arg-1647) (PreludeC-45EqOrd-u--max_Ord_Integer arg-1644 arg-1647))) (lambda (arg-1654) (lambda (arg-1657) (PreludeC-45EqOrd-u--min_Ord_Integer arg-1654 arg-1657)))))))))
(define IOC-45AsyncC-45LoopC-45Posix-workST (lambda (arg-0 arg-1 arg-2 arg-3 arg-4 ext-0) (let ((eff-0 (box 1))) (let ((eff-1 (IOC-45AsyncC-45LoopC-45TimerST-timer 'erased))) (let ((eff-2 (IOC-45AsyncC-45LoopC-45SignalST-sighandler 'erased))) (let ((eff-3 (box (vector 0 '() '())))) (let ((eff-4 ((SystemC-45Concurrency-makeMutex csegen-77) 'erased))) (let ((eff-5 ((SystemC-45Concurrency-makeCondition csegen-77) 'erased))) (vector arg-0 arg-1 eff-0 eff-3 arg-3 arg-2 arg-4 eff-1 eff-2 eff-4 eff-5)))))))))
(define IOC-45AsyncC-45LoopC-45Posix-workSTs (lambda (arg-0 arg-1 arg-2 arg-3 arg-4 arg-5) (cond ((equal? arg-5 0) (lambda (eta-0) (DataC-45ArrayC-45Indexed-ontoVect '() arg-0 arg-3)))(else (let ((e-0 (- arg-5 1))) (lambda (world-0) (let ((act-1 (IOC-45AsyncC-45LoopC-45Posix-workST arg-0 e-0 arg-1 arg-3 arg-4 world-0))) (let ((act-2 (DataC-45ArrayC-45Core-prim__arraySet arg-2 e-0 act-1 world-0))) ((IOC-45AsyncC-45LoopC-45Posix-workSTs arg-0 arg-1 arg-2 arg-3 arg-4 e-0) world-0)))))))))
(define DataC-45Vect-u--traverse_Traversable_C-40VectC-32C-36kC-41 (lambda (arg-4 arg-5 arg-6) (if (null? arg-6) (let ((e-2 (vector-ref arg-4 1))) ((e-2 'erased) '())) (let ((e-3 (car arg-6))) (let ((e-4 (cdr arg-6))) (let ((e-5 (vector-ref arg-4 2))) ((((e-5 'erased) 'erased) (let ((e-6 (vector-ref arg-4 2))) ((((e-6 'erased) 'erased) (let ((e-10 (vector-ref arg-4 1))) ((e-10 'erased) csegen-115))) (arg-5 e-3)))) (DataC-45Vect-u--traverse_Traversable_C-40VectC-32C-36kC-41 arg-4 arg-5 e-4))))))))
(define IOC-45AsyncC-45LoopC-45Posix-mkThreadPool (lambda (arg-0 arg-1) (cond ((equal? arg-0 0) (blodwen-error-quit "Nat case not covered"))(else (let ((e-4 (- arg-0 1))) (lambda (world-0) (let ((act-1 (DataC-45ArrayC-45Core-prim__emptyArray (+ e-4 1) world-0))) (let ((act-2 (box 1))) (let ((act-3 (arg-1 world-0))) (let ((act-4 ((IOC-45AsyncC-45LoopC-45Posix-workSTs (+ e-4 1) act-3 act-1 act-1 act-2 (+ e-4 1)) world-0))) (let ((act-5 ((DataC-45Vect-u--traverse_Traversable_C-40VectC-32C-36kC-41 csegen-70 (lambda (u--x) (lambda (eta-0) (PreludeC-45IO-fork (lambda (eta-1) (IOC-45AsyncC-45LoopC-45Posix-loop u--x IOC-45AsyncC-45LoopC-45Posix-POLL_ITER eta-1)) eta-0))) (DataC-45Vect-tail act-4)) world-0))) (let ((act-6 (PreludeC-45IO-fork (lambda (eta-0) (IOC-45AsyncC-45LoopC-45Posix-pollLoop (let ((sc0 (DataC-45Vect-head act-4))) (let ((e-2 (vector-ref sc0 2))) e-2)) act-3 eta-0)) world-0))) (vector e-4 act-5 act-6 act-4)))))))))))))
(define IOC-45AsyncC-45LoopC-45Posix-release (lambda (arg-0 arg-1) 'erased))
(define IOC-45AsyncC-45Loop-case--runAsyncWith-2060 (lambda (arg-3 arg-4 arg-5 arg-6 arg-8) (let ((eff-0 (DataC-45LinearC-45Deferred-observeDeferredAs1 (let ((e-4 (vector-ref arg-8 2))) e-4) (let ((e-2 (vector-ref arg-8 0))) e-2) (lambda (u--o) (lambda (eta-0) ((arg-4 u--o) eta-0))) 'erased))) (let ((e-1 (car arg-6))) (((e-1 arg-3) (vector arg-8 0 arg-5 '())) 'erased)))))
(define IOC-45AsyncC-45Loop-runAsyncWith (lambda (arg-3 arg-4 arg-5 arg-6 ext-0) (IOC-45AsyncC-45Loop-case--runAsyncWith-2060 arg-4 arg-6 arg-5 arg-3 (IOC-45AsyncC-45Loop-newFiber ext-0))))
(define DataC-45LinearC-45Traverse1-traverse1_Vect (lambda (arg-3 arg-4 arg-5) (if (null? arg-4) 'erased (let ((e-3 (car arg-4))) (let ((e-4 (cdr arg-4))) (let ((eff-0 ((arg-3 e-3) arg-5))) (DataC-45LinearC-45Traverse1-traverse1_Vect arg-3 e-4 'erased)))))))
(define IOC-45AsyncC-45LoopC-45Posix-stop (lambda (arg-0 ext-0) (DataC-45LinearC-45Traverse1-traverse1_Vect (lambda (u--w) (lambda (eta-0) (set-box! (let ((e-2 (vector-ref u--w 2))) e-2) 0))) (let ((e-3 (vector-ref arg-0 3))) e-3) ext-0)))
(define PreludeC-45IO-threadWait (lambda (arg-0 ext-0) (PreludeC-45IO-prim__threadWait arg-0 ext-0)))
(define IOC-45AsyncC-45LoopC-45Posix-toIO (lambda (ext-0 ext-1) (PreludeC-45IO-u--map_Functor_IO (lambda (eta-0) 'erased) (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (ext-0 eta-0))) ext-1)))
(define System-usleep (lambda (arg-1 arg-2 arg-3) (let ((e-2 (cdr arg-1))) ((e-2 'erased) (lambda (eta-0) (System-prim__usleep arg-2 eta-0))))))
(define IOC-45AsyncC-45LoopC-45Posix-app (lambda (arg-0 arg-1 arg-2 arg-3 ext-0) (let ((act-1 (IOC-45AsyncC-45LoopC-45Posix-toIO (lambda (eta-0) (SystemC-45PosixC-45SignalC-45Struct-withSignals arg-1 (lambda (u--p) (lambda (es-13228) (lambda (conArg-13229) (lambda (u--t) (let ((eff-0 (SystemC-45PosixC-45SignalC-45Prim-prim__sigprocmask1 0 u--p u--t))) (vector 1 'erased 'erased)))))) 0 eta-0)) ext-0))) (let ((act-2 (IOC-45AsyncC-45LoopC-45Poller-dieOnErr (lambda (eta-0) (SystemC-45PosixC-45FileC-45Prim-addFlags (lambda (eta-1) eta-1) 0 2048 0 eta-0)) ext-0))) (let ((act-3 ((IOC-45AsyncC-45LoopC-45Posix-mkThreadPool arg-0 arg-2) ext-0))) (let ((act-4 (IOC-45AsyncC-45Loop-runAsyncWith csegen-129 (DataC-45Vect-head (let ((e-3 (vector-ref act-3 3))) e-3)) arg-3 (lambda (_-3562) (lambda (eta-0) (IOC-45AsyncC-45LoopC-45Posix-stop act-3 eta-0))) ext-0))) (let ((act-5 (IOC-45AsyncC-45LoopC-45Posix-loop (DataC-45Vect-head (let ((e-3 (vector-ref act-3 3))) e-3)) IOC-45AsyncC-45LoopC-45Posix-POLL_ITER ext-0))) (let ((act-6 (((PreludeC-45Interfaces-traverse_ csegen-70 csegen-150 (lambda (u--x) (lambda (eta-0) (PreludeC-45IO-threadWait u--x eta-0)))) (let ((e-1 (vector-ref act-3 1))) e-1)) ext-0))) (let ((act-7 (((PreludeC-45Interfaces-traverse_ csegen-70 csegen-150 (lambda (u--w) (lambda (eta-0) (IOC-45AsyncC-45LoopC-45Posix-release u--w eta-0)))) (let ((e-3 (vector-ref act-3 3))) e-3)) ext-0))) (let ((act-8 (PreludeC-45IO-threadWait (let ((e-2 (vector-ref act-3 2))) e-2) ext-0))) ((System-usleep csegen-77 (blodwen-toSignedInt 100 63) 'erased) ext-0)))))))))))
(define PreludeC-45EqOrd-u--C-47C-61_Eq_Int (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Int arg-0 arg-1))) (cond ((equal? sc0 1) 0) (else 1)))))
(define System-getEnv (lambda (arg-1 arg-2) (let ((e-1 (car arg-1))) (let ((e-4 (vector-ref e-1 1))) ((((e-4 'erased) 'erased) (let ((e-6 (cdr arg-1))) ((e-6 'erased) (lambda (eta-0) (System-prim__getEnv arg-2 eta-0))))) (lambda (u--env) (let ((sc1 (PreludeC-45EqOrd-u--C-47C-61_Eq_Int (PrimIO-prim__nullAnyPtr u--env) (blodwen-toSignedInt 0 63)))) (cond ((equal? sc1 1) (let ((e-7 (car arg-1))) (let ((e-10 (vector-ref e-7 0))) (let ((e-12 (vector-ref e-10 1))) ((e-12 'erased) '()))))) (else (let ((e-7 (car arg-1))) (let ((e-10 (vector-ref e-7 0))) (let ((e-12 (vector-ref e-10 1))) ((e-12 'erased) (box (PreludeC-45IO-prim__getString u--env)))))))))))))))
(define IOC-45AsyncC-45LoopC-45Posix-asyncThreads (lambda (ext-0) (let ((act-1 ((System-getEnv csegen-77 "IDRIS2_ASYNC_THREADS") ext-0))) (let ((sc0 (PreludeC-45Types-u--map_Functor_Maybe (lambda (eta-0) (PreludeC-45Types-prim__integerToNat (cast-string-int eta-0))) act-1))) (if (null? sc0) 2 (let ((e-1 (unbox sc0))) (cond ((equal? e-1 0) 2)(else (let ((e-2 (- e-1 1))) (+ e-2 1))))))))))
(define IOC-45AsyncC-45LoopC-45Poller-case--cleanup-13795 (lambda (arg-1 arg-2 arg-3) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-2 arg-3 (DataC-45SortedMap-delete arg-1 arg-3)))) (cond ((equal? eff-0 1) 'erased)(else (IOC-45AsyncC-45LoopC-45Poller-cleanup arg-2 arg-1 'erased))))))
(define IOC-45AsyncC-45LoopC-45Poller-cleanup (lambda (arg-0 arg-1 arg-2) (IOC-45AsyncC-45LoopC-45Poller-case--cleanup-13795 arg-1 arg-0 (unbox arg-0))))
(define IOC-45AsyncC-45LoopC-45Poller-case--insrt-13881 (lambda (arg-1 arg-2 arg-3 arg-4 arg-5) (let ((eff-0 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-4 arg-5 (DataC-45SortedMap-insert arg-3 (cons arg-2 arg-1) arg-5)))) (cond ((equal? eff-0 1) 'erased)(else (IOC-45AsyncC-45LoopC-45Poller-cleanup arg-4 arg-3 'erased))))))
(define IOC-45AsyncC-45LoopC-45Poller-insrt (lambda (arg-0 arg-1 arg-2 arg-3 arg-4) (IOC-45AsyncC-45LoopC-45Poller-case--insrt-13881 arg-3 arg-2 arg-1 arg-0 (unbox arg-0))))
(define IOC-45AsyncC-45InternalC-45Ref-once (lambda (arg-0 arg-1 arg-2) (let ((eff-0 (unbox arg-0))) (cond ((equal? eff-0 1) (let ((eff-1 (DataC-45LinearC-45Ref1-prim__casWrite 'erased arg-0 1 0))) (cond ((equal? eff-1 1) (arg-1 'erased))(else (IOC-45AsyncC-45InternalC-45Ref-once arg-0 arg-1 'erased)))))(else 'erased)))))
(define DataC-45LinearC-45Token-when1 (lambda (arg-1 arg-2 arg-3) (cond ((equal? arg-1 1) ((arg-2) arg-3)) (else 'erased))))
(define IOC-45AsyncC-45LoopC-45Poller-case--pollFileImpl-14100 (lambda (arg-0 arg-1 arg-2 arg-3 arg-4 arg-6) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Poller-insrt arg-0 arg-1 arg-2 (lambda (eta-0) (lambda (eta-1) (IOC-45AsyncC-45InternalC-45Ref-once arg-6 (lambda (eta-2) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Poller-cleanup arg-0 arg-1 eta-2))) (let ((eff-1 ((arg-4 (vector 1 eta-0)) 'erased))) (DataC-45LinearC-45Token-when1 arg-3 (lambda () (lambda (eta-3) (let ((eff-2 (SystemC-45PosixC-45FileC-45Prim-prim__close arg-1 eta-3))) 'erased))) 'erased)))) eta-1))) 'erased))) (lambda (eta-0) (IOC-45AsyncC-45InternalC-45Ref-once arg-6 (lambda (eta-1) (IOC-45AsyncC-45LoopC-45Poller-cleanup arg-0 arg-1 eta-1)) eta-0)))))
(define IOC-45AsyncC-45LoopC-45Poller-pollFileImpl (lambda (arg-0 arg-1 arg-2 arg-3 arg-4 arg-5) (IOC-45AsyncC-45LoopC-45Poller-case--pollFileImpl-14100 arg-0 arg-1 arg-2 arg-3 arg-4 (box 1))))
(define SystemC-45Clock-makeDuration (lambda (ext-0 ext-1) (vector 2 ext-0 ext-1)))
(define SystemC-45Clock-nanoseconds (lambda (arg-1) (let ((e-2 (vector-ref arg-1 2))) e-2)))
(define SystemC-45Clock-seconds (lambda (arg-1) (let ((e-1 (vector-ref arg-1 1))) e-1)))
(define IOC-45AsyncC-45LoopC-45Poller-case--handleEvs-13537 (lambda (arg-0 arg-1 arg-2 arg-3 arg-5) (if (null? arg-5) (IOC-45AsyncC-45LoopC-45Poller-handleEvs arg-0 arg-3 'erased) (let ((e-5 (unbox arg-5))) (let ((e-10 (cdr e-5))) (let ((eff-0 ((e-10 arg-1) 'erased))) (IOC-45AsyncC-45LoopC-45Poller-handleEvs arg-0 arg-3 'erased)))))))
(define IOC-45AsyncC-45LoopC-45Poller-handleEvs (lambda (arg-0 arg-1 arg-2) (if (null? arg-1) 'erased (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (let ((e-4 (car e-2))) (let ((e-5 (cdr e-2))) (IOC-45AsyncC-45LoopC-45Poller-case--handleEvs-13537 arg-0 e-5 e-4 e-3 (let ((eff-0 (unbox arg-0))) (DataC-45SortedMap-lookup e-4 eff-0))))))))))
(define PreludeC-45TypesC-45List-lengthPlus (lambda (arg-1 arg-2) (if (null? arg-2) arg-1 (let ((e-3 (cdr arg-2))) (PreludeC-45TypesC-45List-lengthPlus (+ arg-1 1) e-3)))))
(define PreludeC-45TypesC-45List-lengthTR (lambda (ext-0) (PreludeC-45TypesC-45List-lengthPlus 0 ext-0)))
(define SystemC-45PosixC-45PollC-45Struct-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32pollResultsC-44go-12949 (lambda (arg-1 arg-2 arg-3 arg-6 arg-7 arg-9 arg-11) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 arg-11 0))) (cond ((equal? sc0 1) (SystemC-45PosixC-45PollC-45Struct-n--8252-12863-u--go arg-1 arg-2 arg-6 arg-3 'erased)) (else (SystemC-45PosixC-45PollC-45Struct-n--8252-12863-u--go arg-1 arg-2 (cons (cons arg-9 arg-11) arg-6) arg-3 'erased))))))
(define SystemC-45PosixC-45PollC-45Struct-case--pollResultsC-44go-12895 (lambda (arg-1 arg-2 arg-3 arg-6 arg-7) (let ((eff-0 (SystemC-45PosixC-45PollC-45Struct-prim__get_pollfd_fd arg-7 'erased))) (SystemC-45PosixC-45PollC-45Struct-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32pollResultsC-44go-12949 arg-1 arg-2 arg-3 arg-6 arg-7 eff-0 (SystemC-45PosixC-45PollC-45Struct-prim__get_pollfd_revents arg-7 'erased)))))
(define SystemC-45PosixC-45PollC-45Struct-n--8252-12863-u--go (lambda (arg-1 arg-2 arg-3 arg-4 arg-6) (cond ((equal? arg-4 0) arg-3)(else (let ((e-0 (- arg-4 1))) (SystemC-45PosixC-45PollC-45Struct-case--pollResultsC-44go-12895 arg-1 arg-2 e-0 arg-3 (DataC-45CC-45Array-prim__inc_ptr arg-2 (blodwen-toUnsignedInt e-0 32) 8)))))))
(define SystemC-45PosixC-45PollC-45Struct-pollResults (lambda (arg-1 arg-2 ext-0) (SystemC-45PosixC-45PollC-45Struct-n--8252-12863-u--go arg-1 arg-2 '() arg-1 ext-0)))
(define SystemC-45PosixC-45PollC-45Prim-poll (lambda (arg-0 arg-1 arg-2 arg-4 arg-5) (let ((eff-0 (SystemC-45PosixC-45PollC-45Prim-prim__poll arg-1 (blodwen-toUnsignedInt arg-0 32) arg-2 arg-5))) (cond ((equal? eff-0 0) (vector 1 '() 'erased))(else (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Int32 eff-0 0))) (cond ((equal? sc0 1) (vector 0 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-4 (blodwen-toUnsignedInt (bs- 0 eff-0 31) 32)) 'erased)) (else (let ((eff-1 (SystemC-45PosixC-45PollC-45Struct-pollResults arg-0 arg-1 'erased))) (vector 1 eff-1 'erased))))))))))
(define SystemC-45PosixC-45PollC-45Struct-case--writeFilesC-44go-13103 (lambda (arg-1 arg-2 arg-3 arg-4 arg-5 arg-7 arg-8) (let ((eff-0 ((let ((eff-0 (let ((e-0 (car arg-4))) e-0))) (lambda (eta-0) (SystemC-45PosixC-45PollC-45Struct-prim__set_pollfd_fd arg-8 eff-0 eta-0))) 'erased))) (let ((eff-1 ((let ((eff-1 (let ((e-1 (cdr arg-4))) e-1))) (lambda (eta-0) (SystemC-45PosixC-45PollC-45Struct-prim__set_pollfd_events arg-8 eff-1 eta-0))) 'erased))) (SystemC-45PosixC-45PollC-45Struct-n--8507-13075-u--go arg-1 arg-2 arg-3 (+ arg-7 1) arg-5 'erased)))))
(define SystemC-45PosixC-45PollC-45Struct-n--8507-13075-u--go (lambda (arg-1 arg-2 arg-3 arg-4 arg-5 arg-6) (cond ((equal? arg-3 0) 'erased)(else (let ((e-0 (- arg-3 1))) (if (null? arg-5) 'erased (let ((e-2 (car arg-5))) (let ((e-3 (cdr arg-5))) (SystemC-45PosixC-45PollC-45Struct-case--writeFilesC-44go-13103 arg-1 arg-2 e-0 e-2 e-3 arg-4 (DataC-45CC-45Array-prim__inc_ptr arg-2 (blodwen-toUnsignedInt arg-4 32) 8))))))))))
(define SystemC-45PosixC-45PollC-45Struct-writeFiles (lambda (arg-1 arg-2 ext-0 ext-1) (SystemC-45PosixC-45PollC-45Struct-n--8507-13075-u--go arg-1 arg-2 arg-1 0 ext-0 ext-1)))
(define SystemC-45PosixC-45Errno-case--withCArray-5033 (lambda (arg-2 arg-4 arg-6 arg-7 arg-8) (let ((sc0 ((((arg-6 arg-8) 'erased) arg-2) 'erased))) (case (vector-ref sc0 0) ((1) (let ((e-3 (vector-ref sc0 1))) (let ((e-4 (vector-ref sc0 2))) (let ((eff-0 (DataC-45CC-45Struct-prim__free arg-8 e-4))) (vector 1 e-3 'erased))))) (else (let ((e-8 (vector-ref sc0 1))) (let ((e-9 (vector-ref sc0 2))) (let ((eff-0 (DataC-45CC-45Struct-prim__free arg-8 e-9))) (vector 0 e-8 'erased)))))))))
(define SystemC-45PosixC-45PollC-45Prim-pollList (lambda (arg-0 arg-1 arg-3 ext-0) (SystemC-45PosixC-45Errno-case--withCArray-5033 arg-3 (PreludeC-45TypesC-45List-lengthTR arg-0) (lambda (u--arr) (lambda (es-12653) (lambda (conArg-12654) (lambda (u--t) (let ((eff-0 (SystemC-45PosixC-45PollC-45Struct-writeFiles (PreludeC-45TypesC-45List-lengthTR arg-0) u--arr arg-0 u--t))) (SystemC-45PosixC-45PollC-45Prim-poll (PreludeC-45TypesC-45List-lengthTR arg-0) u--arr arg-1 conArg-12654 'erased)))))) 8 (DataC-45CC-45Struct-prim__malloc (bu* (blodwen-toUnsignedInt (PreludeC-45TypesC-45List-lengthTR arg-0) 32) 8 32)))))
(define IOC-45AsyncC-45LoopC-45Poller-case--pollWaitImpl-13633 (lambda (arg-0 arg-2 arg-3 arg-4) (let ((u--pairs (PreludeC-45TypesC-45List-mapAppend '() (lambda (lamc-0) (let ((e-2 (car lamc-0))) (let ((e-3 (cdr lamc-0))) (let ((e-6 (car e-3))) (cons e-2 e-6))))) (DataC-45SortedMap-toList arg-4)))) (let ((eff-0 (IOC-45AsyncC-45LoopC-45Poller-dieOnErr (lambda (eta-0) (SystemC-45PosixC-45PollC-45Prim-pollList u--pairs (blodwen-toSignedInt arg-3 31) 0 eta-0)) 'erased))) (IOC-45AsyncC-45LoopC-45Poller-handleEvs arg-0 eff-0 'erased)))))
(define IOC-45AsyncC-45LoopC-45Poller-pollWaitImpl (lambda (arg-0 arg-1 arg-2) (let ((u--ms (+ (* (SystemC-45Clock-seconds arg-1) 1000) (PreludeC-45Num-u--div_Integral_Integer (SystemC-45Clock-nanoseconds arg-1) 1000000)))) (IOC-45AsyncC-45LoopC-45Poller-case--pollWaitImpl-13633 arg-0 arg-1 u--ms (unbox arg-0)))))
(define IOC-45AsyncC-45LoopC-45Poller-case--pollImpl-13729 (lambda (arg-0 arg-2) (let ((sc0 (DataC-45SortedMap-u--null_Foldable_C-40SortedMapC-32C-36kC-41 arg-2))) (cond ((equal? sc0 1) 'erased) (else (IOC-45AsyncC-45LoopC-45Poller-pollWaitImpl arg-0 (SystemC-45Clock-makeDuration 0 0) 'erased))))))
(define IOC-45AsyncC-45LoopC-45Poller-pollImpl (lambda (arg-0 arg-1) (IOC-45AsyncC-45LoopC-45Poller-case--pollImpl-13729 arg-0 (unbox arg-0))))
(define IOC-45AsyncC-45LoopC-45Poller-posixPoller (lambda (arg-0) (let ((eff-0 (box csegen-221))) (vector (lambda (eta-0) (IOC-45AsyncC-45LoopC-45Poller-pollImpl eff-0 eta-0)) (lambda (eta-0) (lambda (eta-1) (IOC-45AsyncC-45LoopC-45Poller-pollWaitImpl eff-0 eta-0 eta-1))) (lambda (eta-0) 'erased) (lambda (eta-0) (lambda (eta-1) (lambda (eta-2) (lambda (eta-3) (lambda (eta-4) (IOC-45AsyncC-45LoopC-45Poller-pollFileImpl eff-0 eta-0 eta-1 eta-2 eta-3 eta-4))))))))))
(define IOC-45AsyncC-45LoopC-45SignalST-n--4569-929-u--go (lambda (arg-1 arg-2 arg-3 arg-4 arg-5 arg-6) (if (null? arg-5) arg-6 (let ((e-2 (car arg-5))) (let ((e-3 (cdr arg-5))) (let ((sc1 (DataC-45SortedMap-lookup e-2 arg-6))) (if (null? sc1) (IOC-45AsyncC-45LoopC-45SignalST-n--4569-929-u--go arg-1 arg-2 arg-3 arg-4 e-3 (DataC-45SortedMap-insert e-2 (cons (cons arg-4 arg-1) '()) arg-6)) (let ((e-4 (unbox sc1))) (IOC-45AsyncC-45LoopC-45SignalST-n--4569-929-u--go arg-1 arg-2 arg-3 arg-4 e-3 (DataC-45SortedMap-insert e-2 (cons (cons arg-4 arg-1) e-4) arg-6))))))))))
(define IOC-45AsyncC-45LoopC-45SignalST-case--await_-1032 (lambda (arg-1 arg-2 arg-3 arg-4) (let ((e-4 (car arg-4))) (let ((e-5 (cdr arg-4))) (let ((eff-0 (set-box! arg-3 (cons (+ e-4 1) (IOC-45AsyncC-45LoopC-45SignalST-n--4569-929-u--go arg-1 arg-2 arg-3 e-4 arg-2 e-5))))) e-4)))))
(define IOC-45AsyncC-45LoopC-45SignalST-await_ (lambda (arg-0 arg-1 arg-2 arg-3) (IOC-45AsyncC-45LoopC-45SignalST-case--await_-1032 arg-2 arg-1 arg-0 (unbox arg-0))))
(define PreludeC-45Types-u--C-47C-61_Eq_Nat (lambda (arg-0 arg-1) (let ((sc0 (or (and (= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 1) 0) (else 1)))))
(define IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32drop_-1158 (lambda (arg-0 arg-1 arg-2 arg-3 arg-4 arg-5 arg-6) (if (null? arg-6) (IOC-45AsyncC-45LoopC-45SignalST-drop_ arg-1 arg-4 (cons arg-3 (DataC-45SortedMap-delete arg-0 arg-2))) (IOC-45AsyncC-45LoopC-45SignalST-drop_ arg-1 arg-4 (cons arg-3 (DataC-45SortedMap-insert arg-0 arg-6 arg-2))))))
(define IOC-45AsyncC-45LoopC-45SignalST-case--drop_-1109 (lambda (arg-0 arg-1 arg-2 arg-3 arg-4 arg-5) (if (null? arg-5) (IOC-45AsyncC-45LoopC-45SignalST-drop_ arg-1 arg-4 (cons arg-3 arg-2)) (let ((e-2 (unbox arg-5))) (IOC-45AsyncC-45LoopC-45SignalST-case--caseC-32blockC-32inC-32drop_-1158 arg-0 arg-1 arg-2 arg-3 arg-4 e-2 (PreludeC-45TypesC-45List-filterAppend '() (lambda (eta-0) (PreludeC-45Types-u--C-47C-61_Eq_Nat arg-4 (Builtin-fst eta-0))) e-2))))))
(define IOC-45AsyncC-45LoopC-45SignalST-drop_ (lambda (arg-0 arg-1 arg-2) (if (null? arg-0) arg-2 (let ((e-2 (car arg-0))) (let ((e-3 (cdr arg-0))) (let ((e-4 (car arg-2))) (let ((e-5 (cdr arg-2))) (IOC-45AsyncC-45LoopC-45SignalST-case--drop_-1109 e-2 e-3 e-5 e-4 arg-1 (DataC-45SortedMap-lookup e-2 e-5)))))))))
(define IOC-45AsyncC-45LoopC-45SignalST-dropRef (lambda (arg-0 arg-1 arg-2 arg-3) (let ((eff-0 (unbox arg-0))) (set-box! arg-0 (IOC-45AsyncC-45LoopC-45SignalST-drop_ arg-1 arg-2 eff-0)))))
(define IOC-45AsyncC-45LoopC-45SignalST-await (lambda (arg-0 arg-1 arg-2 arg-3) (let ((eff-0 (IOC-45AsyncC-45LoopC-45SignalST-await_ arg-0 arg-1 arg-2 arg-3))) (lambda (eta-0) (IOC-45AsyncC-45LoopC-45SignalST-dropRef arg-0 arg-1 eff-0 eta-0)))))
(define IOC-45AsyncC-45Signal-awaitSignals (lambda (arg-2 arg-3 arg-4) (vector 0 (vector 8 ) (lambda (u--ev) (vector 12 (lambda (u--cb) (((arg-3 u--ev) arg-4) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((1) (let ((e-2 (vector-ref lcase-0 1))) (u--cb (vector 1 e-2)))) (else (let ((e-5 (vector-ref lcase-0 1))) (u--cb (vector 0 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-2 e-5))))))))))))))
(define IOC-45AsyncC-45Util-cancel (lambda (arg-4) (vector 6 (lambda (u--t) (lambda (u--n) (vector 0 (vector 3 (lambda (eta-0) (PreludeC-45IO-u--map_Functor_IO (lambda (eta-1) (vector 1 eta-1)) (lambda (eta-1) (let ((e-2 (car arg-4))) (e-2 eta-1))) eta-0))) (lambda (_-10677) (vector 0 (vector 0 (vector 9 ) (lambda (u--me) (vector 12 (lambda (u--cb) (let ((e-3 (cdr arg-4))) ((e-3 u--me) (lambda (eta-0) (u--cb (vector 1 eta-0))))))))) (lambda (eta-0) (vector 1 'erased))))))))))
(define IOC-45AsyncC-45Util-listenPair (lambda (arg-6 arg-7) (vector 0 (vector 9 ) (lambda (u--me) (vector 12 (lambda (u--cb) (lambda (u--t) (let ((eff-0 (let ((e-3 (cdr arg-6))) (((e-3 u--me) (lambda (u--o) (u--cb (vector 1 (vector 0 (cons u--o arg-7)))))) u--t)))) (let ((eff-1 (let ((e-3 (cdr arg-7))) (((e-3 u--me) (lambda (u--o) (u--cb (vector 1 (vector 1 (cons arg-6 u--o)))))) 'erased)))) (lambda (t-0) (let ((eff-2 (eff-0 t-0))) (eff-1 'erased))))))))))))
(define IOC-45AsyncC-45Util-racePair (lambda (arg-6 arg-7) (vector 6 (lambda (u--t) (lambda (u--n) (vector 0 (vector 11 arg-6) (lambda (u--f1) (vector 0 (vector 11 arg-7) (lambda (u--f2) (vector 13 u--t u--n (IOC-45AsyncC-45Util-listenPair u--f1 u--f2)))))))))))
(define IOC-45AsyncC-45Util-race2 (lambda (arg-5 arg-6 arg-7 arg-8 arg-9) (vector 6 (lambda (u--t) (lambda (u--n) (vector 0 (vector 13 u--t u--n (IOC-45AsyncC-45Util-racePair arg-5 arg-6)) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (let ((e-8 (car e-2))) (let ((e-9 (cdr e-2))) (case (vector-ref e-8 0) ((0) (let ((e-3 (vector-ref e-8 1))) (vector 0 (IOC-45AsyncC-45Util-cancel e-9) (lambda (eta-0) (vector 1 (arg-7 e-3)))))) ((1) (let ((e-5 (vector-ref e-8 1))) (vector 0 (IOC-45AsyncC-45Util-cancel e-9) (lambda (_-10677) (vector 2 e-5))))) (else (vector 0 (vector 0 (IOC-45AsyncC-45Util-cancel e-9) (lambda (_-10677) (vector 0 (vector 9 ) (lambda (u--me) (vector 12 (lambda (u--cb) (let ((e-3 (cdr e-9))) ((e-3 u--me) (lambda (eta-0) (u--cb (vector 1 eta-0))))))))))) (lambda (lcase-1) (case (vector-ref lcase-1 0) ((0) (let ((e-3 (vector-ref lcase-1 1))) (vector 1 (arg-8 e-3)))) ((1) (let ((e-5 (vector-ref lcase-1 1))) (vector 2 e-5))) (else (vector 1 (arg-9)))))))))))) (else (let ((e-5 (vector-ref lcase-0 1))) (let ((e-12 (car e-5))) (let ((e-13 (cdr e-5))) (case (vector-ref e-13 0) ((0) (let ((e-2 (vector-ref e-13 1))) (vector 0 (IOC-45AsyncC-45Util-cancel e-12) (lambda (eta-0) (vector 1 (arg-8 e-2)))))) ((1) (let ((e-6 (vector-ref e-13 1))) (vector 0 (IOC-45AsyncC-45Util-cancel e-12) (lambda (_-10677) (vector 2 e-6))))) (else (vector 0 (vector 0 (IOC-45AsyncC-45Util-cancel e-12) (lambda (_-10677) (vector 0 (vector 9 ) (lambda (u--me) (vector 12 (lambda (u--cb) (let ((e-3 (cdr e-12))) ((e-3 u--me) (lambda (eta-0) (u--cb (vector 1 eta-0))))))))))) (lambda (lcase-1) (case (vector-ref lcase-1 0) ((0) (let ((e-2 (vector-ref lcase-1 1))) (vector 1 (arg-7 e-2)))) ((1) (let ((e-6 (vector-ref lcase-1 1))) (vector 2 e-6))) (else (vector 1 (arg-9))))))))))))))))))))
(define IOC-45AsyncC-45Util-race (lambda (arg-3 arg-4) (if (null? arg-4) (vector 1 (arg-3)) (let ((e-2 (car arg-4))) (let ((e-3 (cdr arg-4))) (if (null? e-3) e-2 (IOC-45AsyncC-45Util-race2 e-2 (IOC-45AsyncC-45Util-race arg-3 e-3) (lambda (eta-0) eta-0) (lambda (eta-0) eta-0) arg-3)))))))
(define IOC-45AsyncC-45LoopC-45Posix-n--12782-3714-u--cprog (lambda (arg-0 arg-1 arg-2) (IOC-45AsyncC-45Util-race (lambda () 'erased) (cons arg-2 (cons (ControlC-45MonadC-45MErr-handleErrors csegen-16 (lambda (eta-0) (vector 1 'erased)) (vector 0 (vector 0 (IOC-45AsyncC-45Signal-awaitSignals 0 (lambda (arg-880) (lambda (arg-883) (lambda (arg-886) (lambda (eta-0) (IOC-45AsyncC-45LoopC-45SignalST-await (let ((e-8 (vector-ref arg-880 8))) e-8) arg-883 (lambda (eta-1) (arg-886 (vector 1 eta-1))) eta-0))))) (PreludeC-45Types-u--pure_Applicative_List 2)) (lambda (eta-0) (vector 1 'erased))) (lambda (_-10677) (vector 1 'erased)))) '())))))
(define IOC-45AsyncC-45LoopC-45Posix-simpleApp (lambda (arg-0 arg-1 arg-2 ext-0) (let ((act-1 (IOC-45AsyncC-45LoopC-45Posix-asyncThreads ext-0))) (IOC-45AsyncC-45LoopC-45Posix-app act-1 arg-0 (lambda (eta-0) (IOC-45AsyncC-45LoopC-45Poller-posixPoller eta-0)) (IOC-45AsyncC-45LoopC-45Posix-n--12782-3714-u--cprog arg-0 arg-1 arg-2) ext-0))))
(define FSC-45Scope-case--combineInterrupts-4755 (lambda (arg-3 arg-4 arg-6) (let ((eff-0 (let ((eff-0 (DataC-45LinearC-45Unique-token1 'erased))) (DataC-45LinearC-45Deferred-observeDeferredAs1 arg-3 eff-0 (lambda (_-4780) (lambda (eta-0) (DataC-45LinearC-45Deferred-putDeferred1 arg-6 'erased eta-0))) 'erased)))) (let ((eff-1 (let ((eff-1 (DataC-45LinearC-45Unique-token1 'erased))) (DataC-45LinearC-45Deferred-observeDeferredAs1 arg-4 eff-1 (lambda (_-4819) (lambda (eta-0) (DataC-45LinearC-45Deferred-putDeferred1 arg-6 'erased eta-0))) 'erased)))) (cons (box arg-6) (cons (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (let ((eff-2 (eff-0 eta-0))) (vector 1 eff-2 'erased))))) (cons (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (let ((eff-2 (eff-1 eta-0))) (vector 1 eff-2 'erased))))) '())))))))
(define FSC-45Scope-u--combineInterrupts_Target_World_C-40AsyncC-32C-36eC-41 (lambda (arg-1 arg-2 arg-3) (if (null? arg-1) (cons arg-2 '()) (if (null? arg-2) (cons arg-1 '()) (let ((e-2 (unbox arg-1))) (let ((e-5 (unbox arg-2))) (FSC-45Scope-case--combineInterrupts-4755 e-2 e-5 (box csegen-173))))))))
(define FSC-45Scope-u--isInterrupted_Target_World_C-40AsyncC-32C-36eC-41 (lambda (arg-1) (if (null? arg-1) (vector 1 0) (let ((e-3 (unbox arg-1))) (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (let ((eff-0 (let ((eff-0 (unbox e-3))) (case (vector-ref eff-0 0) ((0) 1)(else 0))))) (vector 1 eff-0 'erased)))))))))
(define FSC-45Scope-u--raceInterrupt_Target_World_C-40AsyncC-32C-36eC-41 (lambda (arg-3 arg-4) (if (null? arg-3) (vector 0 (vector 7 arg-4) (lambda (eta-0) (vector 1 (ControlC-45MonadC-45MCancel-toOutcome eta-0)))) (let ((e-3 (unbox arg-3))) (vector 0 (IOC-45AsyncC-45Util-racePair arg-4 (vector 0 (vector 9 ) (lambda (u--me) (vector 12 (lambda (u--cb) (lambda (eta-0) (DataC-45LinearC-45Deferred-observeDeferredAs1 e-3 u--me (lambda (eta-1) (u--cb (vector 1 eta-1))) eta-0))))))) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (let ((e-8 (car e-2))) (let ((e-9 (cdr e-2))) (vector 0 (IOC-45AsyncC-45Util-cancel e-9) (lambda (eta-0) (vector 1 e-8))))))) (else (let ((e-5 (vector-ref lcase-0 1))) (let ((e-12 (car e-5))) (vector 0 (IOC-45AsyncC-45Util-cancel e-12) (lambda (eta-0) (vector 1 (vector 2 ))))))))))))))
(define Main-runProg (lambda (arg-0 ext-0) (IOC-45AsyncC-45LoopC-45Posix-simpleApp (cons 2 '()) 0 (FSC-45Core-mpull (vector csegen-16 (lambda (u--es) (vector 4 )) (lambda (u--a) (lambda (u--es) (lambda (u--body) (vector 6 (lambda (u--t) (lambda (u--n) (u--body (lambda (es-5036) (lambda (a-5037) (lambda (eta-0) (vector 13 u--t u--n eta-0))))))))))) (lambda (u--a) (lambda (u--es) (lambda (arg-4914) (lambda (arg-4917) (vector 5 arg-4914 arg-4917)))))) (vector csegen-27 (lambda (u--x) (lambda (u--y) (lambda (eta-0) (FSC-45Scope-u--combineInterrupts_Target_World_C-40AsyncC-32C-36eC-41 u--x u--y eta-0)))) (lambda (arg-4305) (FSC-45Scope-u--isInterrupted_Target_World_C-40AsyncC-32C-36eC-41 arg-4305)) (lambda (u--a) (lambda (u--es) (lambda (arg-4314) (lambda (arg-4318) (FSC-45Scope-u--raceInterrupt_Target_World_C-40AsyncC-32C-36eC-41 arg-4314 arg-4318)))))) (cons (lambda (arg-8497) (lambda (arg-8500) 'erased)) 'erased) (ControlC-45MonadC-45MErr-handleErrors csegen-50 (lambda (eta-0) (DataC-45ListC-45QuantifiersC-45ExtraC-45Any-collapse (lambda (v-9726) (lambda (eta-1) eta-1)) (DataC-45ListC-45QuantifiersC-45ExtraC-45Any-hzipWith (lambda (v-5258) (lambda (eta-1) eta-1)) (cons (lambda (eta-1) (vector 3 (vector 0 (vector 3 (lambda (eta-2) (PreludeC-45IO-u--map_Functor_IO (lambda (eta-3) (vector 1 eta-3)) (lambda (eta-3) (let ((sc0 (SystemC-45PosixC-45FileC-45Prim-fwrite (lambda (eta-4) eta-4) 2 csegen-51 (string-append (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-4) eta-4) (cons (SystemC-45PosixC-45ErrnoC-45Type-errorText eta-1) (cons " (" (cons (SystemC-45PosixC-45ErrnoC-45Type-errorName eta-1) (cons ")" '()))))) "\xa;") 0 eta-3))) (case (vector-ref sc0 0) ((1) 'erased) (else 'erased)))) eta-2)))))) '()) eta-0))) arg-0)) ext-0)))
(define Main-addr (lambda (ext-0) (cons (cons 127 (cons 0 (cons 0 (cons 1 '())))) ext-0)))
(define FSC-45Resource-bracketWeak (lambda (arg-5 arg-6 arg-7) (vector 6 (vector 3 (vector 1 arg-5 arg-6)) arg-7)))
(define SystemC-45PosixC-45File-addFlags (lambda (arg-3 arg-4 arg-5 arg-6 arg-7) (let ((e-3 (cdr arg-6))) (((e-3 'erased) 'erased) (lambda (eta-0) (SystemC-45PosixC-45FileC-45Prim-addFlags arg-3 arg-4 arg-7 arg-5 eta-0))))))
(define SystemC-45PosixC-45SocketC-45Struct-ip4addr (lambda (arg-0) (let ((e-2 (car arg-0))) (let ((e-3 (cdr arg-0))) (let ((e-6 (car e-3))) (let ((e-7 (cdr e-3))) (let ((e-10 (car e-7))) (let ((e-11 (cdr e-7))) (let ((e-14 (car e-11))) (let ((e-15 (cdr e-11))) (blodwen-or (blodwen-or (blodwen-or (blodwen-bits-shl e-2 24 32) (blodwen-bits-shl e-6 16 32)) (blodwen-bits-shl e-10 8 32)) e-14)))))))))))
(define DataC-45CC-45Array-writeVect1 (lambda (arg-3 arg-4 arg-6 arg-7 arg-8 arg-9) (if (null? arg-7) 'erased (let ((e-3 (car arg-7))) (let ((e-4 (cdr arg-7))) (let ((eff-0 (((arg-6 (DataC-45CC-45Array-prim__inc_ptr arg-4 (blodwen-toUnsignedInt arg-8 32) arg-3)) e-3) arg-9))) (DataC-45CC-45Array-writeVect1 arg-3 arg-4 arg-6 e-4 (+ arg-8 1) 'erased)))))))
(define SystemC-45PosixC-45SocketC-45Struct-case--sockaddrIn6-6448 (lambda (arg-1 arg-2 arg-4) (let ((eff-0 (DataC-45CC-45Array-writeVect1 1 (SystemC-45PosixC-45SocketC-45Struct-prim__sockaddr_in6_addr arg-4) (lambda (eta-0) (lambda (eta-1) (lambda (eta-2) (DataC-45CC-45Deref-prim__set_bits8 eta-0 eta-1 eta-2)))) arg-2 0 'erased))) arg-4)))
(define SystemC-45PosixC-45SocketC-45Struct-sockaddrIn6 (lambda (arg-1 arg-2) (let ((e-0 (car arg-1))) (let ((e-1 (cdr arg-1))) (SystemC-45PosixC-45SocketC-45Struct-case--sockaddrIn6-6448 e-1 e-0 (SystemC-45PosixC-45SocketC-45Struct-prim__sockaddr_in6 e-1 arg-2))))))
(define SystemC-45PosixC-45SocketC-45Struct-sockaddr (lambda (arg-0 arg-1 ext-0) (cond ((equal? arg-0 0) (SystemC-45PosixC-45SocketC-45Struct-prim__sockaddr_un arg-1 ext-0)) ((equal? arg-0 1) (let ((e-0 (car arg-1))) (let ((e-1 (cdr arg-1))) (SystemC-45PosixC-45SocketC-45Struct-prim__sockaddr_in (SystemC-45PosixC-45SocketC-45Struct-ip4addr e-0) e-1 ext-0)))) (else (SystemC-45PosixC-45SocketC-45Struct-sockaddrIn6 arg-1 ext-0)))))
(define SystemC-45PosixC-45SocketC-45Struct-u--sizeof__SizeOf_C-40SSockaddrInC-32C-36sC-41 16)
(define SystemC-45PosixC-45SocketC-45Struct-u--sizeof__SizeOf_C-40SSockaddrIn6C-32C-36sC-41 28)
(define SystemC-45PosixC-45SocketC-45Struct-u--sizeof__SizeOf_C-40SSockaddrUnC-32C-36sC-41 110)
(define SystemC-45PosixC-45SocketC-45Struct-addrSize (lambda (arg-0) (cond ((equal? arg-0 0) SystemC-45PosixC-45SocketC-45Struct-u--sizeof__SizeOf_C-40SSockaddrUnC-32C-36sC-41) ((equal? arg-0 1) SystemC-45PosixC-45SocketC-45Struct-u--sizeof__SizeOf_C-40SSockaddrInC-32C-36sC-41) (else SystemC-45PosixC-45SocketC-45Struct-u--sizeof__SizeOf_C-40SSockaddrIn6C-32C-36sC-41))))
(define SystemC-45PosixC-45SocketC-45Struct-ptr (lambda (arg-0 arg-1) (cond ((equal? arg-0 0) arg-1) ((equal? arg-0 1) arg-1) (else arg-1))))
(define SystemC-45PosixC-45SocketC-45Prim-connect_ (lambda (arg-0 arg-1 arg-2 arg-4 ext-0) (SystemC-45PosixC-45Errno-case--toUnit-4051 arg-4 (lambda (eta-0) (SystemC-45PosixC-45SocketC-45Prim-prim__connect arg-1 (SystemC-45PosixC-45SocketC-45Struct-ptr arg-0 arg-2) (SystemC-45PosixC-45SocketC-45Struct-addrSize arg-0) eta-0)) (SystemC-45PosixC-45SocketC-45Prim-prim__connect arg-1 (SystemC-45PosixC-45SocketC-45Struct-ptr arg-0 arg-2) (SystemC-45PosixC-45SocketC-45Struct-addrSize arg-0) ext-0))))
(define SystemC-45PosixC-45SocketC-45Prim-case--connect-6220 (lambda (arg-0 arg-2 arg-4 arg-5 arg-6) (let ((sc0 (SystemC-45PosixC-45SocketC-45Prim-connect_ arg-0 arg-5 arg-6 arg-2 'erased))) (case (vector-ref sc0 0) ((1) (let ((e-3 (vector-ref sc0 1))) (let ((e-4 (vector-ref sc0 2))) (let ((eff-0 (DataC-45CC-45Struct-prim__free (SystemC-45PosixC-45SocketC-45Struct-ptr arg-0 arg-6) e-4))) (vector 1 e-3 'erased))))) (else (let ((e-8 (vector-ref sc0 1))) (let ((e-9 (vector-ref sc0 2))) (let ((eff-0 (DataC-45CC-45Struct-prim__free (SystemC-45PosixC-45SocketC-45Struct-ptr arg-0 arg-6) e-9))) (vector 0 e-8 'erased)))))))))
(define SystemC-45PosixC-45SocketC-45Prim-connect (lambda (arg-0 arg-1 arg-2 arg-4 arg-5) (SystemC-45PosixC-45SocketC-45Prim-case--connect-6220 arg-0 arg-4 arg-2 arg-1 (SystemC-45PosixC-45SocketC-45Struct-sockaddr arg-0 arg-2 arg-5))))
(define SystemC-45PosixC-45Socket-connect (lambda (arg-2 arg-3 arg-4 arg-5 arg-6) (let ((e-3 (cdr arg-3))) (((e-3 'erased) 'erased) (lambda (eta-0) (SystemC-45PosixC-45SocketC-45Prim-connect arg-4 arg-5 arg-6 arg-2 eta-0))))))
(define IOC-45AsyncC-45Posix-poll (lambda (arg-3 arg-4 arg-5 arg-6 arg-7) (vector 0 (vector 8 ) (lambda (u--st) (vector 12 (lambda (u--cb) (let ((e-2 (cdr arg-4))) (((((e-2 u--st) (arg-5 arg-6)) arg-7) 0) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((1) (let ((e-3 (vector-ref lcase-0 1))) (u--cb (vector 1 e-3)))) (else (let ((e-5 (vector-ref lcase-0 1))) (u--cb (vector 0 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-3 e-5)))))))))))))))
(define IOC-45AsyncC-45Socket-connectnb (lambda (arg-2 arg-3 arg-4 arg-5 arg-6) (vector 0 (vector 7 (SystemC-45PosixC-45Socket-connect 0 csegen-27 arg-4 arg-5 arg-6)) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (let ((e-10 (vector-ref e-2 1))) (let ((sc2 (let ((sc3 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 e-10 115))) (cond ((equal? sc3 1) 1) (else (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 e-10 11)))))) (cond ((equal? sc2 1) (vector 0 (IOC-45AsyncC-45Posix-poll arg-2 arg-3 (lambda (eta-0) eta-0) arg-5 4) (lambda (eta-0) (vector 1 'erased)))) (else (vector 2 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-2 e-10)))))))) (else (vector 1 'erased)))))))
(define SystemC-45PosixC-45SocketC-45Types-domainCode (lambda (arg-0) (cond ((equal? arg-0 0) 1) ((equal? arg-0 1) 2) (else 10))))
(define SystemC-45PosixC-45Errno-case--toVal-3852 (lambda (arg-2 arg-4 arg-5 arg-6) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Int32 arg-6 0))) (cond ((equal? sc0 1) (vector 0 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-2 (blodwen-toUnsignedInt (bs- 0 arg-6 31) 32)) 'erased)) (else (vector 1 (arg-5 arg-6) 'erased))))))
(define Main-connectTo (lambda (arg-0 arg-1 arg-2) (vector 0 (vector 0 (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (SystemC-45PosixC-45Errno-case--toVal-3852 0 (lambda (eta-1) (SystemC-45PosixC-45SocketC-45Prim-prim__socket (SystemC-45PosixC-45SocketC-45Types-domainCode arg-0) arg-1 eta-1)) (lambda (eta-1) (blodwen-toUnsignedInt eta-1 32)) (SystemC-45PosixC-45SocketC-45Prim-prim__socket (SystemC-45PosixC-45SocketC-45Types-domainCode arg-0) arg-1 eta-0))))) (lambda (u--sock) (vector 0 (SystemC-45PosixC-45File-addFlags (lambda (eta-0) eta-0) u--sock 0 csegen-27 2048) (lambda (_-10677) (vector 1 u--sock))))) (lambda (u--sock) (vector 0 (IOC-45AsyncC-45Socket-connectnb 0 csegen-81 arg-0 u--sock arg-2) (lambda (_-10677) (vector 1 u--sock)))))))
(define FSC-45Pull-flatMap (lambda (arg-5 arg-6) (vector 6 (vector 4 arg-5) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (vector 0 e-2))) (else (let ((e-5 (vector-ref lcase-0 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (vector 6 (arg-6 e-8) (lambda (_-10677) (FSC-45Pull-flatMap e-9 arg-6))))))))))))
(define SystemC-45PosixC-45PollC-45Types-hasEvent (lambda (arg-0 arg-1) (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 (blodwen-and arg-0 arg-1) arg-1)))
(define IOC-45AsyncC-45Posix-onEvent (lambda (arg-3 arg-4 arg-5 arg-6 arg-8 arg-9) (vector 0 (IOC-45AsyncC-45Posix-poll arg-3 arg-4 arg-5 arg-6 arg-8) (lambda (u--evt) (let ((sc0 (SystemC-45PosixC-45PollC-45Types-hasEvent u--evt arg-8))) (cond ((equal? sc0 1) arg-9) (else (vector 2 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-3 22)))))))))
(define IOC-45AsyncC-45Posix-writenb (lambda (arg-3 arg-4 arg-5 arg-6 arg-8 arg-9) (vector 0 (vector 7 (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult ((SystemC-45PosixC-45FileC-45Prim-write arg-5 arg-6 arg-8 arg-9 0) eta-0))))) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (let ((e-10 (vector-ref e-2 1))) (let ((sc2 (let ((sc3 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 e-10 11))) (cond ((equal? sc3 1) 1) (else (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 e-10 11)))))) (cond ((equal? sc2 1) (IOC-45AsyncC-45Posix-onEvent arg-3 arg-4 arg-5 arg-6 4 (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult ((SystemC-45PosixC-45FileC-45Prim-write arg-5 arg-6 arg-8 arg-9 arg-3) eta-0)))))) (else (vector 2 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-3 e-10)))))))) (else (let ((e-5 (vector-ref lcase-0 1))) (vector 1 e-5))))))))
(define IOC-45AsyncC-45Posix-n--7955-1816-u--go (lambda (arg-3 arg-4 arg-5 arg-6 arg-8 arg-9 arg-10) (if (null? arg-10) (vector 0 (IOC-45AsyncC-45Posix-writenb arg-3 arg-4 arg-5 arg-6 (lambda (eta-0) (vector 1 eta-0)) arg-10) (lambda (u--m) (IOC-45AsyncC-45Posix-n--7955-1816-u--go arg-3 arg-4 arg-5 arg-6 arg-8 arg-9 (DataC-45ByteString-drop (PreludeC-45Types-prim__integerToNat u--m) arg-10)))) (let ((e-0 (car arg-10))) (cond ((equal? e-0 0) (vector 1 'erased))(else (vector 0 (IOC-45AsyncC-45Posix-writenb arg-3 arg-4 arg-5 arg-6 (lambda (eta-0) (vector 1 eta-0)) arg-10) (lambda (u--m) (IOC-45AsyncC-45Posix-n--7955-1816-u--go arg-3 arg-4 arg-5 arg-6 arg-8 arg-9 (DataC-45ByteString-drop (PreludeC-45Types-prim__integerToNat u--m) arg-10))))))))))
(define IOC-45AsyncC-45Posix-n--7955-1817-u--goPtr (lambda (arg-3 arg-4 arg-5 arg-6 arg-8 arg-9 arg-10 arg-11) (cond ((equal? arg-11 0) (vector 1 'erased))(else (vector 0 (IOC-45AsyncC-45Posix-writenb arg-3 arg-4 arg-5 arg-6 (lambda (eta-0) (vector 0 eta-0)) (cons arg-11 arg-10)) (lambda (u--m) (IOC-45AsyncC-45Posix-n--7955-1817-u--goPtr arg-3 arg-4 arg-5 arg-6 arg-8 arg-9 (DataC-45CC-45Array-prim__inc_ptr arg-10 u--m 1) (bu- arg-11 u--m 32))))))))
(define IOC-45AsyncC-45Posix-fwritenb (lambda (arg-3 arg-4 arg-5 arg-6 arg-8 arg-9) (let ((sc0 (arg-8 arg-9))) (case (vector-ref sc0 0) ((0) (let ((e-2 (vector-ref sc0 1))) (let ((e-6 (car e-2))) (let ((e-7 (cdr e-2))) (IOC-45AsyncC-45Posix-n--7955-1817-u--goPtr arg-3 arg-4 arg-5 arg-6 arg-8 arg-9 e-7 e-6))))) (else (let ((e-5 (vector-ref sc0 1))) (IOC-45AsyncC-45Posix-n--7955-1816-u--go arg-3 arg-4 arg-5 arg-6 arg-8 arg-9 e-5)))))))
(define Main-handler (lambda (arg-2) (let ((e-4 (vector-ref arg-2 1))) (vector 2 (vector 0 e-4) (lambda () (vector 0 'erased))))))
(define DataC-45ByteString-nonEmpty (lambda (arg-0) (if (null? arg-0) (box arg-0) (let ((e-0 (car arg-0))) (cond ((equal? e-0 0) '())(else (box arg-0)))))))
(define FSC-45Pull-scanFull (lambda (arg-6 arg-7 arg-8 arg-9) (vector 6 (vector 4 arg-9) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (let ((sc1 (arg-8 arg-6))) (if (null? sc1) (vector 0 e-2) (let ((e-1 (unbox sc1))) (vector 2 e-1 (lambda () (vector 0 e-2)))))))) (else (let ((e-5 (vector-ref lcase-0 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (let ((sc2 ((arg-7 arg-6) e-8))) (let ((e-2 (car sc2))) (let ((e-3 (cdr sc2))) (if (null? e-2) (FSC-45Pull-scanFull e-3 arg-7 arg-8 e-9) (let ((e-1 (unbox e-2))) (vector 2 e-1 (lambda () (FSC-45Pull-scanFull e-3 arg-7 arg-8 e-9)))))))))))))))))
(define DataC-45BufferC-45Core-copy (lambda (arg-3 arg-4 arg-5 arg-6 arg-9 ext-0) (DataC-45BufferC-45Core-prim__copy arg-3 arg-4 arg-6 arg-9 arg-5 ext-0)))
(define DataC-45ByteVect-append (lambda (arg-0 arg-1 arg-2 arg-3) (let ((e-2 (car arg-2))) (let ((e-3 (cdr arg-2))) (let ((e-7 (car arg-3))) (let ((e-8 (cdr arg-3))) (let ((u--buf (DataC-45BufferC-45Core-alloc (+ arg-0 arg-1) (lambda (s-2224) (lambda (u--r) (lambda (u--t) (let ((eff-0 (DataC-45BufferC-45Core-copy e-2 e-3 0 arg-0 u--r u--t))) (let ((eff-1 (DataC-45BufferC-45Core-copy e-7 e-8 arg-0 arg-1 u--r 'erased))) u--r)))))))) (cons u--buf 0))))))))
(define DataC-45ByteString-append (lambda (arg-0 arg-1) (if (null? arg-0) (if (null? arg-1) (let ((e-0 (car arg-0))) (let ((e-1 (cdr arg-0))) (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (cons (+ e-0 e-2) (DataC-45ByteVect-append e-0 e-2 e-1 e-3)))))) (let ((e-4 (car arg-1))) (cond ((equal? e-4 0) arg-0)(else (let ((e-0 (car arg-0))) (let ((e-1 (cdr arg-0))) (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (cons (+ e-0 e-2) (DataC-45ByteVect-append e-0 e-2 e-1 e-3)))))))))) (let ((e-6 (car arg-0))) (cond ((equal? e-6 0) arg-1)(else (if (null? arg-1) (let ((e-0 (car arg-0))) (let ((e-1 (cdr arg-0))) (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (cons (+ e-0 e-2) (DataC-45ByteVect-append e-0 e-2 e-1 e-3)))))) (let ((e-4 (car arg-1))) (cond ((equal? e-4 0) arg-0)(else (let ((e-0 (car arg-0))) (let ((e-1 (cdr arg-0))) (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (cons (+ e-0 e-2) (DataC-45ByteVect-append e-0 e-2 e-1 e-3))))))))))))))))
(define DataC-45ByteVect-n--6825-3285-u--go (lambda (arg-0 arg-1 arg-2 arg-3) (cond ((equal? arg-2 0) arg-3)(else (let ((e-0 (- arg-2 1))) (let ((sc0 (let ((e-2 (car arg-1))) (let ((e-3 (cdr arg-1))) (DataC-45BufferC-45Core-prim__getByteOffset e-2 arg-3 e-3))))) (cond ((equal? sc0 10) arg-3)(else (DataC-45ByteVect-n--6825-3285-u--go arg-0 arg-1 e-0 (+ arg-3 1))))))))))
(define DataC-45ByteVect-findIndexOrLengthNL (lambda (arg-0 arg-1) (DataC-45ByteVect-n--6825-3285-u--go arg-0 arg-1 arg-0 0)))
(define FSC-45InternalC-45Bytes-ls (lambda (arg-0 arg-1 arg-2) (let ((sc0 (DataC-45ByteVect-breakRes arg-1 arg-2 (DataC-45ByteVect-findIndexOrLengthNL arg-1 arg-2)))) (let ((e-1 (vector-ref sc0 0))) (let ((e-2 (vector-ref sc0 1))) (let ((e-3 (vector-ref sc0 2))) (let ((e-4 (vector-ref sc0 3))) (cond ((equal? e-2 0) (cons (box (PreludeC-45TypesC-45SnocList-C-60C-62C-62 arg-0 '())) (cons e-1 e-3)))(else (let ((e-6 (- e-2 1))) (FSC-45InternalC-45Bytes-ls (cons arg-0 (cons e-1 e-3)) e-6 (DataC-45ByteVect-tail e-4))))))))))))
(define FSC-45InternalC-45Bytes-splitNL (lambda (arg-0 arg-1) (let ((e-0 (car arg-1))) (let ((e-1 (cdr arg-1))) (let ((sc1 (DataC-45ByteVect-breakRes e-0 e-1 (DataC-45ByteVect-findIndexOrLengthNL e-0 e-1)))) (let ((e-5 (vector-ref sc1 0))) (let ((e-2 (vector-ref sc1 1))) (let ((e-3 (vector-ref sc1 2))) (let ((e-4 (vector-ref sc1 3))) (cond ((equal? e-2 0) (cons '() (DataC-45ByteString-append arg-0 (cons e-5 e-3))))(else (let ((e-6 (- e-2 1))) (FSC-45InternalC-45Bytes-ls (cons '() (DataC-45ByteString-append arg-0 (cons e-5 e-3))) e-6 (DataC-45ByteVect-tail e-4))))))))))))))
(define FSC-45Bytes-lines (lambda (ext-0) (FSC-45Pull-scanFull (cons 0 DataC-45ByteVect-empty) (lambda (eta-0) (lambda (eta-1) (FSC-45InternalC-45Bytes-splitNL eta-0 eta-1))) (lambda (eta-0) (PreludeC-45Types-u--map_Functor_Maybe (lambda (arg-9951) (PreludeC-45Types-u--pure_Applicative_List arg-9951)) (DataC-45ByteString-nonEmpty eta-0))) ext-0)))
(define FSC-45Pull-mapMaybe (lambda (arg-5 arg-6) (vector 6 (vector 4 arg-6) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (vector 0 e-2))) (else (let ((e-5 (vector-ref lcase-0 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (let ((sc2 (arg-5 e-8))) (if (null? sc2) (FSC-45Pull-mapMaybe arg-5 e-9) (let ((e-1 (unbox sc2))) (vector 2 e-1 (lambda () (FSC-45Pull-mapMaybe arg-5 e-9)))))))))))))))
(define FSC-45Chunk-nel (lambda (arg-1) (if (null? arg-1) '() (box arg-1))))
(define FSC-45Chunk-mapMaybe (lambda (arg-5 ext-0) (FSC-45Pull-mapMaybe (lambda (eta-0) (FSC-45Chunk-nel (PreludeC-45TypesC-45List-mapMaybeAppend '() arg-5 eta-0))) ext-0)))
(define SystemC-45PosixC-45FileC-45Prim-case--caseC-32blockC-32inC-32allocRead-5570 (lambda (arg-1 arg-3 arg-5 arg-6 arg-7 arg-9) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Int64 arg-9 0))) (cond ((equal? sc0 1) (vector 0 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-3 (blodwen-toUnsignedInt (bs- 0 arg-9 63) 32)) 'erased)) (else (let ((eff-0 ((arg-1 (cons (blodwen-toUnsignedInt arg-9 32) arg-7)) 'erased))) (vector 1 eff-0 'erased)))))))
(define SystemC-45PosixC-45FileC-45Prim-case--allocRead-5542 (lambda (arg-1 arg-3 arg-5 arg-6 arg-7) (SystemC-45PosixC-45FileC-45Prim-case--caseC-32blockC-32inC-32allocRead-5570 arg-1 arg-3 arg-5 arg-6 arg-7 (((arg-5 arg-7) arg-6) 'erased))))
(define SystemC-45PosixC-45FileC-45Prim-read (lambda (arg-1 arg-2 arg-4 arg-5 arg-7 ext-0) (SystemC-45PosixC-45FileC-45Prim-case--allocRead-5542 arg-4 arg-7 (lambda (eta-0) (lambda (eta-1) (lambda (eta-2) (SystemC-45PosixC-45FileC-45Prim-prim__read (arg-1 arg-2) eta-0 eta-1 eta-2)))) arg-5 (DataC-45BufferC-45Core-prim__newBuf arg-5 ext-0))))
(define IOC-45AsyncC-45Posix-readnb (lambda (arg-3 arg-4 arg-5 arg-6 arg-8 arg-9) (vector 0 (vector 7 (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (SystemC-45PosixC-45FileC-45Prim-read arg-5 arg-6 arg-8 arg-9 0 eta-0))))) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (let ((e-10 (vector-ref e-2 1))) (let ((sc2 (let ((sc3 (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 e-10 11))) (cond ((equal? sc3 1) 1) (else (PreludeC-45EqOrd-u--C-61C-61_Eq_Bits32 e-10 11)))))) (cond ((equal? sc2 1) (IOC-45AsyncC-45Posix-onEvent arg-3 arg-4 arg-5 arg-6 1 (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (SystemC-45PosixC-45FileC-45Prim-read arg-5 arg-6 arg-8 arg-9 arg-3 eta-0)))))) (else (vector 2 (DataC-45ListC-45QuantifiersC-45Extra-inject arg-3 e-10)))))))) (else (let ((e-5 (vector-ref lcase-0 1))) (vector 1 e-5))))))))
(define FSC-45Pull-unfoldEvalMaybe (lambda (arg-3) (vector 6 (vector 3 (vector 0 arg-3)) (lambda (lcase-0) (if (null? lcase-0) (vector 0 'erased) (let ((e-2 (unbox lcase-0))) (vector 2 e-2 (lambda () (FSC-45Pull-unfoldEvalMaybe arg-3)))))))))
(define DataC-45ByteString-TotLength (lambda (arg-0) (if (null? arg-0) 0 (let ((e-2 (car arg-0))) (let ((e-3 (cdr arg-0))) (let ((e-4 (car e-2))) (+ e-4 (DataC-45ByteString-TotLength e-3))))))))
(define DataC-45ByteString-copyMany (lambda (arg-2 arg-3 arg-5 arg-6) (if (null? arg-2) 'erased (let ((e-2 (car arg-2))) (let ((e-3 (cdr arg-2))) (let ((e-4 (car e-2))) (let ((e-5 (cdr e-2))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (let ((eff-0 (DataC-45BufferC-45Core-copy e-8 e-9 arg-3 e-4 arg-5 arg-6))) (DataC-45ByteString-copyMany e-3 (+ arg-3 e-4) arg-5 'erased)))))))))))
(define DataC-45ByteVect-unsafeFreezeByteString (lambda (arg-0 arg-2 arg-3) (cons arg-0 (cons arg-2 0))))
(define DataC-45ByteString-fastConcat (lambda (arg-0) (if (null? arg-0) (cons 0 DataC-45ByteVect-empty) (let ((e-2 (car arg-0))) (let ((e-3 (cdr arg-0))) (if (null? e-3) e-2 (DataC-45BufferC-45Core-alloc (DataC-45ByteString-TotLength arg-0) (lambda (s-14559) (lambda (u--r) (lambda (u--t) (let ((eff-0 (DataC-45ByteString-copyMany arg-0 0 u--r u--t))) (DataC-45ByteVect-unsafeFreezeByteString (DataC-45ByteString-TotLength arg-0) u--r 'erased))))))))))))
(define DataC-45BufferC-45Mutable-writeList (lambda (arg-2 arg-3 arg-4 arg-5) (if (null? arg-3) 'erased (let ((e-2 (car arg-3))) (let ((e-3 (cdr arg-3))) (let ((eff-0 (DataC-45BufferC-45Core-prim__setByte arg-2 arg-4 e-2 arg-5))) (DataC-45BufferC-45Mutable-writeList arg-2 e-3 (+ arg-4 1) 'erased)))))))
(define DataC-45ByteVect-pack (lambda (arg-0) (cons (DataC-45BufferC-45Core-alloc (PreludeC-45TypesC-45List-lengthTR arg-0) (lambda (s-876) (lambda (u--r) (lambda (u--t) (let ((eff-0 (DataC-45BufferC-45Mutable-writeList u--r arg-0 0 u--t))) u--r))))) 0)))
(define FSC-45InternalC-45Bytes-nl (cons (PreludeC-45TypesC-45List-lengthTR (cons 10 '())) (DataC-45ByteVect-pack (cons 10 '()))))
(define FSC-45Bytes-unlines (lambda (ext-0) (FSC-45Pull-mapMaybe (lambda (eta-0) (box (DataC-45ByteString-fastConcat (PreludeC-45Types-listBind eta-0 (lambda (u--b) (cons u--b (cons FSC-45InternalC-45Bytes-nl '()))))))) ext-0)))
(define DataC-45ByteString-unsafeByteString (lambda (arg-0 arg-1) (cons arg-0 (cons arg-1 0))))
(define PreludeC-45Show-u--showPrec_Show_Double (lambda (ext-0 ext-1) (PreludeC-45Show-primNumShow (lambda (eta-0) (number->string eta-0)) ext-0 ext-1)))
(define PreludeC-45Show-u--show_Show_Double (lambda (arg-0) (PreludeC-45Show-u--showPrec_Show_Double (vector 0 ) arg-0)))
(define Main-echoClient (lambda (arg-0) (ControlC-45MonadC-45MErr-handleErrors csegen-50 (lambda (eta-0) (Main-handler eta-0)) (vector 7 '() (FSC-45Resource-bracketWeak (Main-connectTo 1 1 (Main-addr arg-0)) (lambda (u--cl) (vector 3 (lambda (eta-0) (PreludeC-45IO-u--map_Functor_IO (lambda (eta-1) (vector 1 eta-1)) (lambda (eta-1) (let ((eff-0 (SystemC-45PosixC-45FileC-45Prim-prim__close u--cl eta-1))) 'erased)) eta-0)))) (lambda (u--cl) (FSC-45Pull-mapMaybe (lambda (eta-0) (box (vector 1 eta-0))) (PreludeC-45Basics-flip (lambda (eta-0) (lambda (eta-1) (FSC-45Pull-flatMap eta-0 eta-1))) (lambda (_-1447) (FSC-45Bytes-unlines (FSC-45Pull-mapMaybe (lambda (eta-0) (box (PreludeC-45TypesC-45List-mapAppend '() (lambda (eta-1) (DataC-45ByteString-u--fromString_FromString_ByteString (PreludeC-45Show-u--show_Show_Double eta-1))) eta-0))) (FSC-45Chunk-mapMaybe (lambda (eta-0) (Main-toCelsius eta-0)) (FSC-45Bytes-lines (FSC-45Pull-unfoldEvalMaybe (vector 0 (IOC-45AsyncC-45Posix-readnb 0 csegen-81 (lambda (eta-0) eta-0) u--cl (lambda (eta-0) (lambda (eta-1) (let ((e-0 (car eta-0))) (let ((e-1 (cdr eta-0))) (DataC-45ByteString-unsafeByteString (PreludeC-45Types-prim__integerToNat e-0) e-1))))) 4095) (lambda (eta-0) (vector 1 (DataC-45ByteString-nonEmpty eta-0)))))))))) (vector 6 (vector 3 (vector 0 (IOC-45AsyncC-45Posix-fwritenb 0 csegen-81 (lambda (eta-0) eta-0) 1 csegen-51 (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-0) eta-0) (cons "hello from " (cons (PreludeC-45Show-u--show_Show_Bits32 u--cl) (cons "\xa;" '()))))))) (lambda (eta-0) (vector 2 eta-0 (lambda () (vector 0 'erased)))))))))))))
(define FSC-45Pull-foreach (lambda (arg-5 arg-6) (vector 6 (vector 4 arg-6) (lambda (lcase-0) (case (vector-ref lcase-0 0) ((0) (let ((e-2 (vector-ref lcase-0 1))) (vector 0 e-2))) (else (let ((e-5 (vector-ref lcase-0 1))) (let ((e-8 (car e-5))) (let ((e-9 (cdr e-5))) (vector 6 (vector 3 (vector 0 (arg-5 e-8))) (lambda (_-10677) (FSC-45Pull-foreach arg-5 e-9))))))))))))
(define DataC-45List-last (lambda (arg-1) (let ((e-1 (car arg-1))) (let ((e-2 (cdr arg-1))) (if (null? e-2) e-1 (DataC-45List-last e-2))))))
(define DataC-45List-lastC-39 (lambda (arg-1) (if (null? arg-1) '() (box (DataC-45List-last arg-1)))))
(define Main-logRes (lambda (arg-0) (case (vector-ref arg-0 0) ((0) (let ((e-2 (vector-ref arg-0 1))) (vector 3 (lambda (eta-0) (PreludeC-45IO-u--map_Functor_IO (lambda (eta-1) (vector 1 eta-1)) (lambda (eta-1) (let ((sc1 (SystemC-45PosixC-45FileC-45Prim-fwrite (lambda (eta-2) eta-2) 2 csegen-51 (string-append (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-2) eta-2) (cons "Error: " (cons (PreludeC-45Types-u--foldMap_Foldable_List (force csegen-53) (lambda (eta-2) eta-2) (cons (SystemC-45PosixC-45ErrnoC-45Type-errorText e-2) (cons " (" (cons (SystemC-45PosixC-45ErrnoC-45Type-errorName e-2) (cons ")" '()))))) '()))) "\xa;") 0 eta-1))) (case (vector-ref sc1 0) ((1) 'erased) (else 'erased)))) eta-0))))) (else (let ((e-5 (vector-ref arg-0 1))) (IOC-45AsyncC-45Posix-fwritenb 0 csegen-81 (lambda (eta-0) eta-0) 1 (lambda (eta-0) (vector 1 eta-0)) e-5))))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--caseC-32blockC-32inC-32drop_-4792 (lambda (arg-0 arg-1 arg-2 arg-3 arg-4 arg-5) (if (null? arg-5) (cons arg-1 (DataC-45SortedMap-delete arg-3 arg-0)) (cons arg-1 (DataC-45SortedMap-insert arg-3 arg-5 arg-0)))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--drop_-4747 (lambda (arg-0 arg-1 arg-2 arg-3 arg-4) (if (null? arg-4) (cons arg-1 arg-0) (let ((e-2 (unbox arg-4))) (IOC-45AsyncC-45LoopC-45TimerST-case--caseC-32blockC-32inC-32drop_-4792 arg-0 arg-1 arg-2 arg-3 e-2 (PreludeC-45TypesC-45List-filterAppend '() (lambda (eta-0) (PreludeC-45Types-u--C-47C-61_Eq_Nat arg-2 (Builtin-fst eta-0))) e-2))))))
(define IOC-45AsyncC-45LoopC-45TimerST-drop_ (lambda (arg-0 arg-1 arg-2) (let ((e-0 (car arg-2))) (let ((e-1 (cdr arg-2))) (IOC-45AsyncC-45LoopC-45TimerST-case--drop_-4747 e-1 e-0 arg-1 arg-0 (DataC-45SortedMap-lookup arg-0 e-1))))))
(define IOC-45AsyncC-45LoopC-45TimerST-schedule_ (lambda (arg-0 arg-1 arg-2) (let ((e-0 (car arg-2))) (let ((e-1 (cdr arg-2))) (let ((sc1 (DataC-45SortedMap-lookup arg-0 e-1))) (if (null? sc1) (cons (+ e-0 1) (DataC-45SortedMap-insert arg-0 (cons (cons e-0 arg-1) '()) e-1)) (let ((e-2 (unbox sc1))) (cons (+ e-0 1) (DataC-45SortedMap-insert arg-0 (cons (cons e-0 arg-1) e-2) e-1)))))))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32schedule-5185 (lambda (arg-0 arg-2 arg-3 arg-4 arg-6 arg-7) (let ((eff-0 (set-box! arg-0 (IOC-45AsyncC-45LoopC-45TimerST-schedule_ arg-6 arg-2 arg-7)))) (lambda (eta-0) (let ((eff-1 (unbox arg-0))) (set-box! arg-0 (IOC-45AsyncC-45LoopC-45TimerST-drop_ arg-6 (let ((e-0 (car arg-7))) e-0) eff-1)))))))
(define IOC-45AsyncC-45LoopC-45TimerST-case--schedule-5083 (lambda (arg-0 arg-2 arg-3 arg-4) (let ((u--end (+ arg-4 (SystemC-45Clock-toNano arg-3)))) (let ((sc0 (PreludeC-45EqOrd-u--C-60C-61_Ord_Integer u--end arg-4))) (cond ((equal? sc0 1) (let ((eff-0 (arg-2 'erased))) (lambda (eta-0) 'erased))) (else (IOC-45AsyncC-45LoopC-45TimerST-case--caseC-32blockC-32inC-32caseC-32blockC-32inC-32schedule-5185 arg-0 arg-2 arg-3 arg-4 u--end (unbox arg-0))))))))
(define IOC-45AsyncC-45LoopC-45TimerST-schedule (lambda (arg-0 arg-1 arg-2 arg-3) (IOC-45AsyncC-45LoopC-45TimerST-case--schedule-5083 arg-0 arg-2 arg-1 (let ((eff-0 (SystemC-45Clock-clockTime 1 arg-3))) (SystemC-45Clock-toNano eff-0)))))
(define FSC-45Core-interruptOnAny (lambda (arg-4 arg-5) (vector 10 (vector 7 (box arg-4) arg-5) (lambda () (vector 0 'erased)))))
(define IOC-45AsyncC-45Util-sleep (lambda (arg-1 arg-3) (vector 0 (vector 8 ) (lambda (u--ev) (vector 12 (lambda (u--cb) (((arg-1 u--ev) arg-3) (u--cb (vector 1 'erased)))))))))
(define FSC-45Concurrent-timeout (lambda (arg-3 arg-4 arg-5) (vector 6 (vector 3 (vector 0 (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (let ((eff-0 (box csegen-173))) (vector 1 eff-0 'erased))))))) (lambda (u--def) (vector 6 (vector 3 (vector 1 (vector 11 (vector 0 (IOC-45AsyncC-45Util-sleep arg-3 arg-4) (lambda (_-10677) (vector 3 (lambda (eta-0) (DataC-45LinearC-45ELift1-toResult (let ((eff-0 (DataC-45LinearC-45Deferred-putDeferred1 u--def 'erased eta-0))) (vector 1 eff-0 'erased)))))))) (lambda (eta-0) (IOC-45AsyncC-45Util-cancel eta-0)))) (lambda (u--_) (FSC-45Core-interruptOnAny u--def arg-5)))))))
(define Main-prog (lambda (arg-0) (if (null? arg-0) (vector 1 (DataC-45ListC-45QuantifiersC-45Extra-inject 0 22)) (let ((e-3 (cdr arg-0))) (let ((sc1 (DataC-45List-lastC-39 e-3))) (if (null? sc1) (vector 3 (vector 0 (vector 3 (lambda (eta-0) (PreludeC-45IO-u--map_Functor_IO (lambda (eta-1) (vector 1 eta-1)) (lambda (eta-1) (let ((sc2 (SystemC-45PosixC-45FileC-45Prim-fwrite (lambda (eta-2) eta-2) 2 csegen-51 "Usage: pack run idris2-streams-fahrenheit.ipkg [port]\xa;" 0 eta-1))) (case (vector-ref sc2 0) ((1) 'erased) (else 'erased)))) eta-0))))) (let ((e-4 (unbox sc1))) (FSC-45Concurrent-timeout (lambda (eta-0) (lambda (eta-1) (lambda (eta-2) (lambda (eta-3) (IOC-45AsyncC-45LoopC-45TimerST-schedule (let ((e-7 (vector-ref eta-0 7))) e-7) eta-1 eta-2 eta-3))))) (SystemC-45Clock-fromNano 2 20000000000) (FSC-45Pull-foreach (lambda (eta-0) (Main-logRes eta-0)) (Main-echoClient (cast-string-boundedUInt e-4 16)))))))))))
(define PreludeC-45EqOrd-u--C-60C-61_Ord_Int (lambda (arg-0 arg-1) (let ((sc0 (or (and (<= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--C-62C-61_Ord_Int (lambda (arg-0 arg-1) (let ((sc0 (or (and (>= arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--C-62_Ord_Int (lambda (arg-0 arg-1) (let ((sc0 (or (and (> arg-0 arg-1) 1) 0))) (cond ((equal? sc0 0) 0)(else 1)))))
(define PreludeC-45EqOrd-u--compare_Ord_Int (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-60_Ord_Int arg-0 arg-1))) (cond ((equal? sc0 1) 0) (else (let ((sc1 (PreludeC-45EqOrd-u--C-61C-61_Eq_Int arg-0 arg-1))) (cond ((equal? sc1 1) 1) (else 2))))))))
(define PreludeC-45Num-u--div_Integral_Int (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Int arg-1 (blodwen-toSignedInt 0 63)))) (cond ((equal? sc0 0) (bs/ arg-0 arg-1 63))(else (blodwen-error-quit (string-append "ERROR: " "Unhandled input for Prelude.Num.case block in div at Prelude.Num:128:3--130:40")))))))
(define PreludeC-45EqOrd-u--max_Ord_Int (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-62_Ord_Int arg-0 arg-1))) (cond ((equal? sc0 1) arg-0) (else arg-1)))))
(define PreludeC-45Num-u--mod_Integral_Int (lambda (arg-0 arg-1) (let ((sc0 (PreludeC-45EqOrd-u--C-61C-61_Eq_Int arg-1 (blodwen-toSignedInt 0 63)))) (cond ((equal? sc0 0) (blodwen-euclidMod arg-0 arg-1))(else (blodwen-error-quit (string-append "ERROR: " "Unhandled input for Prelude.Num.case block in mod at Prelude.Num:131:3--133:40")))))))
(define PreludeC-45Types-u--traverse_Traversable_List (lambda (arg-3 arg-4 arg-5) (if (null? arg-5) (let ((e-2 (vector-ref arg-3 1))) ((e-2 'erased) '())) (let ((e-2 (car arg-5))) (let ((e-3 (cdr arg-5))) (let ((e-4 (vector-ref arg-3 2))) ((((e-4 'erased) 'erased) (let ((e-6 (vector-ref arg-3 2))) ((((e-6 'erased) 'erased) (let ((e-10 (vector-ref arg-3 1))) ((e-10 'erased) csegen-115))) (arg-4 e-2)))) (PreludeC-45Types-u--traverse_Traversable_List arg-3 arg-4 e-3))))))))
(define System-getArgs (lambda (arg-1) (let ((e-1 (car arg-1))) (let ((e-4 (vector-ref e-1 1))) ((((e-4 'erased) 'erased) (let ((e-6 (cdr arg-1))) ((e-6 'erased) (lambda (eta-0) (System-prim__getArgCount eta-0))))) (lambda (u--n) (let ((sc1 (PreludeC-45EqOrd-u--C-62_Ord_Int u--n (blodwen-toSignedInt 0 63)))) (cond ((equal? sc1 1) (PreludeC-45Basics-flip (lambda (arg-14091) (lambda (arg-14098) (PreludeC-45Types-u--traverse_Traversable_List (let ((e-7 (car arg-1))) (let ((e-10 (vector-ref e-7 0))) e-10)) arg-14091 arg-14098))) (PreludeC-45Types-u--rangeFromTo_Range_C-36a (cons (vector csegen-96 (lambda (arg-6334) (lambda (arg-6337) (PreludeC-45Num-u--div_Integral_Int arg-6334 arg-6337))) (lambda (arg-6344) (lambda (arg-6347) (PreludeC-45Num-u--mod_Integral_Int arg-6344 arg-6347)))) (cons (vector (cons (lambda (arg-712) (lambda (arg-715) (PreludeC-45EqOrd-u--C-61C-61_Eq_Int arg-712 arg-715))) (lambda (arg-722) (lambda (arg-725) (PreludeC-45EqOrd-u--C-47C-61_Eq_Int arg-722 arg-725)))) (lambda (arg-1594) (lambda (arg-1597) (PreludeC-45EqOrd-u--compare_Ord_Int arg-1594 arg-1597))) (lambda (arg-1604) (lambda (arg-1607) (PreludeC-45EqOrd-u--C-60_Ord_Int arg-1604 arg-1607))) (lambda (arg-1614) (lambda (arg-1617) (PreludeC-45EqOrd-u--C-62_Ord_Int arg-1614 arg-1617))) (lambda (arg-1624) (lambda (arg-1627) (PreludeC-45EqOrd-u--C-60C-61_Ord_Int arg-1624 arg-1627))) (lambda (arg-1634) (lambda (arg-1637) (PreludeC-45EqOrd-u--C-62C-61_Ord_Int arg-1634 arg-1637))) (lambda (arg-1644) (lambda (arg-1647) (PreludeC-45EqOrd-u--max_Ord_Int arg-1644 arg-1647))) (lambda (arg-1654) (lambda (arg-1657) (PreludeC-45EqOrd-u--min_Ord_Int arg-1654 arg-1657)))) (vector csegen-96 (lambda (arg-6034) (bs- 0 arg-6034 63)) (lambda (arg-6040) (lambda (arg-6043) (bs- arg-6040 arg-6043 63)))))) 0 (bs- u--n 1 63)) (lambda (eta-0) (let ((e-6 (cdr arg-1))) ((e-6 'erased) (lambda (eta-1) (System-prim__getArg eta-0 eta-1))))))) (else (let ((e-7 (car arg-1))) (let ((e-10 (vector-ref e-7 0))) (let ((e-12 (vector-ref e-10 1))) ((e-12 'erased) '())))))))))))))
(define Main-main (lambda (ext-0) (let ((act-1 ((System-getArgs csegen-77) ext-0))) (Main-runProg (Main-prog act-1) ext-0))))
(define PreludeC-45EqOrd-compareInteger (lambda (ext-0 ext-1) (PreludeC-45EqOrd-u--compare_Ord_Integer ext-0 ext-1)))
(collect-request-handler
  (let* ([gc-counter 1]
         [log-radix 2]
         [radix-mask (sub1 (bitwise-arithmetic-shift 1 log-radix))]
         [major-gc-factor 2]
         [trigger-major-gc-allocated (* major-gc-factor (bytes-allocated))])
    (lambda ()
      (cond
        [(>= (bytes-allocated) trigger-major-gc-allocated)
         ;; Force a major collection if memory use has doubled
         (collect (collect-maximum-generation))
         (blodwen-run-finalisers)
         (set! trigger-major-gc-allocated (* major-gc-factor (bytes-allocated)))]
        [else
         ;; Imitate the built-in rule, but without ever going to a major collection
         (let ([this-counter gc-counter])
           (if (> (add1 this-counter)
                  (bitwise-arithmetic-shift-left 1 (* log-radix (sub1 (collect-maximum-generation)))))
               (set! gc-counter 1)
               (set! gc-counter (add1 this-counter)))
           (collect
            ;; Find the minor generation implied by the counter
            (let loop ([c this-counter] [gen 0])
              (cond
                [(zero? (bitwise-and c radix-mask))
                 (loop (bitwise-arithmetic-shift-right c log-radix)
                       (add1 gen))]
                [else
                 gen]))))]))))
(PrimIO-unsafePerformIO (lambda (eta-0) (Main-main eta-0)))
  (collect-request-handler (lambda () (collect (collect-maximum-generation)) (blodwen-run-finalisers)))
  (collect-rendezvous)
  
  )